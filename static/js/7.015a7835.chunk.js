(this["webpackJsonproll-a-dice"]=this["webpackJsonproll-a-dice"]||[]).push([[7],{685:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(686),r=a.n(n),c=a(689),i=a(54),o=a(23),l=a(33),s=a(278),m=r()({}),u=Object(i.a)(),d=Object(c.connectedRouterRedirect)({redirectPath:o.a.HOME_PATH,AuthenticatingComponent:s.a,wrapperDisplayName:"UserIsAuthenticated",authenticatedSelector:l.a.isAuthenticated,authenticatingSelector:l.a.authenticatingSelector,redirectAction:function(e){return function(t){u.push(e),t({type:"UNAUTHED_REDIRECT",payload:{message:"User is not authenticated."}})}}});Object(c.connectedRouterRedirect)({AuthenticatingComponent:s.a,wrapperDisplayName:"UserIsNotAuthenticated",allowRedirectBack:!1,authenticatedSelector:function(e){return e.firebase.auth.isEmpty},authenticatingSelector:function(e){var t=e.firebase,a=t.auth,n=t.isInitializing;return!a.isLoaded||n},redirectPath:function(e,t){return m.getRedirectQueryParam(t)||o.a.ROOMS_PATH},redirectAction:function(e){return function(t){u.push(e),t({type:"AUTHED_REDIRECT",payload:{message:"User is not authenticated."}})}}})},690:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(0),r=a.n(n).a.lazy((function(){return a.e(6).then(a.bind(null,698))}))},691:function(e,t,a){"use strict";var n=a(0),r=a.n(n),c=a(20),i=a(654),o=a(774),l=a(775),s=a(771),m=a(772),u=a(773),d=a(674),p=a(111),b=a(282),g=a(609),f=a(657),h=a(662),E=a(605),v=a(11),O=a(276),y=Object(g.a)({image:{width:"100%",height:"15vh",backgroundPosition:"center",backgroundSize:"cover"}}),j=Object(E.a)(y);function S(e){var t,a=j(),n=Object(v.useSelector)(O.a.getFormCreateRoom);return r.a.createElement(f.a,{in:(null===n||void 0===n||null===(t=n.roomImage)||void 0===t?void 0:t.length)>8},(null===n||void 0===n?void 0:n.roomImage)&&r.a.createElement(h.a,{className:a.image,image:null===n||void 0===n?void 0:n.roomImage,title:"Room Image"}))}var x=Object(d.a)({form:"createRoom",validate:function(e){var t={};return[p.b.roomName.name,p.b.maxPlayers.name].forEach((function(a){e[a]||(t[a]="Required")})),e[p.b.diceType.name]&&e[p.b.diceType.name].length||(t[p.b.diceType.name]="Select at least one dice"),t}})((function(e){var t=e.handleSubmit,a=e.pristine,n=e.submitting,c=e.handleClose,i=e.invalid;return r.a.createElement("form",{onSubmit:t},r.a.createElement(S,null),r.a.createElement(s.a,{dividers:!0},r.a.createElement(b.c,p.b.roomName),r.a.createElement(b.c,p.b.roomImage),r.a.createElement(b.c,p.b.campaignTitle),r.a.createElement(b.c,p.b.description),r.a.createElement(b.c,p.b.gameMasterAvatar),r.a.createElement("div",{style:{width:"50%"}},r.a.createElement(b.c,p.b.maxPlayers)),r.a.createElement(b.a,p.b.diceType)),r.a.createElement(m.a,null,r.a.createElement(u.a,{type:"submit",color:"primary",disabled:i||a||n},"Submit"),r.a.createElement(u.a,{type:"button",onClick:c,color:"primary"},"Cancel")))}));function w(e){var t=e.open,a=e.onClose,n=e.onSubmit,s=e.initialValues,m=Object(c.a)(),u=Object(i.a)(m.breakpoints.down("xs"));return r.a.createElement(o.a,{fullScreen:u,open:t,onClose:a,"aria-labelledby":"responsive-dialog-title"},r.a.createElement(l.a,null,"Create new Room"),r.a.createElement(x,{handleClose:a,onSubmit:n,initialValues:s}))}a.d(t,"a",(function(){return w}))},777:function(e,t,a){"use strict";a.r(t);var n=a(22),r=a(81),c=a(692),i=a(685),o=Object(n.d)(Object(c.a)("EnhancedRoomList"),r.g,i.a),l=a(58),s=a(0),m=a.n(s),u=a(11),d=a(31),p=a(194),b=a(33),g=a(57),f=a(101),h=a(280),E=a(154),v=a(281),O=a(63),y=a(119),j=a(4),S=a(605),x=a(690),w=a(367),C=a(366),R=a(603),N=a(99),k=a(48),I=a(651),D=a(271),T=a(724),U=a.n(T),P=a(20),H=a(778),L=a(765),A=a(130),M=a(776),z=a(609),G=a(5),F=a(742),V=a(649),W=a(111),_=a(598),B=a(655),J=a(679),q=a(656),Y=a(653),K=a(279);var Q=m.a.memo(Object(G.a)((function(e){return Object(z.a)({itemHeader:{width:"40%",paddingRight:e.spacing(2),boxSizing:"border-box"},itemContent:{width:"60%",boxSizing:"border-box"}})}))((function(e){var t=e.profile,a=e.log,n=e.classes,r=e.children,c=t||{},i=c.displayName,o=c.photoURL,l=c.avatarUrl;return m.a.createElement(_.a,{alignItems:"flex-start"},m.a.createElement("div",{className:n.itemHeader},m.a.createElement(B.a,null,m.a.createElement(J.a,{alt:i,src:l||o})),m.a.createElement(q.a,{primary:m.a.createElement(Y.a,{container:!0,direction:"row",justify:"space-between",alignItems:"flex-start"},m.a.createElement(A.a,{component:"span",variant:"body1"},i),m.a.createElement(A.a,{component:"span",variant:"caption",color:"textSecondary"},K.a.timeStampToDetailedTime(a.timestamp)))})),m.a.createElement("div",{className:n.itemContent},r))}))),X=a(146);var Z=m.a.memo(Object(G.a)((function(e){return Object(z.a)({})}))((function(e){var t,a=e.log,n=X.a.sortObjectWithDiceKey((null===(t=a.payload)||void 0===t?void 0:t.result)||[]);return m.a.createElement(m.a.Fragment,null,m.a.createElement(Y.a,{container:!0,spacing:0},m.a.createElement(Y.a,{item:!0,xs:6},m.a.createElement(A.a,{component:"span",variant:"caption",color:"textSecondary"},"log type:")),m.a.createElement(Y.a,{item:!0,xs:6},m.a.createElement(A.a,{component:"span",variant:"overline",color:"secondary"},a.type)),Object.keys(n).map((function(e){return m.a.createElement(m.a.Fragment,{key:e},m.a.createElement(Y.a,{item:!0,xs:3},m.a.createElement(A.a,{component:"span",variant:"caption",color:"textSecondary"},e)),m.a.createElement(Y.a,{item:!0,xs:9},m.a.createElement(A.a,{component:"span",variant:"body1",color:"secondary"},n[e]&&n[e].join(", "))))}))))})));var $=m.a.memo(Object(G.a)((function(e){return Object(z.a)({root:{width:"100%",backgroundColor:e.palette.background.paper,overflowY:"scroll"}})}))((function(e){var t=e.profiles,a=e.logs,n=e.classes;return m.a.createElement(V.a,{className:n.root},a&&a.length?Object(l.a)(a).reverse().map((function(e,a){return m.a.createElement(m.a.Fragment,{key:e.timestamp},!!a&&m.a.createElement(F.a,{variant:"inset",component:"li",light:!0}),m.a.createElement(Q,{profile:t[e.authorUid],log:e},e.type===W.a.DICE_ROLL&&e.payload&&m.a.createElement(Z,{log:e})))})):"")})));var ee=Object(G.a)((function(e){return Object(z.a)({root:{backgroundColor:e.palette.background.paper,width:"100%",height:"100%",position:"relative",zIndex:10,overflow:"hidden"},bar:{borderBottom:"1px solid rgba(0, 0, 0, 0.12)"},tab:{overflowX:"hidden",height:"calc(100% - ".concat(e.spacing(6),"px)"),overflowY:"scroll"},tabContent:{margin:e.spacing(0,-1,0,-3)}})}))((function(e){var t=e.classes,a=e.visible,n=void 0===a||a,r=Object(P.a)(),c=m.a.useState(0),i=Object(k.a)(c,2),o=i[0],l=i[1],s=Object(u.useSelector)(f.a.usersProfiles),d=Object(u.useSelector)(f.a.selectedRoomLogs);return m.a.createElement(R.a,{direction:"right",in:n},m.a.createElement(D.a,{className:t.root,elevation:2},m.a.createElement(I.a,{className:t.bar,position:"static",color:"default",elevation:0},m.a.createElement(H.a,{value:o,onChange:function(e,t){l(t)},indicatorColor:"secondary",textColor:"primary",variant:"fullWidth","aria-label":"full width tabs example"},m.a.createElement(L.a,Object.assign({label:"Logs Timeline"},ae(0))),m.a.createElement(L.a,Object.assign({label:"Players Logs"},ae(1))))),m.a.createElement("div",{className:t.tab},m.a.createElement(U.a,{axis:"rtl"===r.direction?"x-reverse":"x",index:o,onChangeIndex:function(e){l(e)}},m.a.createElement(te,{value:o,index:0,dir:r.direction},m.a.createElement("div",{className:t.tabContent},m.a.createElement($,{profiles:s,logs:d}))),m.a.createElement(te,{value:o,index:1,dir:r.direction},m.a.createElement("div",{className:"classes.tabContent"},"Item Two"))))))}));function te(e){var t=e.children,a=e.value,n=e.index,r=Object(N.a)(e,["children","value","index"]);return m.a.createElement(A.a,Object.assign({component:"div",role:"tabpanel",hidden:a!==n,id:"full-width-tabpanel-".concat(n),"aria-labelledby":"full-width-tab-".concat(n)},r),a===n&&m.a.createElement(M.a,{p:3},t))}function ae(e){return{id:"full-width-tab-".concat(e),"aria-controls":"full-width-tabpanel-".concat(e)}}function ne(e){var t=e.visible,a=void 0===t||t;return m.a.createElement(R.a,{direction:"right",in:a},m.a.createElement("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:"100%"}},m.a.createElement(ee,null)))}var re=a(276),ce=a(768),ie=a(647),oe=a(744),le=a.n(oe),se=a(746),me=a.n(se),ue=a(745),de=a.n(ue),pe=a(766),be=a(767),ge=a(783),fe=a(595);var he=m.a.memo(Object(G.a)((function(e){return Object(z.a)({tile:{borderRadius:e.spacing(1),marginRight:e.spacing(2),maxWidth:e.spacing(30),overflow:"hidden",padding:"0 !Important",width:"100%"},title:{color:e.palette.primary.light},titleDisable:{color:e.palette.warning.light},masterGame:{position:"absolute",zIndex:10,top:0,right:0},titleBar:{background:"linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 70%, rgba(0,0,0,0) 100%)"}})}))((function(e){var t=e.classes,a=e.player,n=e.gameMaster;return m.a.createElement(pe.a,{className:t.tile},m.a.createElement("img",{src:a.avatarUrl||a.photoURL,alt:a.displayName}),m.a.createElement(be.a,{title:a.displayName,classes:{root:t.titleBar,title:a.connected?t.title:t.titleDisable},actionIcon:m.a.createElement(ge.a,{title:a.connected?"Online":"Offline"},m.a.createElement(fe.a,{"aria-label":"star ".concat(a.displayName)},a.connected?m.a.createElement(le.a,{className:t.title}):m.a.createElement(de.a,{className:t.titleDisable})))}),n&&m.a.createElement(ge.a,{className:Object(j.a)(t.masterGame,a.connected?t.title:t.titleDisable),title:"Game Master"},m.a.createElement(fe.a,{"aria-label":"star ".concat(a.displayName)},m.a.createElement(me.a,null))))})));var Ee=Object(G.a)((function(e){return Object(z.a)({root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper},gridList:{height:e.spacing(20),width:"100%",flexWrap:"nowrap",transform:"translateZ(0)"}})}))((function(e){var t=e.classes,a=e.visible,n=Object(u.useSelector)(f.a.selectedRoomPlayers),r=Object(u.useSelector)(f.a.selectedRoomGameMasterProfile);return m.a.createElement(R.a,{direction:"up",in:a},m.a.createElement(ce.a,{className:t.gridList,cols:2.5},r&&m.a.createElement(ie.a,{in:!0,timeout:300},m.a.createElement(he,{player:r,gameMaster:!0})),n&&n.map((function(e,t){return m.a.createElement(ie.a,{in:!0,key:e.uid,timeout:1e3*t+1300},m.a.createElement(he,{player:e}))}))))})),ve=a(18),Oe=a(747),ye=a.n(Oe),je=a(750),Se=a.n(je),xe=a(751),we=a.n(xe),Ce=a(748),Re=a.n(Ce),Ne=a(749),ke=a.n(Ne),Ie=a(752),De=a.n(Ie),Te=a(780),Ue=a(782),Pe=a(784),He=a(770),Le=a(785);var Ae=m.a.memo(Object(G.a)((function(e){return Object(z.a)({})}))((function(e){var t=e.direction,a=void 0===t?"left":t,n=e.actions,r=m.a.useState(!1),c=Object(k.a)(r,2),i=c[0],o=c[1],l=function(){return o(!1)};return m.a.createElement(Pe.a,{ariaLabel:"SpeedDial example",icon:m.a.createElement(Le.a,null),onClose:l,onOpen:function(){return o(!0)},open:i,direction:a},n.map((function(e){return m.a.createElement(He.a,{key:e.name,icon:e.icon,tooltipTitle:e.name,onClick:function(){return e.callback?e.callback(l):l()}})})))}))),Me=a(691);function ze(e){var t=e.open,a=e.onClose,n=Object(d.useFirestore)(),r=Object(u.useSelector)(f.a.selectedRoomFormData),c=Object(u.useSelector)(O.a.selectedRoomUid);return m.a.createElement(Me.a,{open:t,onClose:a,onSubmit:function(e){Object.keys(e).forEach((function(t){return void 0===e[t]&&delete e[t]})),n.doc("".concat(g.a.ROOMS,"/").concat(c)).update(Object(ve.a)({},e)).then((function(e){a()})).catch((function(e){console.log({e:e})}))},initialValues:r})}var Ge=Object(G.a)((function(e){return Object(z.a)({snackbar:{top:e.spacing(8)}})}))((function(e){var t=e.classes,a=Object(u.useDispatch)(),n=Object(u.useSelector)(re.a.isGameMasterOfSelectedRoom),r=Object(u.useSelector)(O.a.drawerOpened),c=Object(u.useSelector)(O.a.chatOpened),i=Object(u.useSelector)(O.a.playersOpened),o=Object(s.useState)(!1),l=Object(k.a)(o,2),d=l[0],p=l[1],b=m.a.useState({type:"success",open:!1,text:""}),g=Object(k.a)(b,2),f=g[0],h=g[1],E=n?[{icon:m.a.createElement(ye.a,null),name:"Edit Room Description",callback:function(e){return p(!0)}}]:[],y=[{icon:r?m.a.createElement(Re.a,null):m.a.createElement(ke.a,null),name:r?"Hide Nav":"Show Nav",callback:function(e){return a(v.a.setDrawerOpenValue(!r))}},{icon:m.a.createElement(Se.a,null),name:c?"Hide chat":"Show Chat",callback:function(e){return a(v.a.setChatOpenValue(!c))}},{icon:m.a.createElement(we.a,null),name:i?"Hide players":"Show players",callback:function(e){return a(v.a.setPlayersOpenValue(!i))}},{icon:m.a.createElement(De.a,null),name:"Copy Room Url",callback:function(e){navigator.permissions.query({name:"clipboard-write"}).then((function(e){"granted"!==e.state&&"prompt"!==e.state||navigator.clipboard.writeText(window.location.href).then((function(){return h({type:"success",open:!0,text:"Room URL copied to clipboard!"})}),(function(){return h({type:"error",open:!0,text:"Upss.. there was an error"})}))}))}}].concat(E);return m.a.createElement(m.a.Fragment,null,m.a.createElement(Ae,{actions:y,direction:"right"}),m.a.createElement(Ue.a,{className:t.snackbar,anchorOrigin:{vertical:"top",horizontal:"right"},open:f.open,autoHideDuration:6e3,onClose:function(){return h(Object(ve.a)({},f,{open:!1}))}},m.a.createElement(Te.a,{onClose:function(){return h(Object(ve.a)({},f,{open:!1}))},severity:f.type},f.text)),m.a.createElement(ze,{open:d,onClose:function(){return p(!1)}}))})),Fe=Object(S.a)((function(e){return{root:{position:"relative",margin:e.spacing(-6,-4),height:"calc(100vh - ".concat(e.spacing(10),"px)"),padding:e.spacing(1,1,0,1)},mainGrid:{display:"grid",gridTemplateColumns:"1fr auto",gridTemplateRows:"1fr auto auto",columnGap:e.spacing(2)+"px",rowGap:e.spacing(2)+"px",width:"100%",height:"100%"},gridItemLogs:{position:"relative",gridColumn:"2",gridRow:"1"},gridItemChatter:{position:"relative",gridColumn:"2",gridRow:"2 / span 2"},gridItemDiceCard:{position:"relative",gridColumn:"1 / span 2",gridRow:"1 / span 2"},gridItemPlayers:{position:"relative",gridColumn:"1",gridRow:"3"},speedDial:{position:"absolute",bottom:e.spacing(1),left:e.spacing(1),zIndex:10},diceDashboard:{position:"absolute",zIndex:1e3,top:e.spacing(1),left:e.spacing(1)},maxHeight:{maxHeight:"3000px",transition:"max-height 225ms cubic-bezier(0, 0, 0.2, 1) 0ms"},noHeight:{maxHeight:0}}}));function Ve(){var e=Fe(),t=Object(u.useSelector)(O.a.playersOpened),a=Object(u.useSelector)(O.a.chatOpened),n=Object(u.useSelector)(O.a.diceRolling),r=Object(u.useSelector)(f.a.selectedRoom),c=Object(u.useSelector)(re.a.isUserARoomPlayerOrGameMaster),i=!t||!r;return m.a.createElement("section",{className:e.root},m.a.createElement("div",{className:e.mainGrid},m.a.createElement("div",{className:e.gridItemLogs},m.a.createElement(ne,null)),m.a.createElement("div",{className:e.gridItemDiceCard},m.a.createElement(w.a,null),m.a.createElement("nav",{className:e.diceDashboard},m.a.createElement(C.a,{visible:!n&&!!r&&c,room:r})),m.a.createElement("nav",{className:e.speedDial},m.a.createElement(Ge,null))),m.a.createElement("div",{className:e.gridItemChatter},m.a.createElement(x.a,{visible:a&&!n&&c})),m.a.createElement("div",{className:e.gridItemPlayers},m.a.createElement("div",{className:Object(j.a)(e.maxHeight,i&&e.noHeight)},m.a.createElement(Ee,{visible:!i})))))}t.default=o((function(e){var t=e.match,a=Object(u.useDispatch)(),n=Object(d.useFirestore)(),r=Object(u.useSelector)(f.a.selectedRoom),c=Object(u.useSelector)(O.a.selectedRoomUid),i=Object(u.useSelector)(E.a.match),o=Object(u.useSelector)(b.a.userProfile);return Object(s.useEffect)((function(){return JSON.stringify(t)!==JSON.stringify(i)&&a(h.a.matchChange(t)),void a(v.a.setSelectedRoom(i.params.roomId))})),Object(s.useEffect)((function(){!function(){if(r&&!((null===r||void 0===r?void 0:r.maxPlayers)<=r.players.length)&&(null===r||void 0===r?void 0:r.players)&&o.uid&&r.gameMaster.uid!==o.uid&&-1===r.players.indexOf(o.uid)){var e=n.doc("".concat(g.a.ROOMS,"/").concat(c));n.runTransaction((function(t){return t.get(e).then((function(a){var n=[].concat(Object(l.a)(a.data().players),[o.uid]);return t.update(e,{players:n})})).catch((function(e){console.log("Transaction failure:",e)}))}))}}()}),[c,null===r||void 0===r?void 0:r.createdAt,o.uid]),Object(s.useEffect)((function(){return function(){a(v.a.setSelectedRoom(null))}}),[]),Object(s.useEffect)((function(){a(p.a.setSelectedChat((null===r||void 0===r?void 0:r.chatUid)||null))}),[null===r||void 0===r?void 0:r.chatUid]),m.a.createElement(m.a.Fragment,null,c&&[c].map((function(e){return m.a.createElement(y.b,{key:e},m.a.createElement(Ve,null))})))}))}}]);
//# sourceMappingURL=7.015a7835.chunk.js.map