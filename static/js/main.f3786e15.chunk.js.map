{"version":3,"sources":["models/rooms.model.tsx","utils/rxjs/distinctUntilObjectChanged.pipe.ts","services/store.service.ts","store/ui/ui.actions.ts","services/dice.service.ts","contexts/DiceService.context.tsx","store/chats/chats.reducer.ts","store/location/location.reducer.ts","store/rooms/rooms.reducer.ts","store/ui/ui.reducer.ts","store/main.ts","config/store.config.ts","utils/dice.utils.ts","store/location/location.selectors.ts","store/chats/chats.selectors.ts","store/chats/chats.actions.ts","store/chats/chats.model.ts","store/location/location.model.ts","store/ui/ui.model.ts","modules/ChatList/components/ChatListElements.tsx","modules/ChatList/ChatList.tsx","store/main.selectors.ts","utils/date.utils.ts","components/Loader.tsx","components/FormComponents.tsx","store/location/location.actions.ts","store/rooms/rooms.actions.ts","models/paths.ts","utils/text.utils.ts","config/dice.config.ts","modules/DiceVisualization/dice-three.js","modules/DiceVisualization/dice-main.ts","modules/DiceCard/DiceCard.tsx","modules/DiceDashboard/components/DiceDashboardForm.tsx","modules/DiceDashboard/components/DiceDashboardResult.tsx","modules/DiceDashboard/DiceDashboard.tsx","store/firebase/firebase.selectors.ts","utils/object.utils.ts","store/rooms/rooms.model.ts","queries/chat.query.ts","queries/profile.query.ts","queries/rooms.query.ts","containers/WhenAuthenticated.tsx","containers/Core.tsx","routes/ChatList/index.ts","containers/ProfileAvatar.tsx","components/Ornament.tsx","layouts/Header/Header.tsx","components/LoaderScreen.tsx","layouts/Navigator/components/NavigatorItem.tsx","containers/RoomCard.tsx","layouts/Navigator/Navigator.tsx","styles/theme.styles.ts","layouts/NavBar.tsx","store/ui/ui.selectors.ts","layouts/CoreLayout.tsx","modules/AppStats/AppStats.tsx","routes/Home/components/HomeWrapper.tsx","queries/app.query.ts","routes/Home/HomePage.tsx","routes/Room/index.ts","routes/RoomList/index.ts","routes/index.tsx","config/firebase.config.ts","App.tsx","serviceWorker.ts","index.tsx","config/main.config.ts","models/firebase.model.ts","store/rooms/rooms.selectors.ts","store/firebase/firestore.selectors.ts","models/dice.model.ts","contexts/Toast.context.tsx"],"names":["Log","createRoomFormModel","roomName","name","label","fullWidth","maxLength","description","multiline","campaignTitle","roomImage","gameMasterAvatar","maxPlayers","type","InputProps","inputProps","min","max","diceType","options","Dice","D4","value","D6","D8","D10","D12","D20","D100","diceDashboardFormModel","d4","style","width","display","d6","d8","d10","d12","d20","d100","playersCharacterFormModel","characterName","characterAvatarUrl","characterDescription","notes","distinctUntilObjectChanged","fn","p","q","equal","source","pipe","distinctUntilChanged","StoreService","store","takeUntil$","Subject","_store$","ReplaySubject","_storeUnsubscribeFn","this","subscribe","next","getState","store$","map","state","form","diceSetForm","values","firestore","data","selectedRoom","filter","room","getSelectedRoomData$","logs","getSelectedRoomDataLogs$","length","log","DICE_ROLL","logA","logB","timestamp","payload","diceSet","diceUtils","sortObjectWithDiceKey","result","firebase","profile","action","dispatch","instance","asObservable","uiActions","UiAction","PENDING","DiceService","toast","diceThrow$","diceBeforeThrow$","diceAfterThrow$","requestNewThrow$","diceThrowDelayedWhen$","delayWhen","roomUid","storeService","getInstance","createSubscriptions","setDiceRolling","takeUntil","setIsPending","handleRequestNewThrow$","performDiceThrowWhenNewDiceThrowLogAppears$","diceRolling","roomsActions","isPending","getSelectedRoomLastDiceThrowLog$","tap","withLatestFrom","getDiceSetFormValues","setDice","isEveryZero","Object","every","v","setSnackbarConfig","SnackbarType","WARNING","open","text","diceThrowConfig","generateThrowResultFromDiceSet","concatMap","diceThrow","createNewThrowLogInRoomLogs$","of","ERROR","delay","documentRef","doc","FirestoreCollection","ROOMS","from","runTransaction","t","get","then","newLog","authorUid","uid","Date","now","update","DiceServiceContext","React","createContext","DiceServiceContextC","children","useFirestore","Toast","useContext","ToastContext","diceService","useSelector","firebaseSelectors","userProfile","roomsSelectors","selectedRoomUid","useEffect","hostDestroyed","Provider","initialState","selectedChat","chatsReducer","ChatsAction","SELECTED","match","params","isExact","path","url","locationReducer","LocationAction","MATCH_CHANGE","drawerOpened","chatOpened","playersOpened","roomsReducer","RoomsAction","SET_DRAWER_OPEN_VALUE","SET_CHAT_OPEN_VALUE","SET_PLAYERS_OPEN_VALUE","SET_DICE_ROLLING","uiReducer","combineReducers","firebaseReducer","enhancers","window","location","hostname","devToolsExtension","__REDUX_DEVTOOLS_EXTENSION__","push","middleware","thunk","withExtraArgument","getFirebase","getFirestore","module","createStore","chats","rooms","formReducer","ui","asyncReducers","compose","applyMiddleware","configureStore","___INITIAL_STATE__","authError","roller","DiceRoller","diceSetToString","dices","keys","diceName","dice","join","diceTrowResult","forEach","diceKey","rollSet","rollOutput","exec","roll","split","d","sortDiceFunction","a","b","parseInt","slice","obj","sort","locationSelectors","chatsSelectors","profilesUidFromSelectedChat","userChats","players","chatsActions","setSelectedChat","ChatListType","ChatListElements","memo","withStyles","theme","createStyles","root","backgroundColor","palette","background","paper","height","overflowY","item","cursor","props","classes","onChatClick","List","className","chatId","id","Grow","key","in","timeout","ListItem","onClick","selected","button","dense","alignItems","ListItemAvatar","Avatar","firstLettersJoined","ListItemText","primary","secondary","dateUtils","timeStampToFormattedDate","createdAt","prev","ChatList","maxWidth","margin","overflow","searchBar","borderBottom","searchInput","fontSize","typography","block","addUser","marginRight","spacing","contentWrapper","showSearchBar","viewType","CARD","firestoreSelectors","useDispatch","Paper","AppBar","position","color","elevation","Toolbar","Grid","container","xs","TextField","placeholder","disableUnderline","mainSelectors","getAllNeededPlayersUid","selectedRoomPlayers","selectedRoomGM","gameMasterUid","selectedChatPlayers","i","indexOf","isGameMasterOfSelectedRoom","getFormCreateRoom","createRoom","getFormPlayerProfile","playerProfile","isUserARoomPlayerOrGameMaster","time","dayjs","format","timeStampToDetailedTime","Loader","flexDirection","justifyContent","zIndex","left","top","progress","svg","src","process","alt","useStyles","makeStyles","formField","marginBottom","sliderFormField","marginLeft","FormFieldHelperText","touched","error","FormFieldText","component","input","meta","invalid","custom","variant","helperText","FormFieldCheckboxGroup","htmlFor","native","control","checked","onChange","inputValue","checkboxesFormControls","index","includes","event","arr","target","splice","row","FormFieldSlider","valuetext","inputRest","labelPlacement","defaultValue","getAriaValueText","aria-labelledby","valueLabelDisplay","step","marks","e","locationActions","matchChange","setSelectedRoom","setDrawerOpenValue","setChatOpenValue","setPlayersOpenValue","RouterPath","sentence","word","charAt","substring","toUpperCase","diceDefaultConfig","idCanvas","idLabel","idSet","idSelectorDiv","idInfoDiv","useTrueRandom","useShadows","whiteDice","noresult","diceThrowResult$","teal","$t","copyto","res","Array","copy","hasOwnProperty","constructor","element","place","content","dom","document","createElement","setAttribute","appendChild","undefined","inner","sel","nodeName","createTextNode","getElementById","set","clas","oldclass","newclass","oc","nc","getAttribute","ind","empty","childNodes","removeChild","firstChild","remove","parentNode","bind","eventname","func","bubble","addEventListener","unbind","removeEventListener","one","one_func","call","raise_event","cancelable","evt","createEvent","initEvent","dispatchEvent","raise","ev","initCustomEvent","getElementsByClassName","get_elements_by_class","node","list","getElementsByTagName","cl","j","search","rpc","callback","noparse","ajax","XMLHttpRequest","onreadystatechange","readyState","responseText","JSON","parse","send","stringify","uuid","replace","c","r","Math","random","toString","get_url_params","keyvalue","decodeURI","get_mouse_coords","touches","changedTouches","x","clientX","y","clientY","deferred","solved","callbacks","args","solve","shift","apply","promise","arguments","done","resolve","cancel","prototype","when","promises","count","random_storage","rnd","pop","create_geom","vertices","faces","radius","tab","af","chamfer","vectors","THREE","fromArray","normalize","cg","chamfer_vectors","chamfer_faces","corner_faces","ii","fl","center_point","face","vv","clone","add","divideScalar","subVectors","multiplyScalar","addVectors","pairs","lastm","m","n","unshift","cf","next_vertex","chamfer_geom","geom","vertex","aa","PI","faceVertexUvs","cos","sin","computeFaceNormals","boundingSphere","make_geom","cannon_shape","cv","CANNON","Vec3","z","ConvexPolyhedron","create_shape","calc_texture_size","approx","pow","floor","use_true_random","frame_rate","standart_d20_dice_face_labels","standart_d100_dice_face_labels","create_dice_materials","face_labels","size","create_text_texture","back_color","canvas","context","getContext","ts","font","fillStyle","fillRect","textAlign","textBaseline","fillText","texture","needsUpdate","materials","material_options","label_color","dice_color","d4_labels","create_d4_materials","labels","create_d4_text","translate","rotate","create_d4_geometry","create_d6_geometry","create_d8_geometry","create_d10_geometry","create_d12_geometry","sqrt","create_d20_geometry","specular","shininess","flatShading","ambient_light_color","spot_light_color","selector_back_colors","emissive","desk_color","use_shadows","known_types","dice_face_range","dice_mass","dice_inertia","scale","create_d4","d4_geometry","d4_material","create_d6","d6_geometry","dice_material","create_d8","d8_geometry","create_d10","d10_geometry","create_d12","d12_geometry","create_d20","d20_geometry","create_d100","d100_material","parse_notation","notation","no","dr0","dr1","ret","constant","stringify_notation","nn","dict","abs","that","make_random_vector","vector","random_angle","vec","get_dice_value","closest_face","dice_type","closest_angle","l","geometry","materialIndex","angle","normal","applyQuaternion","body","quaternion","angleTo","matindex","get_dice_values","shift_dice_faces","num","material","dice_box","dimentions","use_adapvite_timestep","animate_selector","scene","world","World","renderer","WebGLRenderingContext","antialias","domElement","shadowMap","enabled","setClearColor","reinit","gravity","broadphase","NaiveBroadphase","solver","iterations","ambientLight","dice_body_material","Material","barrier","desk_body_material","barrier_body_material","addContactMaterial","ContactMaterial","friction","restitution","Body","mass","shape","Plane","setFromAxisAngle","h","w","last_time","running","render","camera","cw","clientWidth","ch","clientHeight","aspect","setSize","wh","tan","mw","light","distance","castShadow","shadow","near","far","fov","bias","mapSize","desk","receiveShadow","generate_vectors","boost","pos","projector","velvec","velocity","inertia","axis","create_dice","angularVelocity","linearDamping","angularDamping","check_if_throw_finished","iteration","dice_stopped","emulate_throw","__animate","threadid","tid","getTime","time_diff","interact","setTimeout","requestAnimationFrame","clear","pane","box","prepare_dices_for_roll","__selector_animate","angle_change","rotation","search_dice_by_mouse","intersects","sub","intersectObjects","object","userData","draw_selector","bind_mouse_listener","mouse_time","mouse_start","rolling","dist","time_int","start_throw","notation_getter","before_roll","after_roll","vectorParam","boostParam","distParam","method","random_responce","prepare_rnd","assign","uat","request_results","throw_dices","$teal","dice_initialize","config","_config","idControlPanel","chromakey","containerBox","getBoundingClientRect","throwConfig","objectSortByKeys","requestDiceSet","compareDiceKey","amount","prepareDiceSetToString","requestResult","prepareThrowResultToString","ResizeSensor","toFixed","ordered","DiceCard","diceCanvas","grabbing","visible","canvasRef","useRef","diceContainerEl","useState","diceInitialized","setDiceInitialized","mouseDown","setMouseDown","canvasHasDimensions","setCanvasHasDimensions","ref","setState","interval","current","elementRect","setStateWhenCanvasHasDimensions","resizeSensor","detach","onMouseDown","isDown","clsx","onMouseUp","inputSlider","paddingRight","minWidth","DiceDashboardForm","reduxForm","initialValues","onSubmit","preventDefault","DiceDashboardResult","throwResult","Typography","DiceDashboard","details","flex","cover","playIcon","clickable","destroyed$","setThrowResult","Card","CardContent","Collapse","CardMedia","image","title","isRequesting","status","requesting","auth","authenticatingSelector","isInitializing","isLoaded","isAuthenticated","isEmpty","userConnected","connected","applicationStats","isArray","keyList","hasProp","arrA","arrB","dateA","dateB","regexpA","RegExp","regexpB","chatsQuery","uidNonEmptyArray","collection","CHATS","where","storeAs","profileQuery","getProfilesByUid","uids","roomsQuery","DocUid","WhenAuthenticated","useFirebase","uniqProfilesUid","updateUserStatus","USERS","onDisconnect","useFirebaseConnect","useFirestoreConnect","Fragment","Core","ChatListLazy","lazy","CHATS_PATH_ID","CHATS_PATH","ProfileAvatar","iconButtonAvatar","padding","avatarSize","border","main","history","useHistory","anchorEl","setAnchorEl","IconButton","currentTarget","avatarUrl","photoURL","displayName","keepMounted","Boolean","onClose","MenuItem","logout","HOME_PATH","login","provider","ROOMS_PATH","err","alert","message","Ornament","ornament","backgroundImage","backgroundRepeatX","backgroundRepeatY","backgroundSize","vartical","Header","secondaryBar","menuButton","link","textDecoration","common","white","borderColor","bottom","opacity","avatar","onDrawerToggle","Hidden","smUp","aria-label","LoaderScreen","visibility","transitionDelay","transition","isAuthenticating","Fade","NavigatorItem","paddingTop","paddingBottom","itemCategoryWrapper","minHeight","itemCategory","itemCategoryAbsolute","itemActiveItem","itemPrimary","itemIcon","expansionPanel","borderRadius","expansionPanelSummary","expansionPanelSummaryContainer","expandIcon","divider","boxShadow","icon","navLink","active","expandable","defaultExpanded","setNavLink","to","ExpansionPanel","ExpansionPanelSummary","aria-controls","ListItemIcon","ExpansionPanelDetails","RoomCard","cards","media","gutterBottom","find","player","gameMaster","Navigator","logo","other","locationPath","selectedRoomData","Drawer","ROOMS_PATH_ID","disablePadding","EMBEDDED","ROOM_PATH","createMuiTheme","dark","default","fontFamily","h5","fontWeight","letterSpacing","MuiTab","disableRipple","mixins","toolbar","overrides","MuiDrawer","MuiButton","textTransform","contained","MuiTabs","indicator","borderTopLeftRadius","borderTopRightRadius","breakpoints","up","MuiIconButton","MuiTooltip","tooltip","MuiDivider","MuiListItemText","fontWeightMedium","MuiListItemIcon","MuiAvatar","themeFn","styles","drawer","flexShrink","NavBar","mobileOpen","implementation","PaperProps","handleDrawerToggle","xsDown","uiSelectors","Copyright","align","Link","href","getFullYear","lineLoader","app","appWhenAuth","footer","CoreLayout","setMobileOpen","ThemeProvider","CssBaseline","Slide","direction","LinearProgress","AppStats","lineHeight","appStats","statsView","diceThrows","justify","stat","cssGrid","gridTemplateColumns","gridTemplateRows","rowGap","columnGap","cssItem1","gridColumn","gridRow","cssItem2","mainInfoCard","diceCard","diceDashboard","right","HomeWrapper","showDiceCard","setShowDiceCard","timer","appQuery","HomePage","storeLocationMatch","RoomLazy","Room","RoomListLazy","RoomList","ROOM_CREATE_PATH","backdrop","CreateRoutes","fallback","Backdrop","exact","settings","reactReduxFirebaseProps","firebaseApp","useFirestoreForProfile","createFirestoreInstance","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","App","prefersDarkMode","useMediaQuery","useMemo","version","env","ReactDOM","navigator","serviceWorker","ready","registration","unregister","getChat","selectedRoomFormData","userRoomsAsGameMaster","userRoomsAsPlayer","allUserRoomsUid","usersProfiles","selectedRoomGameMasterUid","selectedRoomLogs","snackbar","ToastContextC","snackbarConfig","anchorOrigin","vertical","horizontal","autoHideDuration","severity"],"mappings":"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","file":"static/js/main.f3786e15.chunk.js","sourcesContent":["import React from 'react';\nimport { Dice, IDiceThrow } from './dice.model';\nimport { Dictionary } from 'react-redux-firebase';\n\nexport enum Log {\n  DICE_ROLL = 'DICE_ROLL',\n  NEW_PLAYER = 'NEW_PLAYER',\n}\n\nexport interface IProfile {\n  uid: string;\n  avatarUrl?: string;\n  displayName: string;\n  email: string;\n  photoURL: string;\n  connected?: boolean;\n}\n\nexport interface IPlayerProfile extends IProfile {\n  characterName?: string;\n  characterAvatarUrl?: string;\n  characterDescription?: string;\n  notes?: string;\n  gameMaster?: boolean;\n}\n\nexport interface IRoomLog {\n  timestamp: number;\n  type: Log;\n  authorUid: string;\n  payload?: IDiceThrow;\n}\n\nexport interface IRoom extends IRoomCreateForm {\n  createdAt: string;\n  gameMasterUid: string;\n  players: Dictionary<IPlayerProfile>;\n  playersUid: string[];\n  logs: IRoomLog[];\n  chatUid?: string;\n}\n\nexport interface IRoomCreateForm {\n  roomName: string;\n  diceType: Dice[];\n  description: string;\n  roomImage: string;\n  gameMasterAvatar: string;\n  campaignTitle: string;\n  maxPlayers: number;\n}\n\nexport interface IRoomPlayerProfileForm extends IPlayerProfile {}\n\nexport const createRoomFormModel = {\n  roomName: { name: 'roomName', label: 'Name of the Room *', fullWidth: true, maxLength: 80 },\n  description: { name: 'description', label: 'Room description', multiline: true, fullWidth: true, maxLength: 1024 },\n  campaignTitle: { name: 'campaignTitle', label: 'Current campaign tittle', fullWidth: true, maxLength: 80 },\n  roomImage: { name: 'roomImage', label: 'Room image URL', fullWidth: true, maxLength: 256 },\n  gameMasterAvatar: { name: 'gameMasterAvatar', label: 'Game master avatar URL', fullWidth: true, maxLength: 256 },\n  maxPlayers: {\n    name: 'maxPlayers',\n    label: 'Maximum players *',\n    multiline: false,\n    fullWidth: true,\n    type: 'number',\n    InputProps: { inputProps: { min: 1, max: 8 } },\n  },\n  diceType: {\n    name: 'diceType',\n    label: 'Allowed dice *',\n    options: [\n      { label: Dice.D4, value: Dice.D4 },\n      { label: Dice.D6, value: Dice.D6 },\n      { label: Dice.D8, value: Dice.D8 },\n      { label: Dice.D10, value: Dice.D10 },\n      { label: Dice.D12, value: Dice.D12 },\n      { label: Dice.D20, value: Dice.D20 },\n      { label: Dice.D100, value: Dice.D100 },\n    ],\n  },\n};\n\nexport const diceDashboardFormModel = {\n  d4: { label: <span style={{ width: '48px', display: 'inline-block' }}>{Dice.D4}</span>, name: Dice.D4 },\n  d6: { label: <span style={{ width: '48px', display: 'inline-block' }}>{Dice.D6}</span>, name: Dice.D6 },\n  d8: { label: <span style={{ width: '48px', display: 'inline-block' }}>{Dice.D8}</span>, name: Dice.D8 },\n  d10: { label: <span style={{ width: '48px', display: 'inline-block' }}>{Dice.D10}</span>, name: Dice.D10 },\n  d12: { label: <span style={{ width: '48px', display: 'inline-block' }}>{Dice.D12}</span>, name: Dice.D12 },\n  d20: { label: <span style={{ width: '48px', display: 'inline-block' }}>{Dice.D20}</span>, name: Dice.D20 },\n  d100: { label: <span style={{ width: '48px', display: 'inline-block' }}>{Dice.D100}</span>, name: Dice.D100 },\n};\n\nexport const playersCharacterFormModel = {\n  characterName: { name: 'characterName', label: 'Name of character', fullWidth: true, maxLength: 80 },\n  characterAvatarUrl: { name: 'characterAvatarUrl', label: 'Character avatar URL', fullWidth: true, maxLength: 256 },\n  characterDescription: {\n    name: 'characterDescription',\n    label: 'Character description',\n    multiline: true,\n    fullWidth: true,\n    maxLength: 1024,\n  },\n  notes: {\n    name: 'notes',\n    label: 'Notes (not visible for other players)',\n    multiline: true,\n    fullWidth: true,\n    maxLength: 2024,\n  },\n};\n","import { Observable } from 'rxjs';\nimport { distinctUntilChanged } from 'rxjs/operators';\n\nimport { equal } from '../object.utils';\n\nexport const distinctUntilObjectChanged = (fn: (p: any, q: any) => boolean = (p: any, q: any) => equal(p, q)) => <T>(\n  source: Observable<T>\n) => {\n  return source.pipe(distinctUntilChanged(fn));\n};\n","import { AnyAction, Store } from 'redux';\nimport { distinctUntilChanged, filter, map } from 'rxjs/operators';\nimport { Observable, ReplaySubject, Subject } from 'rxjs';\n\nimport { store } from '../config/store.config';\nimport { AppState, IDiceSetForm } from '../store/main';\nimport { IProfile, IRoom, IRoomLog, Log } from '../models/rooms.model';\nimport { distinctUntilObjectChanged } from '../utils/rxjs/distinctUntilObjectChanged.pipe';\nimport { IDiceSet } from '../models/dice.model';\nimport { diceUtils } from '../utils/dice.utils';\n\nexport class StoreService {\n  private static instance: StoreService | null;\n\n  public store: Store = store;\n\n  private readonly takeUntil$ = new Subject();\n  private readonly _store$ = new ReplaySubject<AppState>(1);\n  private readonly _storeUnsubscribeFn: Function;\n\n  private constructor() {\n    this._storeUnsubscribeFn = this.store.subscribe(() => {\n      this._store$.next(this.store.getState());\n    });\n  }\n\n  public get store$(): Observable<AppState> {\n    return this._store$.asObservable();\n  }\n\n  public getDiceSetForm(): Observable<IDiceSetForm> {\n    return this.store$.pipe(\n      map(state => state.form.diceSetForm),\n      distinctUntilObjectChanged()\n    );\n  }\n\n  public getDiceSetFormValues(): Observable<IDiceSet> {\n    return this.store$.pipe(\n      map(state => state.form.diceSetForm?.values),\n      distinctUntilObjectChanged()\n    );\n  }\n\n  public getSelectedRoomData$(): Observable<IRoom> {\n    return this.store$.pipe(\n      map(state => state.firestore.data.selectedRoom),\n      filter(room => !!room)\n    );\n  }\n\n  public getSelectedRoomDataLogs$(): Observable<Array<IRoomLog>> {\n    return this.getSelectedRoomData$().pipe(\n      map(room => room.logs),\n      filter(logs => !!logs)\n    );\n  }\n\n  public getSelectedRoomLastDiceThrowLog$(): Observable<IRoomLog> {\n    return this.getSelectedRoomDataLogs$().pipe(\n      map(logs => logs[logs.length ? logs.length - 1 : 0]),\n      filter(log => !!log && log.type === Log.DICE_ROLL),\n      distinctUntilChanged((logA, logB) => logA.timestamp === logB.timestamp),\n      map((log: IRoomLog) => ({\n        ...log,\n        payload: {\n          ...log.payload,\n          diceSet: diceUtils.sortObjectWithDiceKey(log.payload.diceSet),\n          result: diceUtils.sortObjectWithDiceKey(log.payload.result),\n        },\n      }))\n    );\n  }\n\n  public getUserProfile$(): Observable<IProfile> {\n    return this.store$.pipe(map(state => state.firebase.profile));\n  }\n\n  public dispatch(action: AnyAction): AnyAction {\n    return this.store.dispatch(action);\n  }\n\n  public hostDestroyed(): void {\n    this.takeUntil$.next();\n    this._storeUnsubscribeFn();\n    StoreService.instance = null;\n  }\n\n  static getInstance(): StoreService {\n    if (!StoreService.instance) {\n      StoreService.instance = new StoreService();\n    }\n\n    return StoreService.instance;\n  }\n}\n","import { action } from 'typesafe-actions';\nimport { UiAction } from './ui.model';\n\nexport const uiActions = {\n  setIsPending: (payload: boolean) => action(UiAction.PENDING, payload),\n};\n","import { from, Observable, of, ReplaySubject, Subject } from 'rxjs';\nimport { firestore } from 'firebase/app';\nimport { concatMap, delay, delayWhen, filter, map, takeUntil, tap, withLatestFrom } from 'rxjs/operators';\n\nimport { diceUtils } from '../utils/dice.utils';\nimport { FirestoreCollection } from '../models/firebase.model';\nimport { IDiceAfterThrow, IDiceBeforeThrow, IDiceSet, IDiceThrow, IDiceThrowConfig } from '../models/dice.model';\nimport { IProfile, IRoomLog, Log } from '../models/rooms.model';\nimport { roomsActions } from '../store/rooms/rooms.actions';\nimport { SnackbarType, ToastContextProviderValue } from '../contexts/Toast.context';\nimport { StoreService } from './store.service';\nimport { uiActions } from '../store/ui/ui.actions';\n\nexport class DiceService {\n  private static instance: DiceService | null;\n\n  public readonly diceThrow$ = new Subject<IDiceThrow>();\n  public readonly diceBeforeThrow$ = new Subject<IDiceBeforeThrow>();\n  public readonly diceAfterThrow$ = new ReplaySubject<IDiceAfterThrow>(1);\n  public readonly requestNewThrow$ = new Subject<IDiceThrowConfig>();\n  public readonly diceThrowDelayedWhen$ = this.diceThrow$.pipe(delayWhen(() => this.diceAfterThrow$));\n\n  public profile: IProfile | null = null;\n  public roomUid: string | null = null;\n\n  private readonly takeUntil$ = new Subject();\n  private readonly storeService: StoreService = StoreService.getInstance();\n\n  private constructor(private firestore: firestore.Firestore, private toast: ToastContextProviderValue) {\n    this.createSubscriptions();\n  }\n\n  public hostDestroyed(): void {\n    this.takeUntil$.next();\n    DiceService.instance = null;\n    this.setDiceRolling(false);\n  }\n\n  static getInstance(firestore: firestore.Firestore, toast: ToastContextProviderValue): DiceService {\n    if (!DiceService.instance) {\n      DiceService.instance = new DiceService(firestore, toast);\n    }\n\n    return DiceService.instance;\n  }\n\n  private createSubscriptions(): void {\n    this.diceBeforeThrow$.pipe(takeUntil(this.takeUntil$)).subscribe(() => {\n      this.setDiceRolling(true);\n      this.setIsPending(false);\n    });\n\n    this.diceAfterThrow$.pipe(takeUntil(this.takeUntil$)).subscribe(() => {\n      this.setDiceRolling(false);\n      this.setIsPending(false);\n    });\n\n    this.handleRequestNewThrow$().subscribe();\n    this.performDiceThrowWhenNewDiceThrowLogAppears$().subscribe();\n  }\n\n  private setDiceRolling(diceRolling: boolean): void {\n    this.storeService.dispatch(roomsActions.diceRolling(diceRolling));\n  }\n\n  private setIsPending(isPending: boolean): void {\n    this.storeService.dispatch(uiActions.setIsPending(isPending));\n  }\n\n  private performDiceThrowWhenNewDiceThrowLogAppears$(): Observable<IRoomLog> {\n    return this.storeService.getSelectedRoomLastDiceThrowLog$().pipe(\n      tap(({ payload }: IRoomLog) => this.diceThrow$.next(payload as IDiceThrow)),\n      takeUntil(this.takeUntil$)\n    );\n  }\n\n  private handleRequestNewThrow$(): Observable<IDiceThrow> {\n    return this.requestNewThrow$.pipe(\n      tap(() => {\n        this.setDiceRolling(true);\n        this.setIsPending(true);\n      }),\n      withLatestFrom(this.storeService.getDiceSetFormValues()),\n      filter(([, setDice]) => {\n        const isEveryZero = Object.values(setDice).every(v => v === 0);\n        if (isEveryZero) {\n          this.setDiceRolling(false);\n          this.setIsPending(false);\n\n          this.toast.setSnackbarConfig({\n            type: SnackbarType.WARNING,\n            open: true,\n            text: 'Set at least one dice',\n          });\n        }\n        return !isEveryZero;\n      }),\n      map(([diceThrowConfig, diceSet]: [IDiceThrowConfig, IDiceSet]) => {\n        const diceThrow: IDiceThrow = {\n          diceThrowConfig,\n          diceSet,\n          result: diceUtils.generateThrowResultFromDiceSet(diceSet),\n        };\n        return diceThrow;\n      }),\n      concatMap(diceThrow => {\n        if (!this.roomUid) {\n          return of(null).pipe(\n            tap(() => this.diceThrow$.next(diceThrow)),\n            map(() => diceThrow)\n          );\n        }\n        return this.createNewThrowLogInRoomLogs$(diceThrow);\n      }),\n      takeUntil(this.takeUntil$)\n    );\n  }\n\n  private createNewThrowLogInRoomLogs$(diceThrow: IDiceThrow): Observable<IDiceThrow> {\n    if (!this.roomUid)\n      return of(null).pipe(\n        tap(() =>\n          this.toast.setSnackbarConfig({\n            type: SnackbarType.ERROR,\n            open: true,\n            text: 'Upss.. there was an error set new throw',\n          })\n        ),\n        delay(1000),\n        tap(() => {\n          this.setDiceRolling(false);\n          this.setIsPending(false);\n        })\n      );\n\n    const documentRef = this.firestore.doc(`${FirestoreCollection.ROOMS}/${this.roomUid}`);\n    return from(\n      this.firestore.runTransaction((t: firestore.Transaction) => {\n        return t.get(documentRef).then(doc => {\n          const newLog: IRoomLog = {\n            authorUid: this.profile?.uid,\n            payload: diceThrow,\n            timestamp: Date.now(),\n            type: Log.DICE_ROLL,\n          };\n\n          const logs: IRoomLog[] = [...doc.data().logs, newLog];\n          return t.update(documentRef, { logs });\n        });\n      })\n    ).pipe(map(() => diceThrow));\n  }\n}\n","import React, { useContext, useEffect } from 'react';\nimport { useFirestore } from 'react-redux-firebase';\nimport { useSelector } from 'react-redux';\n\nimport { DiceService } from '../services/dice.service';\nimport { firebaseSelectors } from '../store/firebase/firebase.selectors';\nimport { roomsSelectors } from '../store/rooms/rooms.selectors';\nimport { ToastContext } from './Toast.context';\n\nexport const DiceServiceContext = React.createContext<DiceService | null>(null);\n\ninterface DiceServiceContextProps {}\n\nexport const DiceServiceContextC: React.FC<DiceServiceContextProps> = ({ children }) => {\n  const firestore = useFirestore();\n  const Toast = useContext(ToastContext);\n\n  const diceService = DiceService.getInstance(firestore, Toast);\n  const profile = useSelector(firebaseSelectors.userProfile);\n  const roomUid = useSelector(roomsSelectors.selectedRoomUid);\n\n  useEffect(() => {\n    diceService.profile = profile;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [profile]);\n\n  useEffect(() => {\n    diceService.roomUid = roomUid || null;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [roomUid]);\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useEffect(() => () => diceService.hostDestroyed(), []);\n\n  return <DiceServiceContext.Provider value={diceService}>{children}</DiceServiceContext.Provider>;\n};\n","import { Reducer } from 'redux';\nimport { ChatsAction, ChatsState } from './chats.model';\n\nexport const initialState: ChatsState = {\n  selectedChat: null,\n};\n\nexport const chatsReducer: Reducer<ChatsState> = (state = initialState, action) => {\n  switch (action.type) {\n    case ChatsAction.SELECTED: {\n      return { ...state, selectedChat: action.payload };\n    }\n    default: {\n      return state;\n    }\n  }\n};\n","import { Reducer } from 'redux';\nimport { LocationAction, LocationState } from './location.model';\n\nexport const initialState: LocationState = {\n  match: {\n    params: {},\n    isExact: false,\n    path: '',\n    url: '',\n  },\n};\n\nexport const locationReducer: Reducer<LocationState> = (state: LocationState = initialState, action) => {\n  switch (action.type) {\n    case LocationAction.MATCH_CHANGE: {\n      return { ...state, match: action.payload };\n    }\n    default: {\n      return state;\n    }\n  }\n};\n","import { Reducer } from 'redux';\nimport { RoomsAction, RoomsState } from './rooms.model';\n\nexport const initialState: RoomsState = {\n  selectedRoom: null,\n  drawerOpened: true,\n  chatOpened: true,\n  playersOpened: true,\n  diceRolling: false,\n};\n\nexport const roomsReducer: Reducer<RoomsState> = (state = initialState, action) => {\n  switch (action.type) {\n    case RoomsAction.SELECTED: {\n      return { ...state, selectedRoom: action.payload };\n    }\n    case RoomsAction.SET_DRAWER_OPEN_VALUE: {\n      return { ...state, drawerOpened: action.payload };\n    }\n    case RoomsAction.SET_CHAT_OPEN_VALUE: {\n      return { ...state, chatOpened: action.payload };\n    }\n    case RoomsAction.SET_PLAYERS_OPEN_VALUE: {\n      return { ...state, playersOpened: action.payload };\n    }\n    case RoomsAction.SET_DICE_ROLLING: {\n      return { ...state, diceRolling: action.payload };\n    }\n    default: {\n      return state;\n    }\n  }\n};\n","import { Reducer } from 'redux';\nimport { UiState } from './ui.model';\nimport { UiAction } from './ui.model';\n\nexport const initialState: UiState = {\n  isPending: false,\n};\n\nexport const uiReducer: Reducer<UiState> = (state = initialState, action) => {\n  switch (action.type) {\n    case UiAction.PENDING: {\n      return { ...state, isPending: action.payload };\n    }\n    default: {\n      return state;\n    }\n  }\n};\n","import { Action, combineReducers, Reducer } from 'redux';\nimport { firebaseReducer, FirebaseReducer, FirestoreReducer } from 'react-redux-firebase';\nimport { FormReducer, reducer as formReducer } from 'redux-form';\n// @ts-ignore\nimport firestore from 'redux-firestore/lib/reducer';\n\nimport {\n  FirebaseQuerySchema,\n  FirebaseUserProfile,\n  FirestoreQuerySchema,\n  FirestoreSchema,\n} from './firebase/firebase.types';\nimport { IProfile, IRoomCreateForm, IRoomPlayerProfileForm } from '../models/rooms.model';\nimport { chatsReducer } from './chats/chats.reducer';\nimport { ChatsState } from './chats/chats.model';\nimport { locationReducer } from './location/location.reducer';\nimport { LocationState } from './location/location.model';\nimport { RoomsState } from './rooms/rooms.model';\nimport { roomsReducer } from './rooms/rooms.reducer';\nimport { UiState } from './ui/ui.model';\nimport { uiReducer } from './ui/ui.reducer';\n\n/**********************************************************\n * Interfaces\n **********************************************************/\n\ninterface RootState {\n  firestore: FirestoreReducer.Reducer & {\n    data: FirestoreSchema & FirestoreQuerySchema;\n  };\n  firebase: FirebaseReducer.Reducer<FirebaseUserProfile> & {\n    auth: IProfile;\n    profile: IProfile;\n    data: FirebaseQuerySchema | any;\n  };\n}\n\n/**********************************************************\n * functions\n **********************************************************/\nexport function makeRootReducer<S = any, A extends Action = Action>(asyncReducers?: Reducer<S, A>) {\n  return combineReducers({\n    firebase: firebaseReducer,\n    firestore,\n    chats: chatsReducer,\n    rooms: roomsReducer,\n    location: locationReducer,\n    form: formReducer,\n    ui: uiReducer,\n    ...asyncReducers,\n  });\n}\n\nconst rootReducer = combineReducers<RootState>({\n  firebase: firebaseReducer as any,\n  firestore,\n});\n\nexport interface IDiceSetForm {\n  registeredFields: {\n    [key: string]: Object;\n  };\n  values: {\n    [key: string]: number;\n  };\n}\n\nexport interface AppState extends ReturnType<typeof rootReducer> {\n  chats: ChatsState;\n  rooms: RoomsState;\n  location: LocationState;\n  form: FormReducer & {\n    diceSetForm: IDiceSetForm;\n    createRoom: { values: IRoomCreateForm };\n    playerProfile: { values: IRoomPlayerProfileForm };\n  };\n  ui: UiState;\n}\n","import thunk from 'redux-thunk';\nimport { applyMiddleware, compose, createStore } from 'redux';\nimport { getFirebase } from 'react-redux-firebase';\nimport { getFirestore } from 'redux-firestore';\n\nimport { makeRootReducer } from '../store/main';\n\nconst initialState = (window as any).___INITIAL_STATE__ || {\n  firebase: { authError: null },\n};\n\nexport const store = configureStore(initialState);\n\nfunction configureStore(initialState: any): any {\n  // ======================================================\n  // Store Enhancers\n  // ======================================================\n  const enhancers = [];\n\n  if (window && window.location && window.location.hostname === 'localhost') {\n    const devToolsExtension = (window as any).__REDUX_DEVTOOLS_EXTENSION__;\n    if (typeof devToolsExtension === 'function') {\n      enhancers.push(devToolsExtension());\n    }\n  }\n\n  // ======================================================\n  // Middleware Configuration\n  // ======================================================\n  const middleware = [\n    thunk.withExtraArgument({ getFirebase, getFirestore }),\n    // This is where you add other middleware like redux-observable\n  ];\n\n  // ======================================================\n  // Store Instantiation and HMR Setup\n  // ======================================================\n  const store = createStore(makeRootReducer(), initialState, compose(applyMiddleware(...middleware), ...enhancers));\n\n  if ((module as any).hot) {\n    // Enable Webpack hot module replacement for reducers\n    (module as any).hot.accept('../store/main', () => {\n      const nextRootReducer = require('../store/main'); // eslint-disable-line global-require, @typescript-eslint/no-var-requires\n      store.replaceReducer(nextRootReducer);\n    });\n  }\n\n  return store;\n}\n","import { Dice, IDiceSet, INewDiceThrowResult } from '../models/dice.model';\nimport { DiceRoller } from 'rpg-dice-roller';\n\nconst roller = new DiceRoller();\n\nexport const diceUtils = {\n  diceSetToString: (dices: IDiceSet): string => {\n    return Object.keys(dices)\n      .map(diceName => (!!dices[diceName] ? dices[diceName] + diceName : ''))\n      .filter(dice => !!dice.length)\n      .join('+');\n  },\n\n  generateThrowResultFromDiceSet: (diceSet: IDiceSet): INewDiceThrowResult => {\n    let diceTrowResult: INewDiceThrowResult = {};\n\n    Object.keys(diceSet).forEach(diceKey => {\n      if (!diceSet[diceKey]) return;\n      const rollSet = diceKey === Dice.D100 ? `${diceSet[diceKey]}${Dice.D10}` : `${diceSet[diceKey]}${diceKey}`;\n      // @ts-ignore\n      let rollOutput = /\\[(.*)\\]/\n        .exec(roller.roll(rollSet))[1]\n        .split(/,\\s?/)\n        .map(d => +d);\n\n      if (diceKey === Dice.D100) {\n        rollOutput = rollOutput.map(d => (d === 10 ? 0 : d * 10));\n      }\n      diceTrowResult[diceKey] = [...rollOutput];\n    });\n\n    return diceTrowResult;\n  },\n\n  sortDiceFunction: (a, b) => parseInt(a.slice(1)) - parseInt(b.slice(1)),\n\n  sortObjectWithDiceKey: (obj: { [key: string]: any }): { [key: string]: any } => {\n    const result: { [key: string]: any } = {};\n    Object.keys(obj)\n      .sort((a, b) => parseInt(a.slice(1)) - parseInt(b.slice(1)))\n      .forEach(diceKey => (result[diceKey] = obj[diceKey]));\n    return result;\n  },\n};\n","import { AppState } from '../main';\nimport { LocationMatch } from './location.model';\n\nexport const locationSelectors = {\n  match: (state: AppState): LocationMatch => state.location.match,\n};\n","import { AppState } from '../main';\n\nexport const chatsSelectors = {\n  selectedChat: (state: AppState): string | null => state.chats.selectedChat,\n\n  profilesUidFromSelectedChat: (state: AppState): string[] => {\n    if (!state.chats.selectedChat) return [];\n\n    return state.firestore.data?.userChats?.[state.chats.selectedChat]?.players || [];\n  },\n};\n","import { action } from 'typesafe-actions';\nimport { ChatsAction } from './chats.model';\n\nexport const chatsActions = {\n  setSelectedChat: (payload: string | null) => action(ChatsAction.SELECTED, payload),\n};\n","export enum ChatsAction {\n  SELECTED = '@@chats/SELECTED',\n}\n\nexport interface ChatsState {\n  readonly selectedChat: string | null;\n}\n","import { RouterPath } from '../../models/paths';\n\nexport enum LocationAction {\n  MATCH_CHANGE = '@@location/MATCH_CHANGE',\n}\n\nexport interface LocationMatch<Params extends { [K in keyof Params]?: string } = {}> {\n  params: Params;\n  isExact: boolean;\n  path: RouterPath | string;\n  url: string;\n}\n\nexport interface LocationState {\n  readonly match: LocationMatch;\n}\n","export enum UiAction {\n  PENDING = '@@ui/PENDING',\n}\n\nexport interface UiState {\n  readonly isPending: boolean;\n}\n","import React from 'react';\nimport { Avatar, Grow, List, ListItem, ListItemAvatar, ListItemText } from '@material-ui/core';\nimport { createStyles, Theme, withStyles, WithStyles } from '@material-ui/core/styles';\nimport { Dictionary } from 'react-redux-firebase';\n\nimport { firstLettersJoined } from '../../../utils/text.utils';\nimport { IChat } from '../../../models/chats.model';\nimport { dateUtils } from '../../../utils/date.utils';\nimport { equal } from '../../../utils/object.utils';\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    root: {\n      width: '100%',\n      backgroundColor: theme.palette.background.paper,\n      height: '20vh',\n      overflowY: 'scroll',\n    },\n    item: {\n      cursor: 'pointer',\n    },\n  });\n\ninterface ChatListElementProps extends WithStyles<typeof styles> {\n  chats: Dictionary<IChat>;\n  selectedChat: string | null;\n  onChatClick: (chatId: string) => void;\n}\n\nfunction ChatListElementC(props: ChatListElementProps) {\n  const { classes, chats, onChatClick, selectedChat } = props;\n\n  const renderElement = () =>\n    Object.keys(chats).map((chatId, id) => (\n      <Grow key={chatId} in timeout={1000 * id + 300}>\n        <ListItem\n          onClick={() => onChatClick(chatId)}\n          selected={chatId === selectedChat}\n          className={classes.item}\n          button\n          dense\n          alignItems=\"flex-start\"\n        >\n          <ListItemAvatar>\n            <Avatar>{firstLettersJoined(chats[chatId].roomName || 'No name')}</Avatar>\n          </ListItemAvatar>\n          <ListItemText\n            primary={chats[chatId].roomName || 'No name'}\n            secondary={dateUtils.timeStampToFormattedDate(chats[chatId].createdAt)}\n          />\n        </ListItem>\n      </Grow>\n    ));\n\n  return <List className={classes.root}>{renderElement()}</List>;\n}\n\nexport const ChatListElements = React.memo(withStyles(styles)(ChatListElementC), (prev, next) =>\n  equal(Object.keys(prev.chats), Object.keys(next.chats) && prev.selectedChat === next.selectedChat)\n);\n","import AppBar from '@material-ui/core/AppBar';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport React, { useEffect } from 'react';\nimport SearchIcon from '@material-ui/icons/Search';\nimport TextField from '@material-ui/core/TextField';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport { createStyles, Theme, withStyles, WithStyles } from '@material-ui/core/styles';\nimport { Dictionary } from 'react-redux-firebase';\nimport { Grow } from '@material-ui/core';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport { IChat } from '../../models/chats.model';\nimport { ChatListElements } from './components/ChatListElements';\nimport { chatsActions } from '../../store/chats/chats.actions';\nimport { chatsSelectors } from '../../store/chats/chats.selectors';\nimport { firestoreSelectors } from '../../store/firebase/firestore.selectors';\n\nexport enum ChatListType {\n  EMBEDDED = 'EMBEDDED',\n  CARD = 'CARD',\n}\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    paper: {\n      maxWidth: 936,\n      margin: 'auto',\n      overflow: 'hidden',\n    },\n    searchBar: {\n      borderBottom: '1px solid rgba(0, 0, 0, 0.12)',\n    },\n    searchInput: {\n      fontSize: theme.typography.fontSize,\n    },\n    block: {\n      display: 'block',\n    },\n    addUser: {\n      marginRight: theme.spacing(1),\n    },\n    contentWrapper: {\n      margin: '16px 16px',\n    },\n  });\n\nexport interface ChatListProps extends WithStyles<typeof styles> {\n  showSearchBar?: boolean;\n  viewType?: ChatListType;\n}\n\nfunction ChatListC(props: ChatListProps) {\n  const { classes, showSearchBar = true, viewType = ChatListType.CARD } = props;\n  const userChats: Dictionary<IChat> = useSelector(firestoreSelectors.userChats) || {};\n  const selectedChat: string | null = useSelector(chatsSelectors.selectedChat);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    return () => {\n      dispatch(chatsActions.setSelectedChat(null));\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    if (!selectedChat && Object.keys(userChats || {}).length) {\n      dispatch(chatsActions.setSelectedChat(Object.keys(userChats as any)[0]));\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [!!selectedChat, Object.keys(userChats || {}).length === 0]);\n\n  const onChatClick = (chatId: string) => {\n    dispatch(chatsActions.setSelectedChat(chatId));\n  };\n\n  return (\n    <Grow in>\n      {viewType === ChatListType.CARD ? (\n        <Paper className={classes.paper}>\n          {showSearchBar && (\n            <AppBar className={classes.searchBar} position=\"static\" color=\"default\" elevation={0}>\n              <Toolbar>\n                <Grid container spacing={2} alignItems=\"center\">\n                  <Grid item>\n                    <SearchIcon className={classes.block} color=\"inherit\" />\n                  </Grid>\n                  <Grid item xs>\n                    <TextField\n                      fullWidth\n                      placeholder=\"Search chat by room name or players\"\n                      InputProps={{\n                        disableUnderline: true,\n                        className: classes.searchInput,\n                      }}\n                    />\n                  </Grid>\n                </Grid>\n              </Toolbar>\n            </AppBar>\n          )}\n          <div className={classes.contentWrapper}>\n            <ChatListElements chats={userChats} onChatClick={onChatClick} selectedChat={selectedChat} />\n          </div>\n        </Paper>\n      ) : (\n        <ChatListElements chats={userChats} onChatClick={onChatClick} selectedChat={selectedChat} />\n      )}\n    </Grow>\n  );\n}\n\nexport const ChatList = withStyles(styles)(ChatListC);\n","import { AppState } from './main';\nimport { firestoreSelectors } from './firebase/firestore.selectors';\nimport { chatsSelectors } from './chats/chats.selectors';\nimport { IRoomCreateForm, IRoomPlayerProfileForm } from '../models/rooms.model';\n\nexport const mainSelectors = {\n  getAllNeededPlayersUid: (state: AppState): string[] => {\n    const selectedRoomPlayers = firestoreSelectors.selectedRoom(state)?.players || {};\n    const selectedRoomGM = firestoreSelectors.selectedRoom(state)?.gameMasterUid;\n    const selectedChatPlayers = chatsSelectors.profilesUidFromSelectedChat(state) || [];\n    return [...selectedChatPlayers, ...Object.keys(selectedRoomPlayers), selectedRoomGM].filter(\n      (v, i, a) => !!v && a.indexOf(v) === i\n    );\n  },\n\n  isGameMasterOfSelectedRoom: (state: AppState): boolean => {\n    const selectedRoomGameMaster = state.firestore.data.selectedRoom\n      ? state.firestore.data.selectedRoom.gameMasterUid\n      : 'unknown';\n\n    return selectedRoomGameMaster === state.firebase.profile.uid;\n  },\n\n  getFormCreateRoom: (state: AppState): IRoomCreateForm => state.form.createRoom.values,\n\n  getFormPlayerProfile: (state: AppState): IRoomPlayerProfileForm => state.form.playerProfile.values,\n\n  isUserARoomPlayerOrGameMaster: (state: AppState): boolean => {\n    if (!state.firestore.data.selectedRoom || !state.firebase.profile.uid) return false;\n    return (\n      !!state.firestore.data.selectedRoom?.players[state.firebase.profile.uid] ||\n      state.firestore.data.selectedRoom?.gameMasterUid === state.firebase.profile.uid\n    );\n  },\n};\n","import dayjs from 'dayjs';\n\nexport const dateUtils = {\n  timeStampToFormattedDate: (time: string | number): string =>\n    dayjs(new Date(new Date(+time))).format('dddd, MMMM D YYYY'),\n\n  timeStampToDetailedTime: (time: string | number): string => dayjs(new Date(new Date(+time))).format('h:mm:ss'),\n};\n","import React from 'react';\nimport { createStyles, Theme, withStyles, WithStyles } from '@material-ui/core/styles';\nimport { equal } from '../utils/object.utils';\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    root: {\n      display: 'flex',\n      alignItems: 'center',\n      flexDirection: 'column',\n      justifyContent: 'flex-start',\n      height: '100%',\n      width: '100%',\n      backgroundColor: theme.palette.background.default,\n      position: 'absolute',\n      zIndex: 10000,\n      left: 0,\n      top: 0,\n    },\n    progress: {\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      height: '100%',\n    },\n    svg: {\n      width: '15vw',\n      height: '15vh',\n    },\n  });\n\ninterface LoaderProps extends WithStyles<typeof styles> {\n  style?: Object;\n}\n\nfunction LoaderC(props: LoaderProps) {\n  const { classes, style } = props;\n\n  return (\n    <div className={classes.root} style={style}>\n      <div className={classes.progress}>\n        <img\n          className={classes.svg}\n          src={`${process.env.PUBLIC_URL}/assets/svg/loader-knot.svg`}\n          alt=\"Roll a Dice...\"\n        />\n      </div>\n    </div>\n  );\n}\n\nexport const Loader = React.memo(withStyles(styles)(LoaderC), equal);\n","import React from 'react';\nimport {\n  Checkbox,\n  FormControl,\n  FormControlLabel,\n  FormGroup,\n  FormHelperText,\n  FormLabel,\n  InputLabel,\n  Select,\n  Slider,\n  TextField,\n} from '@material-ui/core';\nimport { Field } from 'redux-form';\nimport { makeStyles, Theme } from '@material-ui/core/styles';\nimport { equal } from '../utils/object.utils';\n\n/*\n * Model\n */\ninterface FormFieldGenericProps<T = any> {\n  name: string;\n  label: string;\n  value?: T;\n  min?: number;\n  max?: number;\n  [key: string]: any;\n}\nexport interface IGroupOption {\n  label: string;\n  value: string | number;\n}\n\ninterface FormFieldWithOptionsProps extends FormFieldGenericProps {\n  options: IGroupOption[];\n}\n\n/*\n * Styles\n */\n\nconst styles = (theme: Theme) => ({\n  formField: { marginBottom: theme.spacing(2) },\n  sliderFormField: {\n    width: '100%',\n    marginLeft: 0,\n  },\n});\n\nconst useStyles = makeStyles(styles);\n\n/*\n * Components\n */\n\nexport const FormFieldHelperText = ({ touched, error }: any) => {\n  if (!(touched && error)) {\n    return;\n  } else {\n    return <FormHelperText>{touched && error}</FormHelperText>;\n  }\n};\n\nexport const FormFieldText = React.memo((props: FormFieldGenericProps) => {\n  const classes = useStyles();\n\n  const formField = ({ label, input, meta: { touched, invalid, error }, ...custom }: any) => (\n    <TextField\n      variant=\"outlined\"\n      label={label}\n      placeholder={label}\n      error={touched && invalid}\n      helperText={touched && error}\n      {...input}\n      {...custom}\n    />\n  );\n\n  return <Field {...props} component={formField} className={classes.formField} />;\n}, equal);\n\nexport const FormFieldSelect = React.memo((props: FormFieldGenericProps) => {\n  const classes = useStyles();\n\n  const field = ({ input, label, meta: { touched, error }, children, ...custom }: FormFieldGenericProps) => {\n    return (\n      <FormControl error={touched && error}>\n        <InputLabel htmlFor=\"age-native-simple\">Age</InputLabel>\n        <Select\n          variant=\"outlined\"\n          native\n          {...input}\n          {...custom}\n          inputProps={{\n            name: 'age',\n            id: 'age-native-simple',\n          }}\n        >\n          {children}\n        </Select>\n        {FormFieldHelperText({ touched, error })}\n      </FormControl>\n    );\n  };\n\n  return <Field {...props} type=\"checkbox\" component={field} className={classes.formField} />;\n}, equal);\n\nexport const FormFieldCheckbox = React.memo((props: FormFieldGenericProps) => {\n  const classes = useStyles();\n\n  const field = ({ input, label }: FormFieldGenericProps) => {\n    return <FormControlLabel control={<Checkbox checked={!!input.value} onChange={input.onChange} />} label={label} />;\n  };\n\n  return <Field {...props} type=\"checkbox\" component={field} className={classes.formField} />;\n}, equal);\n\nexport const FormFieldCheckboxGroup = React.memo((props: FormFieldWithOptionsProps) => {\n  const classes = useStyles();\n\n  const field = ({ input, meta, options, label }: FormFieldWithOptionsProps) => {\n    const { name, onChange } = input;\n    const { touched, error } = meta;\n    const inputValue = input.value;\n\n    const checkboxesFormControls = options.map(({ label, value }: any, index: number) => {\n      const handleChange = (event: any) => {\n        const arr = [...inputValue];\n        if (event.target.checked) {\n          arr.push(value);\n        } else {\n          arr.splice(arr.indexOf(value), 1);\n        }\n        return onChange(arr);\n      };\n      const checked = inputValue.includes(value);\n      return (\n        <FormControlLabel\n          key={index}\n          control={<Checkbox checked={checked} onChange={handleChange} name={`${name}[${index}]`} value={value} />}\n          label={label}\n        />\n      );\n    });\n\n    return (\n      <FormControl error={touched && !!error} component=\"fieldset\">\n        <FormLabel component=\"legend\">{label}</FormLabel>\n        <FormGroup row>{checkboxesFormControls}</FormGroup>\n        {FormFieldHelperText({ touched, error })}\n      </FormControl>\n    );\n  };\n\n  return <Field {...props} type=\"checkbox\" component={field} className={classes.formField} />;\n}, equal);\n\nexport const FormFieldSlider = React.memo((props: FormFieldGenericProps) => {\n  const classes = useStyles();\n\n  function valuetext(value: number) {\n    return `${value}`;\n  }\n\n  const formField = ({\n    min = 0,\n    max = 16,\n    label,\n    input: { value, onChange, ...inputRest },\n    meta: { touched, invalid, error },\n    ...custom\n  }: any) => {\n    return (\n      <FormControlLabel\n        className={classes.sliderFormField}\n        label={label}\n        labelPlacement=\"start\"\n        control={\n          <Slider\n            style={{ marginBottom: 0 }}\n            defaultValue={0}\n            getAriaValueText={valuetext}\n            aria-labelledby=\"number-of-dices\"\n            valueLabelDisplay=\"auto\"\n            step={1}\n            marks\n            min={min}\n            max={max}\n            value={typeof value === 'number' ? value : 0}\n            onChange={(e: Event, value: number) => onChange(value)}\n            {...inputRest}\n            {...custom}\n          />\n        }\n      />\n    );\n  };\n\n  return <Field {...props} component={formField} className={classes.formField} />;\n}, equal);\n","import { action } from 'typesafe-actions';\n\nimport { LocationAction, LocationMatch } from './location.model';\n\nexport const locationActions = {\n  matchChange: (payload: LocationMatch) => action(LocationAction.MATCH_CHANGE, payload),\n};\n","import { action } from 'typesafe-actions';\nimport { RoomsAction } from './rooms.model';\n\nexport const roomsActions = {\n  setSelectedRoom: (payload: string | null) => action(RoomsAction.SELECTED, payload),\n  setDrawerOpenValue: (payload: boolean) => action(RoomsAction.SET_DRAWER_OPEN_VALUE, payload),\n  setChatOpenValue: (payload: boolean) => action(RoomsAction.SET_CHAT_OPEN_VALUE, payload),\n  setPlayersOpenValue: (payload: boolean) => action(RoomsAction.SET_PLAYERS_OPEN_VALUE, payload),\n  diceRolling: (payload: boolean) => action(RoomsAction.SET_DICE_ROLLING, payload),\n};\n","export enum RouterPath {\n  CHATS_PATH = '/chats',\n  CHATS_PATH_ID = '/chats/:chatId',\n  HOME_PATH = '/',\n  ROOM_CREATE_PATH = '/rooms/create',\n  ROOM_PATH = '/room',\n  ROOMS_PATH = '/rooms',\n  ROOMS_PATH_ID = '/room/:roomId',\n}\n","export const firstLettersJoined: (sentence: string) => string = sentence =>\n  sentence\n    .split(' ')\n    .map(word => word.charAt(0))\n    .join('')\n    .substring(0, 2)\n    .toUpperCase();\n","export const diceDefaultConfig = {\n  idCanvas: 'canvas',\n  idLabel: 'label',\n  idSet: 'set',\n  idSelectorDiv: 'selector_div',\n  idInfoDiv: 'info_div',\n  useTrueRandom: false,\n  useShadows: true,\n  whiteDice: false,\n  noresult: false,\n  diceThrow$: null,\n  diceThrowResult$: null,\n};\n","/* eslint-disable */\n/* tslint-disable */\n\nimport * as THREE from 'three';\nimport CANNON from 'cannon';\n\n('use strict');\n\n/************************************************************************************\n * TEAL\n ************************************************************************************/\n\nconst teal = {};\nconst $t = teal;\n\nteal.copyto = function(obj, res) {\n  if (obj == null || typeof obj !== 'object') return obj;\n  if (obj instanceof Array) {\n    for (var i = obj.length - 1; i >= 0; --i) res[i] = $t.copy(obj[i]);\n  } else {\n    for (var i in obj) {\n      if (obj.hasOwnProperty(i)) res[i] = $t.copy(obj[i]);\n    }\n  }\n  return res;\n};\n\nteal.copy = function(obj) {\n  if (!obj) return obj;\n  return teal.copyto(obj, new obj.constructor());\n};\n\nteal.element = function(name, props, place, content) {\n  var dom = document.createElement(name);\n  if (props) for (var i in props) dom.setAttribute(i, props[i]);\n  if (place) place.appendChild(dom);\n  if (content !== undefined) $t.inner(content, dom);\n  return dom;\n};\n\nteal.inner = function(obj, sel) {\n  sel.appendChild(obj.nodeName != undefined ? obj : document.createTextNode(obj));\n  return sel;\n};\n\nteal.id = function(id) {\n  return document.getElementById(id);\n};\n\nteal.set = function(sel, props) {\n  for (var i in props) sel.setAttribute(i, props[i]);\n  return sel;\n};\n\nteal.clas = function(sel, oldclass, newclass) {\n  var oc = oldclass ? oldclass.split(/\\s+/) : [],\n    nc = newclass ? newclass.split(/\\s+/) : [],\n    classes = (sel.getAttribute('class') || '').split(/\\s+/);\n  if (!classes[0]) classes = [];\n  for (var i in oc) {\n    var ind = classes.indexOf(oc[i]);\n    if (ind >= 0) classes.splice(ind, 1);\n  }\n  for (var i in nc) {\n    if (nc[i] && classes.indexOf(nc[i]) < 0) classes.push(nc[i]);\n  }\n  sel.setAttribute('class', classes.join(' '));\n};\n\nteal.empty = function(sel) {\n  if (sel.childNodes) while (sel.childNodes.length) sel.removeChild(sel.firstChild);\n};\n\nteal.remove = function(sel) {\n  if (sel) {\n    if (sel.parentNode) sel.parentNode.removeChild(sel);\n    else for (var i = sel.length - 1; i >= 0; --i) sel[i].parentNode.removeChild(sel[i]);\n  }\n};\n\nteal.bind = function(sel, eventname, func, bubble) {\n  if (!sel) return;\n  if (eventname.constructor === Array) {\n    for (var i in eventname) sel.addEventListener(eventname[i], func, bubble ? bubble : false);\n  } else sel.addEventListener(eventname, func, bubble ? bubble : false);\n};\n\nteal.unbind = function(sel, eventname, func, bubble) {\n  if (eventname.constructor === Array) {\n    for (var i in eventname) sel.removeEventListener(eventname[i], func, bubble ? bubble : false);\n  } else sel.removeEventListener(eventname, func, bubble ? bubble : false);\n};\n\nteal.one = function(sel, eventname, func, bubble) {\n  var one_func = function(e) {\n    func.call(this, e);\n    teal.unbind(sel, eventname, one_func, bubble);\n  };\n  teal.bind(sel, eventname, one_func, bubble);\n};\n\nteal.raise_event = function(sel, eventname, bubble, cancelable) {\n  var evt = document.createEvent('UIEvents');\n  evt.initEvent(eventname, bubble == undefined ? true : bubble, cancelable == undefined ? true : cancelable);\n  sel.dispatchEvent(evt);\n};\n\nteal.raise = function(sel, eventname, params, bubble, cancelable) {\n  var ev = document.createEvent('CustomEvent');\n  ev.initCustomEvent(eventname, bubble, cancelable, params);\n  sel.dispatchEvent(ev);\n};\n\nif (!document.getElementsByClassName) {\n  teal.get_elements_by_class = function(classes, node) {\n    var node = node || document,\n      list = node.getElementsByTagName('*'),\n      cl = classes.split(/\\s+/),\n      result = [];\n\n    for (var i = list.length - 1; i >= 0; --i) {\n      for (var j = cl.length - 1; j >= 0; --j) {\n        var clas = list[i].getAttribute('class');\n        if (clas && clas.search('\\\\b' + cl[j] + '\\\\b') != -1) {\n          result.push(list[i]);\n          break;\n        }\n      }\n    }\n    return result;\n  };\n} else {\n  teal.get_elements_by_class = function(classes, node) {\n    return (node || document).getElementsByClassName(classes);\n  };\n}\n\nteal.rpc = function(params, callback, noparse) {\n  var ajax = new XMLHttpRequest();\n  ajax.open('post', 'f', true);\n  ajax.onreadystatechange = function() {\n    if (ajax.readyState == 4) callback.call(ajax, noparse ? ajax.responseText : JSON.parse(ajax.responseText));\n  };\n  ajax.send(JSON.stringify(params));\n};\n\nteal.uuid = function() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = (Math.random() * 16) | 0,\n      v = c == 'x' ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n};\n\nteal.get_url_params = function() {\n  var params = window.location.search.substring(1).split('&');\n  var res = {};\n  for (var i in params) {\n    var keyvalue = params[i].split('=');\n    res[keyvalue[0]] = decodeURI(keyvalue[1]);\n  }\n  return res;\n};\n\nteal.get_mouse_coords = function(ev) {\n  var touches = ev.changedTouches;\n  if (touches) return { x: touches[0].clientX, y: touches[0].clientY };\n  return { x: ev.clientX, y: ev.clientY };\n};\n\nteal.deferred = function() {\n  var solved = false,\n    callbacks = [],\n    args = [];\n  function solve() {\n    while (callbacks.length) {\n      callbacks.shift().apply(this, args);\n    }\n  }\n  return {\n    promise: function() {\n      return {\n        then: function(callback) {\n          var deferred = teal.deferred(),\n            promise = deferred.promise();\n          callbacks.push(function() {\n            var res = callback.apply(this, arguments);\n            if (res && 'done' in res) res.done(deferred.resolve);\n            else deferred.resolve.apply(this, arguments);\n          });\n          return promise;\n        },\n        done: function(callback) {\n          callbacks.push(callback);\n          if (solved) solve();\n          return this;\n        },\n        cancel: function() {\n          callbacks = [];\n        },\n      };\n    },\n    resolve: function() {\n      solved = true;\n      args = Array.prototype.slice.call(arguments, 0);\n      solve();\n    },\n  };\n};\n\nteal.when = function(promises) {\n  var deferred = teal.deferred();\n  var count = promises.length,\n    ind = 0;\n  if (count == 0) deferred.resolve();\n  for (var i = 0; i < count; ++i) {\n    promises[i].done(function() {\n      if (++ind == count) deferred.resolve();\n    });\n  }\n  return deferred.promise();\n};\n\n/************************************************************************************\n * DICE\n ************************************************************************************/\n\n(function(dice) {\n  var random_storage = [];\n  this.use_true_random = true;\n  this.frame_rate = 1 / 60;\n\n  function prepare_rnd(callback) {\n    if (!random_storage.length && $t.dice.use_true_random) {\n      try {\n        $t.rpc({ method: 'random', n: 512 }, function(random_responce) {\n          if (!random_responce.error) random_storage = random_responce.result.random.data;\n          else $t.dice.use_true_random = false;\n          callback();\n        });\n        return;\n      } catch (e) {\n        $t.dice.use_true_random = false;\n      }\n    }\n    callback();\n  }\n\n  function rnd() {\n    return random_storage.length ? random_storage.pop() : Math.random();\n  }\n\n  function create_shape(vertices, faces, radius) {\n    var cv = new Array(vertices.length),\n      cf = new Array(faces.length);\n    for (var i = 0; i < vertices.length; ++i) {\n      var v = vertices[i];\n      cv[i] = new CANNON.Vec3(v.x * radius, v.y * radius, v.z * radius);\n    }\n    for (var i = 0; i < faces.length; ++i) {\n      cf[i] = faces[i].slice(0, faces[i].length - 1);\n    }\n    return new CANNON.ConvexPolyhedron(cv, cf);\n  }\n\n  function make_geom(vertices, faces, radius, tab, af) {\n    var geom = new THREE.Geometry();\n    for (var i = 0; i < vertices.length; ++i) {\n      var vertex = vertices[i].multiplyScalar(radius);\n      vertex.index = geom.vertices.push(vertex) - 1;\n    }\n    for (var i = 0; i < faces.length; ++i) {\n      var ii = faces[i],\n        fl = ii.length - 1;\n      var aa = (Math.PI * 2) / fl;\n      for (var j = 0; j < fl - 2; ++j) {\n        geom.faces.push(\n          new THREE.Face3(\n            ii[0],\n            ii[j + 1],\n            ii[j + 2],\n            [geom.vertices[ii[0]], geom.vertices[ii[j + 1]], geom.vertices[ii[j + 2]]],\n            0,\n            ii[fl] + 1\n          )\n        );\n        geom.faceVertexUvs[0].push([\n          new THREE.Vector2((Math.cos(af) + 1 + tab) / 2 / (1 + tab), (Math.sin(af) + 1 + tab) / 2 / (1 + tab)),\n          new THREE.Vector2(\n            (Math.cos(aa * (j + 1) + af) + 1 + tab) / 2 / (1 + tab),\n            (Math.sin(aa * (j + 1) + af) + 1 + tab) / 2 / (1 + tab)\n          ),\n          new THREE.Vector2(\n            (Math.cos(aa * (j + 2) + af) + 1 + tab) / 2 / (1 + tab),\n            (Math.sin(aa * (j + 2) + af) + 1 + tab) / 2 / (1 + tab)\n          ),\n        ]);\n      }\n    }\n    geom.computeFaceNormals();\n    geom.boundingSphere = new THREE.Sphere(new THREE.Vector3(), radius);\n    return geom;\n  }\n\n  function chamfer_geom(vectors, faces, chamfer) {\n    var chamfer_vectors = [],\n      chamfer_faces = [],\n      corner_faces = new Array(vectors.length);\n    for (var i = 0; i < vectors.length; ++i) corner_faces[i] = [];\n    for (var i = 0; i < faces.length; ++i) {\n      var ii = faces[i],\n        fl = ii.length - 1;\n      var center_point = new THREE.Vector3();\n      var face = new Array(fl);\n      for (var j = 0; j < fl; ++j) {\n        var vv = vectors[ii[j]].clone();\n        center_point.add(vv);\n        corner_faces[ii[j]].push((face[j] = chamfer_vectors.push(vv) - 1));\n      }\n      center_point.divideScalar(fl);\n      for (var j = 0; j < fl; ++j) {\n        var vv = chamfer_vectors[face[j]];\n        vv.subVectors(vv, center_point)\n          .multiplyScalar(chamfer)\n          .addVectors(vv, center_point);\n      }\n      face.push(ii[fl]);\n      chamfer_faces.push(face);\n    }\n    for (var i = 0; i < faces.length - 1; ++i) {\n      for (var j = i + 1; j < faces.length; ++j) {\n        var pairs = [],\n          lastm = -1;\n        for (var m = 0; m < faces[i].length - 1; ++m) {\n          var n = faces[j].indexOf(faces[i][m]);\n          if (n >= 0 && n < faces[j].length - 1) {\n            if (lastm >= 0 && m != lastm + 1) pairs.unshift([i, m], [j, n]);\n            else pairs.push([i, m], [j, n]);\n            lastm = m;\n          }\n        }\n        if (pairs.length != 4) continue;\n        chamfer_faces.push([\n          chamfer_faces[pairs[0][0]][pairs[0][1]],\n          chamfer_faces[pairs[1][0]][pairs[1][1]],\n          chamfer_faces[pairs[3][0]][pairs[3][1]],\n          chamfer_faces[pairs[2][0]][pairs[2][1]],\n          -1,\n        ]);\n      }\n    }\n    for (var i = 0; i < corner_faces.length; ++i) {\n      var cf = corner_faces[i],\n        face = [cf[0]],\n        count = cf.length - 1;\n      while (count) {\n        for (var m = faces.length; m < chamfer_faces.length; ++m) {\n          var index = chamfer_faces[m].indexOf(face[face.length - 1]);\n          if (index >= 0 && index < 4) {\n            if (--index == -1) index = 3;\n            var next_vertex = chamfer_faces[m][index];\n            if (cf.indexOf(next_vertex) >= 0) {\n              face.push(next_vertex);\n              break;\n            }\n          }\n        }\n        --count;\n      }\n      face.push(-1);\n      chamfer_faces.push(face);\n    }\n    return { vectors: chamfer_vectors, faces: chamfer_faces };\n  }\n\n  function create_geom(vertices, faces, radius, tab, af, chamfer) {\n    var vectors = new Array(vertices.length);\n    for (var i = 0; i < vertices.length; ++i) {\n      vectors[i] = new THREE.Vector3().fromArray(vertices[i]).normalize();\n    }\n    var cg = chamfer_geom(vectors, faces, chamfer);\n    var geom = make_geom(cg.vectors, cg.faces, radius, tab, af);\n    //var geom = make_geom(vectors, faces, radius, tab, af); // Without chamfer\n    geom.cannon_shape = create_shape(vectors, faces, radius);\n    return geom;\n  }\n\n  this.standart_d20_dice_face_labels = [\n    ' ',\n    '0',\n    '1',\n    '2',\n    '3',\n    '4',\n    '5',\n    '6',\n    '7',\n    '8',\n    '9',\n    '10',\n    '11',\n    '12',\n    '13',\n    '14',\n    '15',\n    '16',\n    '17',\n    '18',\n    '19',\n    '20',\n  ];\n  this.standart_d100_dice_face_labels = [' ', '00', '10', '20', '30', '40', '50', '60', '70', '80', '90'];\n\n  function calc_texture_size(approx) {\n    return Math.pow(2, Math.floor(Math.log(approx) / Math.log(2)));\n  }\n\n  this.create_dice_materials = function(face_labels, size, margin) {\n    function create_text_texture(text, color, back_color) {\n      if (text == undefined) return null;\n      var canvas = document.createElement('canvas');\n      var context = canvas.getContext('2d');\n      var ts = calc_texture_size(size + size * 2 * margin) * 2;\n      canvas.width = canvas.height = ts;\n      context.font = ts / (1 + 2 * margin) + 'pt Arial';\n      context.fillStyle = back_color;\n      context.fillRect(0, 0, canvas.width, canvas.height);\n      context.textAlign = 'center';\n      context.textBaseline = 'middle';\n      context.fillStyle = color;\n      context.fillText(text, canvas.width / 2, canvas.height / 2);\n      if (text == '6' || text == '9') {\n        context.fillText('  .', canvas.width / 2, canvas.height / 2);\n      }\n      var texture = new THREE.Texture(canvas);\n      texture.needsUpdate = true;\n      return texture;\n    }\n    var materials = [];\n    for (var i = 0; i < face_labels.length; ++i)\n      materials.push(\n        new THREE.MeshPhongMaterial(\n          $t.copyto(this.material_options, {\n            map: create_text_texture(face_labels[i], this.label_color, this.dice_color),\n          })\n        )\n      );\n    return materials;\n  };\n\n  var d4_labels = [\n    [[], [0, 0, 0], [2, 4, 3], [1, 3, 4], [2, 1, 4], [1, 2, 3]],\n    [[], [0, 0, 0], [2, 3, 4], [3, 1, 4], [2, 4, 1], [3, 2, 1]],\n    [[], [0, 0, 0], [4, 3, 2], [3, 4, 1], [4, 2, 1], [3, 1, 2]],\n    [[], [0, 0, 0], [4, 2, 3], [1, 4, 3], [4, 1, 2], [1, 3, 2]],\n  ];\n\n  this.create_d4_materials = function(size, margin, labels) {\n    function create_d4_text(text, color, back_color) {\n      var canvas = document.createElement('canvas');\n      var context = canvas.getContext('2d');\n      var ts = calc_texture_size(size + margin) * 2;\n      canvas.width = canvas.height = ts;\n      context.font = (ts - margin) / 1.5 + 'pt Arial';\n      context.fillStyle = back_color;\n      context.fillRect(0, 0, canvas.width, canvas.height);\n      context.textAlign = 'center';\n      context.textBaseline = 'middle';\n      context.fillStyle = color;\n      for (var i in text) {\n        context.fillText(text[i], canvas.width / 2, canvas.height / 2 - ts * 0.3);\n        context.translate(canvas.width / 2, canvas.height / 2);\n        context.rotate((Math.PI * 2) / 3);\n        context.translate(-canvas.width / 2, -canvas.height / 2);\n      }\n      var texture = new THREE.Texture(canvas);\n      texture.needsUpdate = true;\n      return texture;\n    }\n    var materials = [];\n    for (var i = 0; i < labels.length; ++i)\n      materials.push(\n        new THREE.MeshPhongMaterial(\n          $t.copyto(this.material_options, { map: create_d4_text(labels[i], this.label_color, this.dice_color) })\n        )\n      );\n    return materials;\n  };\n\n  this.create_d4_geometry = function(radius) {\n    var vertices = [\n      [1, 1, 1],\n      [-1, -1, 1],\n      [-1, 1, -1],\n      [1, -1, -1],\n    ];\n    var faces = [\n      [1, 0, 2, 1],\n      [0, 1, 3, 2],\n      [0, 3, 2, 3],\n      [1, 2, 3, 4],\n    ];\n    return create_geom(vertices, faces, radius, -0.1, (Math.PI * 7) / 6, 0.96);\n  };\n\n  this.create_d6_geometry = function(radius) {\n    var vertices = [\n      [-1, -1, -1],\n      [1, -1, -1],\n      [1, 1, -1],\n      [-1, 1, -1],\n      [-1, -1, 1],\n      [1, -1, 1],\n      [1, 1, 1],\n      [-1, 1, 1],\n    ];\n    var faces = [\n      [0, 3, 2, 1, 1],\n      [1, 2, 6, 5, 2],\n      [0, 1, 5, 4, 3],\n      [3, 7, 6, 2, 4],\n      [0, 4, 7, 3, 5],\n      [4, 5, 6, 7, 6],\n    ];\n    return create_geom(vertices, faces, radius, 0.1, Math.PI / 4, 0.96);\n  };\n\n  this.create_d8_geometry = function(radius) {\n    var vertices = [\n      [1, 0, 0],\n      [-1, 0, 0],\n      [0, 1, 0],\n      [0, -1, 0],\n      [0, 0, 1],\n      [0, 0, -1],\n    ];\n    var faces = [\n      [0, 2, 4, 1],\n      [0, 4, 3, 2],\n      [0, 3, 5, 3],\n      [0, 5, 2, 4],\n      [1, 3, 4, 5],\n      [1, 4, 2, 6],\n      [1, 2, 5, 7],\n      [1, 5, 3, 8],\n    ];\n    return create_geom(vertices, faces, radius, 0, -Math.PI / 4 / 2, 0.965);\n  };\n\n  this.create_d10_geometry = function(radius) {\n    var a = (Math.PI * 2) / 10,\n      k = Math.cos(a),\n      h = 0.105,\n      v = -1;\n    var vertices = [];\n    for (var i = 0, b = 0; i < 10; ++i, b += a) vertices.push([Math.cos(b), Math.sin(b), h * (i % 2 ? 1 : -1)]);\n    vertices.push([0, 0, -1]);\n    vertices.push([0, 0, 1]);\n    var faces = [\n      [5, 7, 11, 0],\n      [4, 2, 10, 1],\n      [1, 3, 11, 2],\n      [0, 8, 10, 3],\n      [7, 9, 11, 4],\n      [8, 6, 10, 5],\n      [9, 1, 11, 6],\n      [2, 0, 10, 7],\n      [3, 5, 11, 8],\n      [6, 4, 10, 9],\n      [1, 0, 2, v],\n      [1, 2, 3, v],\n      [3, 2, 4, v],\n      [3, 4, 5, v],\n      [5, 4, 6, v],\n      [5, 6, 7, v],\n      [7, 6, 8, v],\n      [7, 8, 9, v],\n      [9, 8, 0, v],\n      [9, 0, 1, v],\n    ];\n    return create_geom(vertices, faces, radius, 0, (Math.PI * 6) / 5, 0.945);\n  };\n\n  this.create_d12_geometry = function(radius) {\n    var p = (1 + Math.sqrt(5)) / 2,\n      q = 1 / p;\n    var vertices = [\n      [0, q, p],\n      [0, q, -p],\n      [0, -q, p],\n      [0, -q, -p],\n      [p, 0, q],\n      [p, 0, -q],\n      [-p, 0, q],\n      [-p, 0, -q],\n      [q, p, 0],\n      [q, -p, 0],\n      [-q, p, 0],\n      [-q, -p, 0],\n      [1, 1, 1],\n      [1, 1, -1],\n      [1, -1, 1],\n      [1, -1, -1],\n      [-1, 1, 1],\n      [-1, 1, -1],\n      [-1, -1, 1],\n      [-1, -1, -1],\n    ];\n    var faces = [\n      [2, 14, 4, 12, 0, 1],\n      [15, 9, 11, 19, 3, 2],\n      [16, 10, 17, 7, 6, 3],\n      [6, 7, 19, 11, 18, 4],\n      [6, 18, 2, 0, 16, 5],\n      [18, 11, 9, 14, 2, 6],\n      [1, 17, 10, 8, 13, 7],\n      [1, 13, 5, 15, 3, 8],\n      [13, 8, 12, 4, 5, 9],\n      [5, 4, 14, 9, 15, 10],\n      [0, 12, 8, 10, 16, 11],\n      [3, 19, 7, 17, 1, 12],\n    ];\n    return create_geom(vertices, faces, radius, 0.2, -Math.PI / 4 / 2, 0.968);\n  };\n\n  this.create_d20_geometry = function(radius) {\n    var t = (1 + Math.sqrt(5)) / 2;\n    var vertices = [\n      [-1, t, 0],\n      [1, t, 0],\n      [-1, -t, 0],\n      [1, -t, 0],\n      [0, -1, t],\n      [0, 1, t],\n      [0, -1, -t],\n      [0, 1, -t],\n      [t, 0, -1],\n      [t, 0, 1],\n      [-t, 0, -1],\n      [-t, 0, 1],\n    ];\n    var faces = [\n      [0, 11, 5, 1],\n      [0, 5, 1, 2],\n      [0, 1, 7, 3],\n      [0, 7, 10, 4],\n      [0, 10, 11, 5],\n      [1, 5, 9, 6],\n      [5, 11, 4, 7],\n      [11, 10, 2, 8],\n      [10, 7, 6, 9],\n      [7, 1, 8, 10],\n      [3, 9, 4, 11],\n      [3, 4, 2, 12],\n      [3, 2, 6, 13],\n      [3, 6, 8, 14],\n      [3, 8, 9, 15],\n      [4, 9, 5, 16],\n      [2, 4, 11, 17],\n      [6, 2, 10, 18],\n      [8, 6, 7, 19],\n      [9, 8, 1, 20],\n    ];\n    return create_geom(vertices, faces, radius, -0.2, -Math.PI / 4 / 2, 0.955);\n  };\n\n  this.material_options = {\n    specular: 0x172022,\n    color: 0xf0f0f0,\n    shininess: 40,\n    flatShading: THREE.FlatShading,\n  };\n  this.label_color = '#aaaaaa';\n  this.dice_color = '#202020';\n  this.ambient_light_color = 0xf0f5fb;\n  this.spot_light_color = 0xefdfd5;\n  this.selector_back_colors = { color: 0x404040, shininess: 0, emissive: 0x858787 };\n  this.desk_color = 0xdfdfdf;\n  this.use_shadows = true;\n\n  this.known_types = ['d4', 'd6', 'd8', 'd10', 'd12', 'd20', 'd100'];\n  this.dice_face_range = { d4: [1, 4], d6: [1, 6], d8: [1, 8], d10: [0, 9], d12: [1, 12], d20: [1, 20], d100: [0, 9] };\n  this.dice_mass = { d4: 300, d6: 300, d8: 340, d10: 350, d12: 350, d20: 400, d100: 350 };\n  this.dice_inertia = { d4: 5, d6: 13, d8: 10, d10: 9, d12: 8, d20: 6, d100: 9 };\n\n  this.scale = 50;\n\n  this.create_d4 = function() {\n    if (!this.d4_geometry) this.d4_geometry = this.create_d4_geometry(this.scale * 1.2);\n    if (!this.d4_material) this.d4_material = [this.create_d4_materials(this.scale / 2, this.scale * 2, d4_labels[0])];\n    return new THREE.Mesh(this.d4_geometry, this.d4_material);\n  };\n\n  this.create_d6 = function() {\n    if (!this.d6_geometry) this.d6_geometry = this.create_d6_geometry(this.scale * 0.9);\n    if (!this.dice_material)\n      this.dice_material = this.create_dice_materials(this.standart_d20_dice_face_labels, this.scale / 2, 1.0);\n\n    return new THREE.Mesh(this.d6_geometry, this.dice_material);\n  };\n\n  this.create_d8 = function() {\n    if (!this.d8_geometry) this.d8_geometry = this.create_d8_geometry(this.scale);\n    if (!this.dice_material)\n      this.dice_material = this.create_dice_materials(this.standart_d20_dice_face_labels, this.scale / 2, 1.2);\n\n    return new THREE.Mesh(this.d8_geometry, this.dice_material);\n  };\n\n  this.create_d10 = function() {\n    if (!this.d10_geometry) this.d10_geometry = this.create_d10_geometry(this.scale * 0.9);\n    if (!this.dice_material)\n      this.dice_material = this.create_dice_materials(this.standart_d20_dice_face_labels, this.scale / 2, 1.0);\n\n    return new THREE.Mesh(this.d10_geometry, this.dice_material);\n  };\n\n  this.create_d12 = function() {\n    if (!this.d12_geometry) this.d12_geometry = this.create_d12_geometry(this.scale * 0.9);\n    if (!this.dice_material)\n      this.dice_material = this.create_dice_materials(this.standart_d20_dice_face_labels, this.scale / 2, 1.0);\n\n    return new THREE.Mesh(this.d12_geometry, this.dice_material);\n  };\n\n  this.create_d20 = function() {\n    if (!this.d20_geometry) this.d20_geometry = this.create_d20_geometry(this.scale);\n    if (!this.dice_material)\n      this.dice_material = this.create_dice_materials(this.standart_d20_dice_face_labels, this.scale / 2, 1.0);\n\n    return new THREE.Mesh(this.d20_geometry, this.dice_material);\n  };\n\n  this.create_d100 = function() {\n    if (!this.d10_geometry) this.d10_geometry = this.create_d10_geometry(this.scale * 0.9);\n    if (!this.d100_material)\n      this.d100_material = this.create_dice_materials(this.standart_d100_dice_face_labels, this.scale / 2, 1.5);\n\n    return new THREE.Mesh(this.d10_geometry, this.d100_material);\n  };\n\n  this.parse_notation = function(notation) {\n    var no = notation.split('@');\n    var dr0 = /\\s*(\\d*)([a-z]+)(\\d+)(\\s*(\\+|\\-)\\s*(\\d+)){0,1}\\s*(\\+|$)/gi;\n    var dr1 = /(\\b)*(\\d+)(\\b)*/gi;\n    var ret = { set: [], constant: 0, result: [], error: false },\n      res;\n    while ((res = dr0.exec(no[0]))) {\n      var command = res[2];\n      if (command != 'd') {\n        ret.error = true;\n        continue;\n      }\n      var count = parseInt(res[1]);\n      if (res[1] == '') count = 1;\n      var type = 'd' + res[3];\n      if (this.known_types.indexOf(type) == -1) {\n        ret.error = true;\n        continue;\n      }\n      while (count--) ret.set.push(type);\n      if (res[5] && res[6]) {\n        if (res[5] == '+') ret.constant += parseInt(res[6]);\n        else ret.constant -= parseInt(res[6]);\n      }\n    }\n    while ((res = dr1.exec(no[1]))) {\n      ret.result.push(parseInt(res[2]));\n    }\n    return ret;\n  };\n\n  this.stringify_notation = function(nn) {\n    var dict = {},\n      notation = '';\n    for (var i in nn.set)\n      if (!dict[nn.set[i]]) dict[nn.set[i]] = 1;\n      else ++dict[nn.set[i]];\n    for (var i in dict) {\n      if (notation.length) notation += ' + ';\n      notation += (dict[i] > 1 ? dict[i] : '') + i;\n    }\n    if (nn.constant) {\n      if (nn.constant > 0) notation += ' + ' + nn.constant;\n      else notation += ' - ' + Math.abs(nn.constant);\n    }\n    return notation;\n  };\n\n  var that = this;\n\n  this.dice_box = function(container, dimentions) {\n    this.use_adapvite_timestep = true;\n    this.animate_selector = true;\n\n    this.dices = [];\n    this.scene = new THREE.Scene();\n    this.world = new CANNON.World();\n\n    this.renderer = window.WebGLRenderingContext\n      ? new THREE.WebGLRenderer({ antialias: true })\n      : new THREE.CanvasRenderer({ antialias: true });\n    container.appendChild(this.renderer.domElement);\n    this.renderer.shadowMap.enabled = true;\n    this.renderer.shadowMap.type = THREE.PCFShadowMap;\n    this.renderer.setClearColor(0xffffff, 1);\n\n    this.reinit(container, dimentions);\n\n    this.world.gravity.set(0, 0, -9.8 * 800);\n    this.world.broadphase = new CANNON.NaiveBroadphase();\n    this.world.solver.iterations = 16;\n\n    var ambientLight = new THREE.AmbientLight(that.ambient_light_color);\n    this.scene.add(ambientLight);\n\n    this.dice_body_material = new CANNON.Material();\n    var desk_body_material = new CANNON.Material();\n    var barrier_body_material = new CANNON.Material();\n    this.world.addContactMaterial(\n      new CANNON.ContactMaterial(desk_body_material, this.dice_body_material, { friction: 0.01, restitution: 0.5 })\n    );\n    this.world.addContactMaterial(\n      new CANNON.ContactMaterial(barrier_body_material, this.dice_body_material, { friction: 0, restitution: 1.0 })\n    );\n    this.world.addContactMaterial(\n      new CANNON.ContactMaterial(this.dice_body_material, this.dice_body_material, { friction: 0, restitution: 0.5 })\n    );\n\n    this.world.add(new CANNON.Body({ mass: 0, shape: new CANNON.Plane(), material: desk_body_material }));\n    var barrier;\n    barrier = new CANNON.Body({ mass: 0, shape: new CANNON.Plane(), material: barrier_body_material });\n    barrier.quaternion.setFromAxisAngle(new CANNON.Vec3(1, 0, 0), Math.PI / 2);\n    barrier.position.set(0, this.h * 0.93, 0);\n    this.world.add(barrier);\n\n    barrier = new CANNON.Body({ mass: 0, shape: new CANNON.Plane(), material: barrier_body_material });\n    barrier.quaternion.setFromAxisAngle(new CANNON.Vec3(1, 0, 0), -Math.PI / 2);\n    barrier.position.set(0, -this.h * 0.93, 0);\n    this.world.add(barrier);\n\n    barrier = new CANNON.Body({ mass: 0, shape: new CANNON.Plane(), material: barrier_body_material });\n    barrier.quaternion.setFromAxisAngle(new CANNON.Vec3(0, 1, 0), -Math.PI / 2);\n    barrier.position.set(this.w * 0.93, 0, 0);\n    this.world.add(barrier);\n\n    barrier = new CANNON.Body({ mass: 0, shape: new CANNON.Plane(), material: barrier_body_material });\n    barrier.quaternion.setFromAxisAngle(new CANNON.Vec3(0, 1, 0), Math.PI / 2);\n    barrier.position.set(-this.w * 0.93, 0, 0);\n    this.world.add(barrier);\n\n    this.last_time = 0;\n    this.running = false;\n\n    this.renderer.render(this.scene, this.camera);\n  };\n\n  this.dice_box.prototype.reinit = function(container, dimentions) {\n    this.cw = container.clientWidth / 2;\n    this.ch = container.clientHeight / 2;\n    if (dimentions) {\n      this.w = dimentions.w;\n      this.h = dimentions.h;\n    } else {\n      this.w = this.cw;\n      this.h = this.ch;\n    }\n\n    this.aspect = Math.min(this.cw / this.w, this.ch / this.h);\n    that.scale = Math.sqrt(this.w * this.w + this.h * this.h) / 13;\n\n    this.renderer.setSize(this.cw * 2, this.ch * 2);\n\n    this.wh = this.ch / this.aspect / Math.tan((10 * Math.PI) / 180);\n    if (this.camera) this.scene.remove(this.camera);\n    this.camera = new THREE.PerspectiveCamera(20, this.cw / this.ch, 1, this.wh * 1.3);\n    this.camera.position.z = this.wh;\n\n    var mw = Math.max(this.w, this.h);\n    if (this.light) this.scene.remove(this.light);\n    this.light = new THREE.SpotLight(that.spot_light_color, 2.0);\n    this.light.position.set(-mw / 2, mw / 2, mw * 2);\n    this.light.target.position.set(0, 0, 0);\n    this.light.distance = mw * 5;\n    this.light.castShadow = true;\n    this.light.shadow.camera.near = mw / 10;\n    this.light.shadow.camera.far = mw * 5;\n    this.light.shadow.camera.fov = 50;\n    this.light.shadow.bias = 0.001;\n    this.light.shadow.mapSize.width = 1024;\n    this.light.shadow.mapSize.height = 1024;\n    this.scene.add(this.light);\n\n    if (this.desk) this.scene.remove(this.desk);\n    this.desk = new THREE.Mesh(\n      new THREE.PlaneGeometry(this.w * 2, this.h * 2, 1, 1),\n      new THREE.MeshPhongMaterial({ color: that.desk_color })\n    );\n    this.desk.receiveShadow = that.use_shadows;\n    this.scene.add(this.desk);\n\n    this.renderer.render(this.scene, this.camera);\n  };\n\n  function make_random_vector(vector) {\n    var random_angle = (rnd() * Math.PI) / 5 - Math.PI / 5 / 2;\n    var vec = {\n      x: vector.x * Math.cos(random_angle) - vector.y * Math.sin(random_angle),\n      y: vector.x * Math.sin(random_angle) + vector.y * Math.cos(random_angle),\n    };\n    if (vec.x == 0) vec.x = 0.01;\n    if (vec.y == 0) vec.y = 0.01;\n    return vec;\n  }\n\n  this.dice_box.prototype.generate_vectors = function(notation, vector, boost) {\n    var vectors = [];\n    for (var i in notation.set) {\n      var vec = make_random_vector(vector);\n      var pos = {\n        x: this.w * (vec.x > 0 ? -1 : 1) * 0.9,\n        y: this.h * (vec.y > 0 ? -1 : 1) * 0.9,\n        z: rnd() * 200 + 200,\n      };\n      var projector = Math.abs(vec.x / vec.y);\n      if (projector > 1.0) pos.y /= projector;\n      else pos.x *= projector;\n      var velvec = make_random_vector(vector);\n      var velocity = { x: velvec.x * boost, y: velvec.y * boost, z: -10 };\n      var inertia = that.dice_inertia[notation.set[i]];\n      var angle = {\n        x: -(rnd() * vec.y * 5 + inertia * vec.y),\n        y: rnd() * vec.x * 5 + inertia * vec.x,\n        z: 0,\n      };\n      var axis = { x: rnd(), y: rnd(), z: rnd(), a: rnd() };\n      vectors.push({ set: notation.set[i], pos: pos, velocity: velocity, angle: angle, axis: axis });\n    }\n    return vectors;\n  };\n\n  this.dice_box.prototype.create_dice = function(type, pos, velocity, angle, axis) {\n    var dice = that['create_' + type]();\n    dice.castShadow = true;\n    dice.dice_type = type;\n    dice.body = new CANNON.Body({\n      mass: that.dice_mass[type],\n      shape: dice.geometry.cannon_shape,\n      material: this.dice_body_material,\n    });\n    dice.body.position.set(pos.x, pos.y, pos.z);\n    dice.body.quaternion.setFromAxisAngle(new CANNON.Vec3(axis.x, axis.y, axis.z), axis.a * Math.PI * 2);\n    dice.body.angularVelocity.set(angle.x, angle.y, angle.z);\n    dice.body.velocity.set(velocity.x, velocity.y, velocity.z);\n    dice.body.linearDamping = 0.1;\n    dice.body.angularDamping = 0.1;\n    this.scene.add(dice);\n    this.dices.push(dice);\n    this.world.add(dice.body);\n  };\n\n  this.dice_box.prototype.check_if_throw_finished = function() {\n    var res = true;\n    var e = 6;\n    if (this.iteration < 10 / that.frame_rate) {\n      for (var i = 0; i < this.dices.length; ++i) {\n        var dice = this.dices[i];\n        if (dice.dice_stopped === true) continue;\n        var a = dice.body.angularVelocity,\n          v = dice.body.velocity;\n        if (\n          Math.abs(a.x) < e &&\n          Math.abs(a.y) < e &&\n          Math.abs(a.z) < e &&\n          Math.abs(v.x) < e &&\n          Math.abs(v.y) < e &&\n          Math.abs(v.z) < e\n        ) {\n          if (dice.dice_stopped) {\n            if (this.iteration - dice.dice_stopped > 3) {\n              dice.dice_stopped = true;\n              continue;\n            }\n          } else dice.dice_stopped = this.iteration;\n          res = false;\n        } else {\n          dice.dice_stopped = undefined;\n          res = false;\n        }\n      }\n    }\n    return res;\n  };\n\n  function get_dice_value(dice) {\n    var vector = new THREE.Vector3(0, 0, dice.dice_type == 'd4' ? -1 : 1);\n    var closest_face,\n      closest_angle = Math.PI * 2;\n    for (var i = 0, l = dice.geometry.faces.length; i < l; ++i) {\n      var face = dice.geometry.faces[i];\n      if (face.materialIndex == 0) continue;\n      var angle = face.normal\n        .clone()\n        .applyQuaternion(dice.body.quaternion)\n        .angleTo(vector);\n      if (angle < closest_angle) {\n        closest_angle = angle;\n        closest_face = face;\n      }\n    }\n    var matindex = closest_face.materialIndex - 1;\n    if (dice.dice_type == 'd100') matindex *= 10;\n    if (dice.dice_type == 'd10' && matindex == 0) matindex = 10;\n    return matindex;\n  }\n\n  function get_dice_values(dices) {\n    var values = [];\n    for (var i = 0, l = dices.length; i < l; ++i) {\n      values.push(get_dice_value(dices[i]));\n    }\n    return values;\n  }\n\n  this.dice_box.prototype.emulate_throw = function() {\n    while (!this.check_if_throw_finished()) {\n      ++this.iteration;\n      this.world.step(that.frame_rate);\n    }\n    return get_dice_values(this.dices);\n  };\n\n  this.dice_box.prototype.__animate = function(threadid) {\n    var time = new Date().getTime();\n    var time_diff = (time - this.last_time) / 1000;\n    if (time_diff > 3) time_diff = that.frame_rate;\n    ++this.iteration;\n    if (this.use_adapvite_timestep) {\n      while (time_diff > that.frame_rate * 1.1) {\n        this.world.step(that.frame_rate);\n        time_diff -= that.frame_rate;\n      }\n      this.world.step(time_diff);\n    } else {\n      this.world.step(that.frame_rate);\n    }\n    for (var i in this.scene.children) {\n      var interact = this.scene.children[i];\n      if (interact.body != undefined) {\n        interact.position.copy(interact.body.position);\n        interact.quaternion.copy(interact.body.quaternion);\n      }\n    }\n    this.renderer.render(this.scene, this.camera);\n    this.last_time = this.last_time ? time : new Date().getTime();\n    if (this.running == threadid && this.check_if_throw_finished()) {\n      this.running = false;\n      if (this.callback) this.callback.call(this, get_dice_values(this.dices));\n    }\n    if (this.running == threadid) {\n      (function(t, tid, uat) {\n        if (!uat && time_diff < that.frame_rate) {\n          setTimeout(function() {\n            requestAnimationFrame(function() {\n              t.__animate(tid);\n            });\n          }, (that.frame_rate - time_diff) * 1000);\n        } else\n          requestAnimationFrame(function() {\n            t.__animate(tid);\n          });\n      })(this, threadid, this.use_adapvite_timestep);\n    }\n  };\n\n  this.dice_box.prototype.clear = function() {\n    this.running = false;\n    var dice;\n    while ((dice = this.dices.pop())) {\n      this.scene.remove(dice);\n      if (dice.body) this.world.remove(dice.body);\n    }\n    if (this.pane) this.scene.remove(this.pane);\n    this.renderer.render(this.scene, this.camera);\n    var box = this;\n    setTimeout(function() {\n      box.renderer.render(box.scene, box.camera);\n    }, 100);\n  };\n\n  this.dice_box.prototype.prepare_dices_for_roll = function(vectors) {\n    this.clear();\n    this.iteration = 0;\n    for (var i in vectors) {\n      this.create_dice(vectors[i].set, vectors[i].pos, vectors[i].velocity, vectors[i].angle, vectors[i].axis);\n    }\n  };\n\n  function shift_dice_faces(dice, value, res) {\n    var r = that.dice_face_range[dice.dice_type];\n\n    if (dice.dice_type == 'd100') value = value / 10;\n    if (dice.dice_type == 'd100') res = res / 10;\n    if ((dice.dice_type == 'd10' || dice.dice_type == 'd100') && value == 10) value = 0;\n    if (dice.dice_type == 'd10' && res == 10) res = 0;\n    if (!(value >= r[0] && value <= r[1])) return;\n    var num = value - res;\n\n    var geom = dice.geometry.clone();\n    for (var i = 0, l = geom.faces.length; i < l; ++i) {\n      var matindex = geom.faces[i].materialIndex;\n      if (matindex == 0) continue;\n      matindex += num - 1;\n      while (matindex > r[1]) matindex -= r[1];\n      while (matindex < r[0]) matindex += r[1];\n      geom.faces[i].materialIndex = matindex + 1;\n    }\n    if (dice.dice_type == 'd4' && num != 0) {\n      if (num < 0) num += 4;\n      dice.material = that.create_d4_materials(that.scale / 2, that.scale * 2, d4_labels[num]);\n    }\n    dice.geometry = geom;\n  }\n\n  this.dice_box.prototype.roll = function(vectors, values, callback) {\n    this.prepare_dices_for_roll(vectors);\n    if (values != undefined && values.length) {\n      this.use_adapvite_timestep = false;\n      var res = this.emulate_throw();\n      this.prepare_dices_for_roll(vectors);\n      for (var i in res) shift_dice_faces(this.dices[i], values[i], res[i]);\n    }\n    this.callback = callback;\n    this.running = new Date().getTime();\n    this.last_time = 0;\n    this.__animate(this.running);\n  };\n\n  this.dice_box.prototype.__selector_animate = function(threadid) {\n    var time = new Date().getTime();\n    var time_diff = (time - this.last_time) / 1000;\n    if (time_diff > 3) time_diff = that.frame_rate;\n    var angle_change = (0.3 * time_diff * Math.PI * Math.min(24000 + threadid - time, 6000)) / 6000;\n    if (angle_change < 0) this.running = false;\n    for (var i in this.dices) {\n      this.dices[i].rotation.y += angle_change;\n      this.dices[i].rotation.x += angle_change / 4;\n      this.dices[i].rotation.z += angle_change / 10;\n    }\n    this.last_time = time;\n    this.renderer.render(this.scene, this.camera);\n    if (this.running == threadid) {\n      (function(t, tid) {\n        requestAnimationFrame(function() {\n          t.__selector_animate(tid);\n        });\n      })(this, threadid);\n    }\n  };\n\n  this.dice_box.prototype.search_dice_by_mouse = function(ev) {\n    var m = $t.get_mouse_coords(ev);\n    var intersects = new THREE.Raycaster(\n      this.camera.position,\n      new THREE.Vector3((m.x - this.cw) / this.aspect, 1 - (m.y - this.ch) / this.aspect, this.w / 9)\n        .sub(this.camera.position)\n        .normalize()\n    ).intersectObjects(this.dices);\n    if (intersects.length) return intersects[0].object.userData;\n  };\n\n  this.dice_box.prototype.draw_selector = function() {\n    this.clear();\n    var step = this.w / 4.5;\n    this.pane = new THREE.Mesh(\n      new THREE.PlaneGeometry(this.w * 6, this.h * 6, 1, 1),\n      new THREE.MeshPhongMaterial(that.selector_back_colors)\n    );\n    this.pane.receiveShadow = true;\n    this.pane.position.set(0, 0, 1);\n    this.scene.add(this.pane);\n\n    var mouse_captured = false;\n\n    for (var i = 0, pos = -3; i < that.known_types.length; ++i, ++pos) {\n      var dice = $t.dice['create_' + that.known_types[i]]();\n      dice.position.set(pos * step, 0, step * 0.5);\n      dice.castShadow = true;\n      dice.userData = that.known_types[i];\n      this.dices.push(dice);\n      this.scene.add(dice);\n    }\n\n    this.running = new Date().getTime();\n    this.last_time = 0;\n    if (this.animate_selector) this.__selector_animate(this.running);\n    else this.renderer.render(this.scene, this.camera);\n  };\n\n  function throw_dices(box, vector, boost, dist, notation_getter, before_roll, after_roll) {\n    var uat = $t.dice.use_adapvite_timestep;\n    function roll(request_results) {\n      if (after_roll) {\n        box.clear();\n        box.roll(vectors, request_results || notation.result, function(result) {\n          if (after_roll) after_roll.call(box, notation, result);\n          box.rolling = false;\n          $t.dice.use_adapvite_timestep = uat;\n        });\n      }\n    }\n    vector.x /= dist;\n    vector.y /= dist;\n    var notation = notation_getter.call(box);\n    if (notation.set.length == 0) return;\n    var vectors = box.generate_vectors(notation, vector, boost);\n    box.rolling = true;\n    if (before_roll) before_roll.call(box, vectors, notation, roll);\n    else roll();\n  }\n\n  this.dice_box.prototype.bind_mouse_listener = function(container, callback) {\n    var box = this;\n    $t.bind(container, ['mousedown', 'touchstart'], function(ev) {\n      box.mouse_time = new Date().getTime();\n      box.mouse_start = $t.get_mouse_coords(ev);\n    });\n    $t.bind(container, ['mouseup', 'touchend'], function(ev) {\n      if (box.rolling) return;\n      if (box.mouse_start == undefined) return;\n      var m = $t.get_mouse_coords(ev);\n      var vector = { x: m.x - box.mouse_start.x, y: -(m.y - box.mouse_start.y) };\n      box.mouse_start = undefined;\n      var dist = Math.sqrt(vector.x * vector.x + vector.y * vector.y);\n      if (dist < Math.sqrt(box.w * box.h * 0.01)) return;\n      var time_int = new Date().getTime() - box.mouse_time;\n      if (time_int > 2000) time_int = 2000;\n      var boost = Math.sqrt((2500 - time_int) / 2500) * dist * 2;\n\n      callback(vector, boost, dist);\n    });\n  };\n\n  this.dice_box.prototype.start_throw = function(\n    notation_getter,\n    before_roll,\n    after_roll,\n    vectorParam,\n    boostParam,\n    distParam\n  ) {\n    var box = this;\n    if (box.rolling) return;\n\n    prepare_rnd(function() {\n      var vector = Object.assign({}, vectorParam) || { x: (rnd() * 2 - 1) * box.w, y: -(rnd() * 2 - 1) * box.h };\n      var dist = distParam || Math.sqrt(vector.x * vector.x + vector.y * vector.y);\n      var boost = boostParam || (rnd() + 3) * dist;\n      throw_dices(box, vector, boost, dist, notation_getter, before_roll, after_roll);\n    });\n  };\n}.apply((teal.dice = teal.dice || {})));\n\nexport const $teal = $t;\n","import { ResizeSensor } from 'css-element-queries';\nimport { $teal as $t } from './dice-three';\n\nexport function dice_initialize(container, config): ResizeSensor {\n  const defaultConfig = {\n    idCanvas: 'canvas',\n    idLabel: 'label',\n    idSet: 'set',\n    idSelectorDiv: 'selector_div',\n    idControlPanel: 'control_panel',\n    idInfoDiv: 'info_div',\n    useTrueRandom: false,\n    chromakey: false,\n    useShadows: true,\n    whiteDice: false,\n    noresult: false,\n    roll: false,\n    diceThrow$: null,\n    diceBeforeThrow$: null,\n    diceAfterThrow$: null,\n    requestNewThrow$: null,\n  };\n\n  const _config = Object.assign({}, defaultConfig, config);\n  let containerBox = container.getBoundingClientRect();\n\n  const canvas = $t.id(_config.idCanvas);\n  canvas.style.width = containerBox.width - 1 + 'px';\n  canvas.style.height = containerBox.height - 1 + 'px';\n\n  $t.dice.use_true_random = _config.useTrueRandom;\n  if (_config.chromakey) {\n    $t.dice.desk_color = 0x00ff00;\n  }\n  $t.dice.use_shadows = _config.useShadows;\n  if (_config.whiteDice) {\n    $t.dice.dice_color = '#808080';\n    $t.dice.label_color = '#202020';\n  }\n\n  const box = new $t.dice.dice_box(canvas, { w: containerBox.width, h: containerBox.height });\n  box.animate_selector = false;\n\n  function show_selector() {\n    box.draw_selector();\n  }\n\n  show_selector();\n\n  box.bind_mouse_listener(container, function(vector, boost, dist) {\n    _config.requestNewThrow$.next({ vectors: vector, boost, dist });\n  });\n\n  _config.diceThrow$.subscribe(function(throwConfig) {\n    function notation_getter() {\n      return $t.dice.parse_notation(prepareDiceSetToString(throwConfig.diceSet));\n    }\n\n    function before_roll(vectors, notation, callback) {\n      _config.diceBeforeThrow$.next({ throwConfig });\n      callback(prepareThrowResultToString(throwConfig.result));\n    }\n\n    function after_roll(notation, result) {\n      _config.diceAfterThrow$.next({ throwConfig, result });\n    }\n\n    box.start_throw(\n      notation_getter,\n      before_roll,\n      after_roll,\n      throwConfig.diceThrowConfig.vectors,\n      throwConfig.diceThrowConfig.boost,\n      throwConfig.diceThrowConfig.dist\n    );\n  });\n\n  return new ResizeSensor(container, () => {\n    containerBox = container.getBoundingClientRect();\n    canvas.style.width = containerBox.width.toFixed() - 1 + 'px';\n    canvas.style.height = containerBox.height.toFixed() - 1 + 'px';\n    box.reinit(canvas, { w: containerBox.width.toFixed(), h: containerBox.height.toFixed() });\n  });\n}\n\nfunction prepareDiceSetToString(diceSet) {\n  diceSet = objectSortByKeys(diceSet);\n  let requestDiceSet = '';\n\n  Object.keys(diceSet)\n    .sort(compareDiceKey)\n    .forEach(function(diceKey) {\n      const amount = diceSet[diceKey];\n      if (!amount) return;\n      requestDiceSet = requestDiceSet + amount + diceKey + '+';\n    });\n  requestDiceSet = requestDiceSet.slice(0, -1);\n\n  return requestDiceSet;\n}\n\nfunction prepareThrowResultToString(result) {\n  result = objectSortByKeys(result);\n  let requestResult = [];\n\n  Object.keys(result)\n    .sort(compareDiceKey)\n    .forEach(function(diceKey) {\n      requestResult = [...requestResult, ...result[diceKey]];\n    });\n\n  return requestResult;\n}\n\nfunction objectSortByKeys(obj) {\n  const ordered = {};\n\n  Object.keys(obj)\n    .sort(compareDiceKey)\n    .forEach(function(key) {\n      ordered[key] = obj[key];\n    });\n\n  return ordered;\n}\n\nfunction compareDiceKey(a, b) {\n  return parseInt(a.slice(1)) - parseInt(b.slice(1));\n}\n","import clsx from 'clsx';\nimport React, { Dispatch, MutableRefObject, SetStateAction, useContext, useEffect, useRef, useState } from 'react';\nimport { createStyles, Theme, withStyles, WithStyles } from '@material-ui/core/styles';\nimport { Grow, Paper } from '@material-ui/core';\nimport { interval, Subject } from 'rxjs';\nimport { delay, filter, map, takeUntil } from 'rxjs/operators';\n\nimport { diceDefaultConfig } from '../../config/dice.config';\nimport { DiceServiceContext } from '../../contexts/DiceService.context';\nimport { dice_initialize } from '../DiceVisualization/dice-main';\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    root: {\n      width: '100%',\n      height: `calc(100% - ${theme.spacing(2)}px)`,\n      position: 'relative' as 'relative',\n    },\n    diceCanvas: {\n      width: '100%',\n      height: '100%',\n      cursor: 'grab',\n    },\n    grabbing: {\n      cursor: 'grabbing',\n    },\n  });\n\ninterface DiceCardProps extends WithStyles<typeof styles> {\n  visible?: boolean;\n}\n\nfunction setStateWhenCanvasHasDimensions(ref: MutableRefObject<any>, setState: Dispatch<SetStateAction<any>>) {\n  const takeUntil$ = new Subject();\n  interval(300)\n    .pipe(\n      map(() => (ref?.current as HTMLElement)?.getBoundingClientRect()),\n      filter(elementRect => !(elementRect?.width && elementRect?.height)),\n      delay(300),\n      takeUntil(takeUntil$)\n    )\n    .subscribe(() => {\n      takeUntil$.next();\n      setState(true);\n    });\n}\n\nfunction DiceCardC(props: DiceCardProps) {\n  const { classes, visible = true } = props;\n\n  const canvasRef = React.useRef(null);\n  const diceContainerEl = useRef(null);\n\n  const [diceInitialized, setDiceInitialized] = useState(false);\n  const [mouseDown, setMouseDown] = useState(false);\n  const [canvasHasDimensions, setCanvasHasDimensions] = useState(false);\n  const diceService = useContext(DiceServiceContext);\n\n  useEffect(() => setStateWhenCanvasHasDimensions(canvasRef, setCanvasHasDimensions), []);\n\n  useEffect(() => {\n    if (!!diceService && !diceInitialized && canvasHasDimensions) {\n      const resizeSensor = dice_initialize(diceContainerEl.current, {\n        ...diceDefaultConfig,\n        diceThrow$: diceService.diceThrow$,\n        diceBeforeThrow$: diceService.diceBeforeThrow$,\n        diceAfterThrow$: diceService.diceAfterThrow$,\n        requestNewThrow$: diceService.requestNewThrow$,\n      });\n      setDiceInitialized(true);\n\n      return () => resizeSensor.detach();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [canvasHasDimensions, !!diceService]);\n\n  const onMouseDown = (isDown: boolean): void => {\n    setMouseDown(isDown);\n  };\n\n  return (\n    <Grow in={visible}>\n      <Paper elevation={3} className={classes.root}>\n        <div\n          id=\"diceCanvasContainer\"\n          ref={diceContainerEl}\n          className={clsx(classes.diceCanvas, mouseDown && classes.grabbing)}\n          onMouseDown={() => onMouseDown(true)}\n          onMouseUp={() => onMouseDown(false)}\n        >\n          <div ref={canvasRef} id=\"canvas\" />\n        </div>\n      </Paper>\n    </Grow>\n  );\n}\n\nexport const DiceCard = withStyles(styles)(DiceCardC);\n","import React from 'react';\nimport { InjectedFormProps, reduxForm } from 'redux-form';\nimport { makeStyles, Theme } from '@material-ui/core/styles';\n\nimport { diceDashboardFormModel } from '../../../models/rooms.model';\nimport { Dice } from '../../../models/dice.model';\nimport { FormFieldSlider } from '../../../components/FormComponents';\n\nconst styles = (theme: Theme) => ({\n  inputSlider: {\n    width: '100%',\n    marginLeft: theme.spacing(0),\n    paddingRight: theme.spacing(2),\n    minWidth: theme.spacing(40),\n  },\n});\n\ninterface DiceDashboardFormProps extends InjectedFormProps {\n  diceType: Dice[];\n}\n\nconst useStyles = makeStyles(styles);\n\nfunction DiceDashboardFormC(props: DiceDashboardFormProps) {\n  const { diceType } = props;\n  const classes = useStyles();\n  return (\n    <form onSubmit={(e: any) => e.preventDefault()}>\n      <h2>Set your dices!</h2>\n\n      <div className={classes.inputSlider}>\n        {diceType?.map(dice => (\n          <FormFieldSlider key={dice} {...(diceDashboardFormModel[dice] as any)} />\n        ))}\n      </div>\n    </form>\n  );\n}\nexport const DiceDashboardForm = React.memo(\n  reduxForm({\n    form: 'diceSetForm',\n    initialValues: {\n      [Dice.D4]: 0,\n      [Dice.D6]: 0,\n      [Dice.D8]: 0,\n      [Dice.D10]: 0,\n      [Dice.D12]: 0,\n      [Dice.D20]: 0,\n      [Dice.D100]: 0,\n    },\n  })(DiceDashboardFormC as any) as any\n);\n","import React from 'react';\nimport { Grid, List, ListItem, Typography } from '@material-ui/core';\n\nimport { IDiceThrow } from '../../../models/dice.model';\n\ninterface DiceDashboardResultProps {\n  throwResult: IDiceThrow;\n}\n\nexport function DiceDashboardResult(props: DiceDashboardResultProps) {\n  const { throwResult } = props;\n\n  const renderResultItem = () => {\n    if (!throwResult?.result) {\n      return '';\n    }\n\n    return Object.keys(throwResult.result).map(diceName => (\n      <ListItem key={diceName}>\n        <Grid container spacing={2}>\n          <Grid item>\n            <Typography variant=\"h4\" component=\"span\" color={'textSecondary'}>\n              {diceName}:\n            </Typography>\n          </Grid>\n          <Grid item>\n            <Typography variant=\"h3\" component=\"span\">\n              {throwResult.result[diceName].join(', ')}\n            </Typography>\n          </Grid>\n        </Grid>\n      </ListItem>\n    ));\n  };\n\n  return (\n    <article>\n      <Typography variant=\"h5\" component=\"h2\">\n        Throw result:\n      </Typography>\n      <List>{renderResultItem()}</List>\n    </article>\n  );\n}\n","import clsx from 'clsx';\nimport React, { useContext, useEffect, useState } from 'react';\nimport { Card, CardContent, CardMedia, Collapse, Grow } from '@material-ui/core';\nimport { createStyles, Theme, withStyles, WithStyles } from '@material-ui/core/styles';\nimport { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\nimport { DiceDashboardForm } from './components/DiceDashboardForm';\nimport { DiceDashboardResult } from './components/DiceDashboardResult';\nimport { DiceServiceContext } from '../../contexts/DiceService.context';\nimport { IDiceThrow } from '../../models/dice.model';\nimport { IRoom } from '../../models/rooms.model';\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    root: {\n      display: 'flex',\n      backgroundColor: '#f4f4f2ef',\n    },\n    details: {\n      display: 'flex',\n      flexDirection: 'column',\n    },\n    content: {\n      flex: '1 0 auto',\n    },\n    cover: {\n      width: theme.spacing(18),\n    },\n    playIcon: {\n      height: 38,\n      width: 38,\n    },\n    clickable: {\n      cursor: 'pointer',\n    },\n  });\n\nexport interface DiceDashboardProps extends WithStyles<typeof styles> {\n  visible?: boolean;\n  room?: IRoom;\n}\n\nfunction DiceDashboardC(props: DiceDashboardProps) {\n  const { classes, visible = true, room } = props;\n\n  const destroyed$ = new Subject();\n\n  const diceService = useContext(DiceServiceContext);\n  const [throwResult, setThrowResult] = useState<IDiceThrow>(null);\n\n  useEffect(() => {\n    diceService?.diceThrowDelayedWhen$.pipe(takeUntil(destroyed$)).subscribe(result => setThrowResult(result));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [!!diceService]);\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useEffect(() => () => destroyed$.next(), []);\n\n  return (\n    <Grow in={visible}>\n      <Card className={clsx(classes.root, !!throwResult && classes.clickable)} onClick={() => setThrowResult(null)}>\n        <div className={classes.details}>\n          <CardContent className={classes.content}>\n            <Collapse in={!throwResult}>\n              <DiceDashboardForm diceType={room?.diceType} />\n            </Collapse>\n\n            <Collapse in={!!throwResult}>\n              <DiceDashboardResult throwResult={throwResult} />\n            </Collapse>\n          </CardContent>\n        </div>\n        {room?.gameMasterAvatar && (\n          <CardMedia className={classes.cover} image={room?.gameMasterAvatar} title=\"Bot avatar\" />\n        )}\n      </Card>\n    </Grow>\n  );\n}\n\nexport const DiceDashboard = withStyles(styles)(DiceDashboardC);\n","import { AppState } from '../main';\nimport { IApplicationStats } from '../../models/firebase.model';\n\nexport const firebaseSelectors = {\n  isRequesting: (state: AppState): boolean => !Object.values(state.firestore.status.requesting).every(v => !v),\n\n  userProfile: (state: AppState) => state.firebase.auth,\n\n  authenticatingSelector: (state: AppState) => {\n    const {\n      firebase: { auth, isInitializing },\n    } = state;\n    return !auth.isLoaded || isInitializing;\n  },\n\n  isAuthenticated: (state: AppState) => {\n    const {\n      firebase: { auth },\n    } = state;\n    return !auth.isEmpty && !!auth.uid;\n  },\n\n  userConnected: (state: AppState): boolean => state.firebase.data.connected,\n\n  applicationStats: (state: AppState): IApplicationStats => state.firebase.data.applicationStats,\n};\n","/* eslint-disable eqeqeq,no-self-compare */\n/* tslint:disable:triple-equals */\n\nconst isArray = Array.isArray;\nconst keyList = Object.keys;\nconst hasProp = Object.prototype.hasOwnProperty;\n\n/**\n * Function makes deep compare of two objects\n *\n * == used in purpose to do the type coercion\n * using === main gain a bit in performance\n *\n * @param a - object a to compare\n * @param b - object a to compare\n * @return boolean\n */\nexport const equal: (a: any, b: any) => boolean = (a: any, b: any) => {\n  if (a === b) {\n    return true;\n  }\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    const arrA = isArray(a);\n    const arrB = isArray(b);\n    let length;\n    let key;\n\n    if (arrA && arrB) {\n      length = a.length;\n      if (length != b.length) {\n        return false;\n      }\n      for (let i = length; i-- !== 0; ) {\n        if (!equal(a[i], b[i])) {\n          return false;\n        }\n      }\n      return true;\n    }\n\n    if (arrA != arrB) {\n      return false;\n    }\n\n    const dateA = a instanceof Date;\n    const dateB = b instanceof Date;\n    if (dateA != dateB) {\n      return false;\n    }\n    if (dateA && dateB) {\n      return a.getTime() == b.getTime();\n    }\n\n    const regexpA = a instanceof RegExp,\n      regexpB = b instanceof RegExp;\n    if (regexpA != regexpB) {\n      return false;\n    }\n    if (regexpA && regexpB) {\n      return a.toString() == b.toString();\n    }\n\n    const keys = keyList(a);\n    length = keys.length;\n\n    if (length !== keyList(b).length) {\n      return false;\n    }\n\n    for (let i = length; i-- !== 0; ) {\n      if (!hasProp.call(b, keys[i])) {\n        return false;\n      }\n    }\n\n    for (let i = length; i-- !== 0; ) {\n      key = keys[i];\n      if (!equal(a[key], b[key])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  return a !== a && b !== b;\n};\n","export enum RoomsAction {\n  SELECTED = '@@rooms/SELECTED',\n  SET_DRAWER_OPEN_VALUE = '@@rooms/SET_DRAWER_OPEN_VALUE',\n  SET_CHAT_OPEN_VALUE = '@@rooms/SET_CHAT_OPEN_VALUE',\n  SET_PLAYERS_OPEN_VALUE = '@@rooms/SET_PLAYERS_OPEN_VALUE',\n  SET_DICE_ROLLING = '@@rooms/SET_DICE_ROLLING',\n}\n\nexport interface RoomsState {\n  readonly selectedRoom: string | null;\n  readonly drawerOpened: boolean;\n  readonly chatOpened: boolean;\n  readonly playersOpened: boolean;\n  readonly diceRolling: boolean;\n}\n","import { ReduxFirestoreQuerySetting } from 'react-redux-firebase';\nimport { FirestoreCollection } from '../models/firebase.model';\n\nexport const chatsQuery = {\n  getUserChats: (uid: string): ReduxFirestoreQuerySetting => {\n    const uidNonEmptyArray = uid && uid?.length !== 0 ? uid : 'unknown';\n\n    return {\n      collection: FirestoreCollection.CHATS,\n      where: [['players', 'array-contains', uidNonEmptyArray]],\n      storeAs: 'userChats',\n    };\n  },\n};\n","import { ReduxFirestoreQuerySetting } from 'react-redux-firebase';\n\nexport const profileQuery = {\n  getProfilesByUid: (uids: string[] = []): ReduxFirestoreQuerySetting => ({\n    collection: 'users',\n    where: [['uid', 'in', uids]],\n    storeAs: 'usersProfiles',\n  }),\n  connected: { path: '.info/connected', storeAs: 'connected' },\n};\n","import { ReduxFirestoreQuerySetting } from 'react-redux-firebase';\nimport { FirestoreCollection } from '../models/firebase.model';\n\nexport const roomsQuery = {\n  getUserRoomsAsGameMaster: (uid: string): ReduxFirestoreQuerySetting => ({\n    collection: FirestoreCollection.ROOMS,\n    where: [['gameMasterUid', '==', uid]],\n    storeAs: 'userRoomsAsGameMaster',\n  }),\n\n  getUserRoomsAsPlayer: (uid: string): ReduxFirestoreQuerySetting => ({\n    collection: FirestoreCollection.ROOMS,\n    where: [['playersUid', 'array-contains', uid]],\n    storeAs: 'userRoomsAsPlayer',\n  }),\n\n  getRoom: (DocUid: string): ReduxFirestoreQuerySetting => {\n    const doc = DocUid.length ? DocUid : 'unknown';\n    return {\n      collection: FirestoreCollection.ROOMS,\n      doc,\n      storeAs: 'selectedRoom',\n    };\n  },\n};\n","import React, { useEffect } from 'react';\nimport { useSelector } from 'react-redux';\nimport { useFirebase, useFirebaseConnect, useFirestore, useFirestoreConnect } from 'react-redux-firebase';\n\nimport { chatsQuery } from '../queries/chat.query';\nimport { firebaseSelectors } from '../store/firebase/firebase.selectors';\nimport { profileQuery } from '../queries/profile.query';\nimport { roomsQuery } from '../queries/rooms.query';\nimport { roomsSelectors } from '../store/rooms/rooms.selectors';\nimport { mainSelectors } from '../store/main.selectors';\nimport { FirestoreCollection } from '../models/firebase.model';\n\nexport function WhenAuthenticated() {\n  const firestore = useFirestore();\n  const firebase = useFirebase();\n\n  const profile = useSelector(firebaseSelectors.userProfile);\n  const selectedRoomUid = useSelector(roomsSelectors.selectedRoomUid);\n  const uniqProfilesUid: string[] = [...useSelector(mainSelectors.getAllNeededPlayersUid)];\n  const userConnected = useSelector(firebaseSelectors.userConnected);\n\n  function updateUserStatus(connected: boolean): void {\n    const docUserRef = firestore.doc(`${FirestoreCollection.USERS}/${profile.uid}`);\n    docUserRef.update({ connected });\n  }\n\n  function updateUserStatusOnDisconnect(): void {\n    const docUserRef = firebase.ref(`${FirestoreCollection.USERS}/${profile.uid}`);\n    docUserRef.onDisconnect().update({ connected: false });\n  }\n\n  useEffect(() => {\n    if (userConnected !== true || !profile.uid) {\n      return;\n    }\n    updateUserStatus(userConnected);\n    updateUserStatusOnDisconnect();\n    return () => {\n      updateUserStatus(false);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [userConnected, profile.uid]);\n\n  useFirebaseConnect([profileQuery.connected]);\n\n  useFirestoreConnect([\n    /**\n     * Get all profiles data listed in array (for chat and room)\n     */\n    profileQuery.getProfilesByUid(uniqProfilesUid.length ? uniqProfilesUid : ['unknown']),\n    /**\n     * Get all profiles listed in chat messages\n     */\n    chatsQuery.getUserChats(profile.uid),\n    /**\n     * Get all rooms where user is MG\n     */\n    roomsQuery.getUserRoomsAsGameMaster(profile.uid || 'unknown'),\n    /**\n     * Get all rooms where user is Player\n     */\n    roomsQuery.getUserRoomsAsPlayer(profile.uid || 'unknown'),\n    /**\n     * Get selectedRoom by player\n     */\n    roomsQuery.getRoom(selectedRoomUid || 'unknown'),\n  ]);\n  return <React.Fragment />;\n}\n","import React from 'react';\nimport { useSelector } from 'react-redux';\n\nimport { WhenAuthenticated } from './WhenAuthenticated';\nimport { firebaseSelectors } from '../store/firebase/firebase.selectors';\n\ninterface CoreProps {\n  children: React.ReactElement;\n}\n\nexport function Core(props: CoreProps) {\n  const isAuthenticated = useSelector(firebaseSelectors.isAuthenticated);\n\n  return (\n    <React.Fragment>\n      {isAuthenticated && <WhenAuthenticated />}\n      {props.children}\n    </React.Fragment>\n  );\n}\n","import React from 'react';\nimport { RouteProps } from 'react-router';\n\nimport { RouterPath } from '../../models/paths';\n\n// @ts-ignore\nconst ChatListLazy = React.lazy(() => import('./ChatListPage'));\n\nexport const ChatList: RouteProps = {\n  path: [RouterPath.CHATS_PATH_ID, RouterPath.CHATS_PATH],\n  component: ChatListLazy as React.ComponentClass,\n};\n","import { createStyles, Theme, withStyles, WithStyles } from '@material-ui/core/styles';\nimport IconButton from '@material-ui/core/IconButton';\nimport Avatar from '@material-ui/core/Avatar';\nimport React from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { useFirebase } from 'react-redux-firebase';\nimport { Menu, MenuItem } from '@material-ui/core';\n\nimport { useSelector } from 'react-redux';\nimport { firebaseSelectors } from '../store/firebase/firebase.selectors';\nimport { RouterPath } from '../models/paths';\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    iconButtonAvatar: {\n      padding: 4,\n    },\n    avatarSize: {\n      border: `4px solid ${theme.palette.primary.main}`,\n      width: theme.spacing(6),\n      height: theme.spacing(6),\n    },\n  });\n\ninterface ProfileAvatarProps extends WithStyles<typeof styles> {}\n\nfunction ProfileAvatarC(props: ProfileAvatarProps) {\n  const firebase = useFirebase();\n  const history = useHistory();\n  const profile = useSelector(firebaseSelectors.userProfile);\n  const isAuthenticated = useSelector(firebaseSelectors.isAuthenticated);\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n\n  const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleLogout = () => {\n    firebase.logout().then(() => {\n      setAnchorEl(null);\n      history.push(RouterPath.HOME_PATH);\n    });\n  };\n\n  const handleLogin = () => {\n    firebase\n      .login({ provider: 'google', type: 'popup' })\n      .then(() => {\n        setAnchorEl(null);\n        history.push(RouterPath.ROOMS_PATH);\n      })\n      .catch(err => alert(err.message));\n  };\n\n  const { classes } = props;\n\n  return (\n    <React.Fragment>\n      <IconButton color=\"inherit\" className={classes.iconButtonAvatar} onClick={handleClick}>\n        <Avatar src={profile.avatarUrl || profile.photoURL} alt={profile.displayName} className={classes.avatarSize} />\n      </IconButton>\n\n      <Menu id=\"simple-menu\" anchorEl={anchorEl} keepMounted open={Boolean(anchorEl)} onClose={() => setAnchorEl(null)}>\n        {isAuthenticated ? (\n          <MenuItem onClick={handleLogout}>Logout</MenuItem>\n        ) : (\n          <MenuItem onClick={handleLogin}>Login with Google</MenuItem>\n        )}\n      </Menu>\n    </React.Fragment>\n  );\n}\n\nexport const ProfileAvatar = withStyles(styles)(ProfileAvatarC);\n","import clsx from 'clsx';\nimport React from 'react';\nimport { createStyles, Theme, withStyles, WithStyles } from '@material-ui/core/styles';\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    ornament: {\n      backgroundImage: `url(${process.env.PUBLIC_URL}/assets/svg/ornament-knot.svg)`,\n      width: '100%',\n      height: '100%',\n      backgroundRepeatX: 'repeat',\n      backgroundRepeatY: 'no-repeat',\n      backgroundSize: 'contain',\n    },\n    vartical: {\n      backgroundImage: `url(${process.env.PUBLIC_URL}/assets/svg/ornament-knot-vartical.svg)`,\n      backgroundRepeatX: 'no-repeat',\n      backgroundRepeatY: 'repeat',\n    },\n  });\n\ninterface OrnamentProps extends WithStyles<typeof styles> {\n  vartical?: boolean;\n}\n\nfunction OrnamentC(props: OrnamentProps) {\n  const { classes, vartical } = props;\n\n  return <div className={clsx(classes.ornament, vartical && classes.vartical)} />;\n}\n\nexport const Ornament = React.memo(withStyles(styles)(OrnamentC));\n","import AppBar from '@material-ui/core/AppBar';\nimport Grid from '@material-ui/core/Grid';\nimport Hidden from '@material-ui/core/Hidden';\nimport IconButton from '@material-ui/core/IconButton';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport React from 'react';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport { createStyles, Theme, withStyles, WithStyles } from '@material-ui/core/styles';\n\nimport { ProfileAvatar } from '../../containers/ProfileAvatar';\nimport { Ornament } from '../../components/Ornament';\n\nconst lightColor = 'rgba(255, 255, 255, 0.7)';\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    secondaryBar: {\n      zIndex: 0,\n    },\n    menuButton: {\n      marginLeft: -theme.spacing(1),\n    },\n    link: {\n      textDecoration: 'none',\n      color: lightColor,\n      '&:hover': {\n        color: theme.palette.common.white,\n      },\n    },\n    button: {\n      borderColor: lightColor,\n    },\n    ornament: {\n      bottom: '2px',\n      height: '24px',\n      opacity: 0.2,\n      position: 'absolute',\n      zIndex: -1,\n      width: ' 100%',\n    },\n    avatar: {\n      marginBottom: '-16px',\n    },\n  });\n\ninterface HeaderProps extends WithStyles<typeof styles> {\n  onDrawerToggle: () => void;\n}\n\nfunction HeaderC(props: HeaderProps) {\n  const { classes, onDrawerToggle } = props;\n\n  return (\n    <AppBar color=\"primary\" position=\"sticky\" elevation={2}>\n      <Toolbar>\n        <Grid container spacing={1} alignItems=\"center\">\n          <Hidden smUp>\n            <Grid item>\n              <IconButton\n                color=\"inherit\"\n                aria-label=\"open drawer\"\n                onClick={onDrawerToggle}\n                className={classes.menuButton}\n              >\n                <MenuIcon />\n              </IconButton>\n            </Grid>\n          </Hidden>\n          <Grid item xs />\n          <Grid item>\n            <div className={classes.avatar}>\n              <ProfileAvatar />\n            </div>\n          </Grid>\n        </Grid>\n      </Toolbar>\n      <div className={classes.ornament}>\n        <Ornament />\n      </div>\n    </AppBar>\n  );\n}\n\nexport const Header = React.memo(withStyles(styles)(HeaderC), () => true);\n","import React from 'react';\nimport { createStyles, Theme, withStyles, WithStyles } from '@material-ui/core/styles';\nimport { Fade } from '@material-ui/core';\n\nimport { Loader } from './Loader';\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    container: {\n      opacity: 0,\n      visibility: 'hidden',\n      transitionDelay: '1300ms',\n      transition: 'opacity 225ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n    },\n    visible: {\n      opacity: 1,\n      visibility: 'visible',\n    },\n  });\n\ninterface LoaderScreenProps extends WithStyles<typeof styles> {\n  children: React.ReactElement;\n  isAuthenticating: boolean;\n}\n\nexport const LoaderScreenC = (props: LoaderScreenProps) => {\n  const { children, isAuthenticating = true } = props;\n\n  return (\n    <React.Fragment>\n      <Fade in={isAuthenticating}>\n        <Loader />\n      </Fade>\n      {children}\n    </React.Fragment>\n  );\n};\n\nexport const LoaderScreen = withStyles(styles)(LoaderScreenC);\n","import clsx from 'clsx';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport React from 'react';\nimport { createStyles, Theme, withStyles, WithStyles } from '@material-ui/core/styles';\nimport { DrawerProps } from '@material-ui/core/Drawer';\nimport { ExpansionPanel, ExpansionPanelDetails, ExpansionPanelSummary } from '@material-ui/core';\nimport { NavLink } from 'react-router-dom';\nimport { Omit } from '@material-ui/types';\n\nimport { RouterPath } from '../../../models/paths';\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    item: {\n      paddingTop: 1,\n      paddingBottom: 1,\n      color: 'rgba(255, 255, 255, 0.7)',\n      '&:hover,&:focus': {\n        backgroundColor: 'rgba(255, 255, 255, 0.08)',\n      },\n    },\n    itemCategoryWrapper: {\n      minHeight: '60px',\n    },\n    itemCategory: {\n      width: '100%',\n      paddingTop: theme.spacing(2),\n      paddingBottom: theme.spacing(2),\n    },\n    itemCategoryAbsolute: {\n      position: 'absolute',\n      top: 0,\n    },\n    itemActiveItem: {\n      color: theme.palette.secondary.main,\n    },\n    itemPrimary: {\n      fontSize: 'inherit',\n    },\n    itemIcon: {\n      minWidth: 'auto',\n      marginRight: theme.spacing(2),\n    },\n    expansionPanel: {\n      borderRadius: '0 !important',\n      padding: '0 !important',\n      margin: '0 !important',\n      backgroundColor: (theme.palette.background as any).secondary,\n    },\n    expansionPanelSummary: {\n      margin: '0 !important',\n      padding: '0 16px 0px 0 !important',\n    },\n    expansionPanelSummaryContainer: {\n      padding: '0 !important',\n      margin: '0 !important',\n    },\n    expandIcon: {\n      color: 'rgba(255, 255, 255, 0.7)',\n    },\n    divider: {\n      boxShadow: '0 -1px 0 #404854 inset',\n    },\n  });\n\nexport interface NavigatorItemProps extends Omit<DrawerProps, 'classes'>, WithStyles<typeof styles> {\n  active?: boolean;\n  children?: React.ReactElement | React.ReactFragment;\n  icon?: React.ReactElement;\n  navLink?: RouterPath;\n  text?: string;\n  expandable?: boolean;\n  defaultExpanded?: boolean;\n}\n\nfunction NavigatorItemC(props: NavigatorItemProps) {\n  const { classes, children, icon, text, navLink, active, expandable, defaultExpanded } = props;\n\n  const setNavLink = (children: React.ReactElement) =>\n    navLink ? <NavLink to={navLink}>{children}</NavLink> : <React.Fragment>{children}</React.Fragment>;\n\n  return expandable ? (\n    <ExpansionPanel className={clsx(classes.expansionPanel, classes.divider)} defaultExpanded={defaultExpanded}>\n      <ExpansionPanelSummary\n        aria-controls=\"additional-actions1-content\"\n        aria-label=\"Expand\"\n        classes={{ content: classes.expansionPanelSummaryContainer, expandIcon: classes.expandIcon }}\n        className={classes.expansionPanelSummary}\n        expandIcon={<ExpandMoreIcon />}\n        id=\"additional-actions1-header\"\n      >\n        <div className={classes.itemCategoryWrapper} />\n\n        {setNavLink(\n          <ListItem\n            button\n            className={clsx(\n              classes.item,\n              classes.itemCategory,\n              active && classes.itemActiveItem,\n              classes.itemCategoryAbsolute\n            )}\n          >\n            {icon && <ListItemIcon className={classes.itemIcon}>{icon}</ListItemIcon>}\n            {text && <ListItemText classes={{ primary: classes.itemPrimary }}>{text}</ListItemText>}\n          </ListItem>\n        )}\n      </ExpansionPanelSummary>\n      {children && <ExpansionPanelDetails>{children}</ExpansionPanelDetails>}\n    </ExpansionPanel>\n  ) : (\n    setNavLink(\n      <ListItem\n        button\n        className={clsx(classes.item, classes.itemCategory, active && classes.itemActiveItem, classes.divider)}\n      >\n        {icon && <ListItemIcon className={classes.itemIcon}>{icon}</ListItemIcon>}\n        {text && <ListItemText classes={{ primary: classes.itemPrimary }}>{text}</ListItemText>}\n      </ListItem>\n    )\n  );\n}\n\nexport const NavigatorItem = withStyles(styles)(NavigatorItemC);\n","import React from 'react';\nimport { createStyles, Theme, withStyles, WithStyles } from '@material-ui/core/styles';\nimport { Card, CardContent, CardMedia, Typography } from '@material-ui/core';\n\nimport { IRoom } from '../models/rooms.model';\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    cards: {\n      maxWidth: 936,\n      width: '100%',\n    },\n    media: {\n      height: 140,\n    },\n  });\n\ninterface RoomCardProps extends WithStyles<typeof styles> {\n  room: IRoom;\n}\n\nfunction RoomCardC(props: RoomCardProps) {\n  const { classes, room } = props;\n\n  return (\n    <Card className={classes.cards}>\n      {room.roomImage && <CardMedia className={classes.media} image={room.roomImage} title=\"Room image\" />}\n      <CardContent>\n        <Typography gutterBottom variant=\"h5\" component=\"h2\">\n          {room.roomName}\n        </Typography>\n        <Typography gutterBottom variant=\"h6\" component=\"h6\">\n          {room.campaignTitle}\n        </Typography>\n        <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\">\n          {room.description}\n        </Typography>\n        <p>\n          <Typography variant=\"caption\" color=\"textSecondary\" component=\"span\">\n            Max players:\n          </Typography>{' '}\n          <Typography color=\"textSecondary\" variant=\"h6\" component=\"span\">\n            {room.maxPlayers}\n          </Typography>\n        </p>\n        <p>\n          <Typography variant=\"caption\" color=\"textSecondary\" component=\"span\">\n            Room Game Master:\n          </Typography>\n          <br />\n          <Typography variant=\"subtitle1\" color=\"textSecondary\" component=\"span\">\n            {Object.values(room.players).find(player => !!player.gameMaster)?.displayName}\n          </Typography>\n        </p>\n      </CardContent>\n    </Card>\n  );\n}\n\nexport const RoomCard = withStyles(styles)(RoomCardC);\n","import ChatIcon from '@material-ui/icons/Chat';\nimport Drawer, { DrawerProps } from '@material-ui/core/Drawer';\nimport GamesIcon from '@material-ui/icons/Games';\nimport HomeIcon from '@material-ui/icons/Home';\nimport MeetingRoomIcon from '@material-ui/icons/MeetingRoom';\nimport React from 'react';\nimport { createStyles, Theme, withStyles, WithStyles } from '@material-ui/core/styles';\nimport { List, ListItem } from '@material-ui/core';\nimport { Omit } from '@material-ui/types';\nimport { useSelector } from 'react-redux';\n\nimport { ChatList, ChatListType } from '../../modules/ChatList/ChatList';\nimport { firestoreSelectors } from '../../store/firebase/firestore.selectors';\nimport { locationSelectors } from '../../store/location/location.selectors';\nimport { NavigatorItem } from './components/NavigatorItem';\nimport { RoomCard } from '../../containers/RoomCard';\nimport { RouterPath } from '../../models/paths';\nimport { roomsSelectors } from '../../store/rooms/rooms.selectors';\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    logo: {\n      fontSize: 24,\n      color: theme.palette.common.white,\n      '&:hover,&:focus': {\n        backgroundColor: 'rgba(255, 255, 255, 0.08)',\n      },\n      backgroundColor: (theme.palette.background as any).secondary,\n      boxShadow: '0 -1px 0 #404854 inset',\n      paddingTop: theme.spacing(2),\n      paddingBottom: theme.spacing(2),\n    },\n  });\n\nexport interface NavigatorProps extends Omit<DrawerProps, 'classes'>, WithStyles<typeof styles> {}\n\nfunction NavigatorC(props: NavigatorProps) {\n  const { classes, ...other } = props;\n\n  const { path: locationPath } = useSelector(locationSelectors.match);\n  const selectedRoomData = useSelector(firestoreSelectors.selectedRoom);\n  const drawerOpened = useSelector(roomsSelectors.drawerOpened);\n\n  return (\n    <Drawer\n      open={drawerOpened}\n      variant={locationPath === RouterPath.ROOMS_PATH_ID ? 'persistent' : 'permanent'}\n      {...other}\n    >\n      <List disablePadding>\n        <ListItem className={classes.logo}>Roll a Dice...</ListItem>\n      </List>\n\n      <NavigatorItem\n        navLink={RouterPath.HOME_PATH}\n        icon={<HomeIcon />}\n        text=\"HomePage Page\"\n        active={RouterPath.HOME_PATH === locationPath}\n      />\n\n      <NavigatorItem\n        navLink={RouterPath.ROOMS_PATH}\n        icon={<MeetingRoomIcon />}\n        text=\"Rooms\"\n        expandable={locationPath.indexOf(RouterPath.ROOMS_PATH) === -1}\n        active={locationPath.indexOf(RouterPath.ROOMS_PATH) > -1}\n      >\n        <React.Fragment>List here</React.Fragment>\n      </NavigatorItem>\n\n      <NavigatorItem\n        navLink={RouterPath.CHATS_PATH}\n        icon={<ChatIcon />}\n        text=\"Chats\"\n        expandable={locationPath.indexOf(RouterPath.CHATS_PATH) === -1}\n        active={locationPath.indexOf(RouterPath.CHATS_PATH) > -1}\n      >\n        <ChatList viewType={ChatListType.EMBEDDED} />\n      </NavigatorItem>\n\n      {selectedRoomData && (\n        <NavigatorItem\n          icon={<GamesIcon />}\n          text=\"Room Ditails\"\n          expandable={true}\n          active={locationPath.indexOf(RouterPath.ROOM_PATH) > -1}\n          defaultExpanded\n        >\n          <RoomCard room={selectedRoomData} />\n        </NavigatorItem>\n      )}\n    </Drawer>\n  );\n}\n\nexport const Navigator = withStyles(styles)(NavigatorC);\n","import { createMuiTheme, Theme } from '@material-ui/core/styles';\n\nfunction themeFn() {\n  let theme = createMuiTheme({\n    palette: {\n      primary: {\n        light: '#afaf4c',\n        main: '#9b9c20',\n        dark: '#6c6d16',\n      },\n      secondary: {\n        light: '#cba234',\n        main: '#be8b02',\n        dark: '#856101',\n      },\n      background: {\n        default: '#e0e0d3',\n        paper: '#f4f4f2',\n        // @ts-ignore\n        secondary: '#111b0e',\n      },\n    },\n    typography: {\n      fontFamily: [\n        'ringbearermedium',\n        '-apple-system',\n        'BlinkMacSystemFont',\n        '\"Segoe UI\"',\n        'Roboto',\n        '\"Helvetica Neue\"',\n        'Arial',\n        'sans-serif',\n        '\"Apple Color Emoji\"',\n        '\"Segoe UI Emoji\"',\n        '\"Segoe UI Symbol\"',\n      ].join(','),\n      h5: {\n        fontWeight: 500,\n        fontSize: 26,\n        letterSpacing: 0.5,\n      },\n    },\n    shape: {\n      borderRadius: 8,\n    },\n    props: {\n      MuiTab: {\n        disableRipple: true,\n      },\n    },\n    mixins: {\n      toolbar: {\n        minHeight: 48,\n      },\n    },\n  });\n\n  theme = {\n    ...theme,\n    overrides: {\n      MuiDrawer: {\n        paper: {\n          backgroundColor: '#121b0f',\n        },\n      },\n      MuiButton: {\n        label: {\n          textTransform: 'none',\n        },\n        contained: {\n          boxShadow: 'none',\n          '&:active': {\n            boxShadow: 'none',\n          },\n        },\n      },\n      MuiTabs: {\n        root: {\n          marginLeft: theme.spacing(1),\n        },\n        indicator: {\n          height: 3,\n          borderTopLeftRadius: 3,\n          borderTopRightRadius: 3,\n        },\n      },\n      MuiTab: {\n        root: {\n          textTransform: 'none',\n          margin: '0 16px',\n          minWidth: 0,\n          padding: 0,\n          [theme.breakpoints.up('md')]: {\n            padding: 0,\n            minWidth: 0,\n          },\n        },\n      },\n      MuiIconButton: {\n        root: {\n          padding: theme.spacing(1),\n        },\n      },\n      MuiTooltip: {\n        tooltip: {\n          borderRadius: 4,\n        },\n      },\n      MuiDivider: {\n        root: {\n          backgroundColor: '#404854',\n        },\n      },\n      MuiListItemText: {\n        primary: {\n          fontWeight: theme.typography.fontWeightMedium,\n        },\n      },\n      MuiListItemIcon: {\n        root: {\n          color: 'inherit',\n          marginRight: 0,\n          '& svg': {\n            fontSize: 20,\n          },\n        },\n      },\n      MuiAvatar: {\n        root: {\n          width: 32,\n          height: 32,\n        },\n      },\n    },\n  };\n\n  return theme;\n}\n\nexport const theme = themeFn();\n\nexport const darkTheme: Theme = { ...theme, palette: { ...theme.palette, type: 'dark' } };\nexport const lightTheme: Theme = { ...theme, palette: { ...theme.palette, type: 'dark' } };\n","import Hidden from '@material-ui/core/Hidden';\nimport React from 'react';\nimport { createStyles, withStyles, WithStyles } from '@material-ui/core/styles';\nimport { useSelector } from 'react-redux';\n\nimport { Navigator } from './Navigator/Navigator';\nimport { theme } from '../styles/theme.styles';\nimport { roomsSelectors } from '../store/rooms/rooms.selectors';\n\nlet drawerWidth = 320;\n\nconst styles = createStyles({\n  drawer: {\n    [theme.breakpoints.up('sm')]: {\n      flexShrink: 0,\n      width: '100%',\n      maxWidth: drawerWidth,\n      transition: 'max-width 225ms cubic-bezier(0, 0, 0.2, 1) 0ms',\n    },\n  },\n});\n\ninterface NavBarProps extends WithStyles<typeof styles> {\n  mobileOpen: boolean;\n  handleDrawerToggle: () => void;\n}\n\nexport function NavBarC(props: NavBarProps) {\n  const { classes, mobileOpen } = props;\n  const drawerOpened = useSelector(roomsSelectors.drawerOpened);\n\n  return (\n    <nav className={classes.drawer} style={{ maxWidth: drawerOpened ? drawerWidth : 0 }}>\n      <Hidden smUp implementation=\"js\">\n        <Navigator\n          PaperProps={{ style: { width: drawerWidth } }}\n          variant=\"temporary\"\n          open={mobileOpen}\n          onClose={props.handleDrawerToggle}\n        />\n      </Hidden>\n      <Hidden xsDown implementation=\"css\">\n        <Navigator PaperProps={{ style: { width: drawerWidth } }} />\n      </Hidden>\n    </nav>\n  );\n}\n\nexport const NavBar = withStyles(styles)(NavBarC);\n","import { AppState } from '../main';\n\nexport const uiSelectors = {\n  isPending: (state: AppState): boolean => state.ui.isPending,\n};\n","import clsx from 'clsx';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Link from '@material-ui/core/Link';\nimport React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport { createStyles, ThemeProvider, withStyles, WithStyles } from '@material-ui/core/styles';\nimport { LinearProgress, Slide } from '@material-ui/core';\nimport { useSelector } from 'react-redux';\n\nimport { firebaseSelectors } from '../store/firebase/firebase.selectors';\nimport { Header } from './Header/Header';\nimport { LoaderScreen } from '../components/LoaderScreen';\nimport { NavBar } from './NavBar';\nimport { theme } from '../styles/theme.styles';\nimport { uiSelectors } from '../store/ui/ui.selectors';\n\nfunction Copyright() {\n  return (\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\n      {'Copyright © '}\n      <Link color=\"inherit\" href=\"mailto:markky21@gmail.com\">\n        Marcin Mirecki\n      </Link>{' '}\n      {new Date().getFullYear()}\n      {'.'}\n    </Typography>\n  );\n}\n\nconst styles = createStyles({\n  root: {\n    display: 'flex',\n    minHeight: '100vh',\n  },\n  lineLoader: {\n    position: 'fixed',\n    height: theme.spacing(0.75),\n    top: 0,\n    left: 0,\n    width: '100%',\n    zIndex: 10000,\n    transition: 'max-height 0.2s ease;',\n  },\n  app: {\n    flex: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    maxWidth: '100vw',\n    overflow: 'hidden',\n  },\n  appWhenAuth: {\n    maxWidth: `calc(100vw - ${theme.spacing(40)})`,\n  },\n  main: {\n    flex: 1,\n    padding: theme.spacing(6, 4),\n    background: theme.palette.background.default,\n  },\n\n  footer: {\n    padding: theme.spacing(1),\n    background: theme.palette.background.default,\n  },\n});\n\nexport interface PaperbaseProps extends WithStyles<typeof styles> {\n  children?: any;\n}\nfunction CoreLayoutC(props: PaperbaseProps) {\n  const { classes, children } = props;\n  const [mobileOpen, setMobileOpen] = React.useState(false);\n  const isAuthenticated = useSelector(firebaseSelectors.isAuthenticated);\n  const isAuthenticating = useSelector(firebaseSelectors.authenticatingSelector);\n  const isRequesting = useSelector(firebaseSelectors.isRequesting);\n  const isPending = useSelector(uiSelectors.isPending);\n\n  const handleDrawerToggle = () => {\n    setMobileOpen(!mobileOpen);\n  };\n\n  return (\n    <ThemeProvider theme={theme}>\n      <LoaderScreen isAuthenticating={isAuthenticating}>\n        <div className={classes.root}>\n          <CssBaseline />\n          <Slide in={isRequesting || isPending} direction={'down'}>\n            <LinearProgress className={classes.lineLoader} color={'secondary'} />\n          </Slide>\n          {isAuthenticated && <NavBar mobileOpen={mobileOpen} handleDrawerToggle={handleDrawerToggle} />}\n\n          <div className={clsx(classes.app, isAuthenticated && classes.appWhenAuth)}>\n            <Header onDrawerToggle={handleDrawerToggle} />\n            <main className={classes.main}>{children}</main>\n            <footer className={classes.footer}>\n              <Copyright />\n            </footer>\n          </div>\n        </div>\n      </LoaderScreen>\n    </ThemeProvider>\n  );\n}\n\nexport const CoreLayout = withStyles(styles)(CoreLayoutC);\n","import React from 'react';\nimport { createStyles, Theme, withStyles, WithStyles } from '@material-ui/core/styles';\nimport { Grid, Grow, Paper, Typography } from '@material-ui/core';\nimport { useSelector } from 'react-redux';\n\nimport { firebaseSelectors } from '../../store/firebase/firebase.selectors';\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    root: {\n      width: '100%',\n    },\n    paper: {\n      padding: theme.spacing(2, 4),\n      height: '100%',\n    },\n    label: { textAlign: 'center' },\n    value: {\n      lineHeight: '70%',\n      textAlign: 'center',\n    },\n  });\n\ninterface AppStatsProps extends WithStyles<typeof styles> {}\n\nfunction AppStatsC(props: AppStatsProps) {\n  const { classes } = props;\n\n  const appStats = useSelector(firebaseSelectors.applicationStats);\n  const statsView = [\n    { label: 'Players:', value: appStats?.players || 0 },\n    { label: 'Rooms created:', value: appStats?.rooms || 0 },\n    { label: 'Dice throws:', value: appStats?.diceThrows || 0 },\n  ];\n\n  return (\n    <Grid container direction=\"row\" justify=\"space-between\" alignItems=\"stretch\" spacing={4} className={classes.root}>\n      {statsView.map((stat, id) => (\n        <Grow key={stat.label} in timeout={id * 300 + 300}>\n          <Grid item xs={4}>\n            <Paper className={classes.paper}>\n              <Typography component=\"h5\" variant=\"h5\" color=\"textSecondary\" className={classes.label}>\n                {stat.label}\n              </Typography>\n              <Typography component=\"div\" variant=\"h1\" className={classes.value}>\n                {stat.value}\n              </Typography>\n            </Paper>\n          </Grid>\n        </Grow>\n      ))}\n    </Grid>\n  );\n}\n\nexport const AppStats = withStyles(styles)(AppStatsC);\n","import clsx from 'clsx';\nimport React, { useEffect, useState } from 'react';\nimport { makeStyles, Theme } from '@material-ui/core/styles';\nimport { useSelector } from 'react-redux';\n\nimport { AppStats } from '../../../modules/AppStats/AppStats';\nimport { Dice } from '../../../models/dice.model';\nimport { DiceCard } from '../../../modules/DiceCard/DiceCard';\nimport { DiceDashboard } from '../../../modules/DiceDashboard/DiceDashboard';\nimport { DiceServiceContextC } from '../../../contexts/DiceService.context';\nimport { IRoom } from '../../../models/rooms.model';\nimport { roomsSelectors } from '../../../store/rooms/rooms.selectors';\nimport { timer } from 'rxjs';\n\nconst styles = (theme: Theme) => ({\n  root: {\n    position: 'relative' as 'relative',\n    margin: theme.spacing(-4, -2),\n    height: `calc(100% + ${theme.spacing(10)}px)`,\n  },\n  cssGrid: {\n    display: 'grid',\n    gridTemplateColumns: '1fr',\n    gridTemplateRows: 'auto 1fr',\n    rowGap: `${theme.spacing(2)}px`,\n    columnGap: `${theme.spacing(2)}px`,\n  },\n  cssItem1: {\n    gridColumn: 1,\n    gridRow: 1,\n  },\n  cssItem2: {\n    gridColumn: 1,\n    gridRow: 2,\n  },\n  mainInfoCard: {},\n  diceCard: {},\n  diceDashboard: {\n    position: 'fixed' as 'fixed',\n    zIndex: 1000,\n    bottom: theme.spacing(8),\n    right: theme.spacing(3),\n  },\n});\n\nconst useStyles = makeStyles(styles);\n\ninterface HomeWrapperProps {}\n\nconst room: Partial<IRoom> = {\n  diceType: [Dice.D4, Dice.D6, Dice.D8, Dice.D10, Dice.D12, Dice.D20, Dice.D100],\n  gameMasterAvatar: `${process.env.PUBLIC_URL}/assets/images/avatar-1.jpg`,\n};\n\nexport function HomeWrapper(props: HomeWrapperProps) {\n  const classes = useStyles();\n  const diceRolling = useSelector(roomsSelectors.diceRolling);\n\n  const [showDiceCard, setShowDiceCard] = useState(false);\n  useEffect(() => {\n    timer(300).subscribe(() => setShowDiceCard(true));\n  }, []);\n\n  return (\n    <div className={clsx(classes.root, classes.cssGrid)}>\n      <section className={clsx(classes.mainInfoCard, classes.cssGrid)}>\n        <AppStats />\n      </section>\n\n      <DiceServiceContextC>\n        <nav className={classes.diceDashboard}>\n          <DiceDashboard visible={!diceRolling} room={room as IRoom} />\n        </nav>\n        <section className={classes.diceCard}>{showDiceCard && <DiceCard />}</section>\n      </DiceServiceContextC>\n    </div>\n  );\n}\n","export const appQuery = {\n  applicationStats: { path: 'applicationStats', storeAs: 'applicationStats' },\n};\n","import React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport '../../App.css';\nimport { HomeWrapper } from './components/HomeWrapper';\nimport { locationActions } from '../../store/location/location.actions';\nimport { LocationMatch } from '../../store/location/location.model';\nimport { locationSelectors } from '../../store/location/location.selectors';\nimport { useFirebaseConnect } from 'react-redux-firebase';\nimport { appQuery } from '../../queries/app.query';\n\nexport interface HomeProps {\n  match: LocationMatch;\n}\n\nexport function HomeC(props: HomeProps) {\n  const { match } = props;\n  const dispatch = useDispatch();\n  const storeLocationMatch = useSelector(locationSelectors.match);\n\n  useFirebaseConnect([appQuery.applicationStats]);\n\n  useEffect(() => {\n    if (JSON.stringify(match) !== JSON.stringify(storeLocationMatch)) {\n      dispatch(locationActions.matchChange(match));\n    }\n  });\n\n  return <HomeWrapper />;\n}\n\nexport const HomePage = {\n  path: '/',\n  component: HomeC,\n};\n","import React from 'react';\nimport { RouteProps } from 'react-router';\n\nimport { RouterPath } from '../../models/paths';\n\n// @ts-ignore\nconst RoomLazy = React.lazy(() => import('./RoomPage'));\n\nexport const Room: RouteProps = {\n  path: [RouterPath.ROOMS_PATH_ID],\n  component: RoomLazy as React.ComponentClass,\n};\n","import React from 'react';\nimport { RouteProps } from 'react-router';\n\nimport { RouterPath } from '../../models/paths';\n\n// @ts-ignore\nconst RoomListLazy = React.lazy(() => import('./RoomListPage'));\n\nexport const RoomList: RouteProps = {\n  path: [RouterPath.ROOM_CREATE_PATH, RouterPath.ROOMS_PATH],\n  component: RoomListLazy,\n};\n","import React, { Suspense } from 'react';\nimport { Backdrop, createStyles, Theme } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Route, Switch } from 'react-router-dom';\n\nimport { ChatList } from './ChatList';\nimport { CoreLayout } from '../layouts/CoreLayout';\nimport { HomePage } from './Home/HomePage';\nimport { Room } from './Room';\nimport { RoomList } from './RoomList';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    backdrop: {\n      zIndex: theme.zIndex.drawer + 1,\n      color: '#fff',\n    },\n  })\n);\n\nexport function CreateRoutes() {\n  const classes = useStyles();\n  return (\n    <CoreLayout>\n      <Suspense fallback={<Backdrop className={classes.backdrop} open />}>\n        <Switch>\n          <Route exact path={HomePage.path} component={HomePage.component} />\n\n          {[RoomList, Room, ChatList].map((settings, index) => (\n            <Route key={`Route-${index}`} {...settings} />\n          ))}\n\n          {/*<Route component={NotFoundRoute.component} />* // TODO to implement */}\n        </Switch>\n      </Suspense>\n    </CoreLayout>\n  );\n}\n","import { firestore, initializeApp } from 'firebase/app';\nimport 'firebase/auth';\nimport 'firebase/database';\nimport 'firebase/firestore';\nimport firebaseApp from 'firebase/app';\nimport { createFirestoreInstance } from 'redux-firestore';\nimport { store } from './store.config';\n\nexport const firebaseConfig = {\n  apiKey: 'AIzaSyA0bXhCXcLJC9FGk3ynZoJP5KJ6CY3sqYY',\n  authDomain: 'roll-a-dice-4cba1.firebaseapp.com',\n  databaseURL: 'https://roll-a-dice-4cba1.firebaseio.com',\n  projectId: 'roll-a-dice-4cba1',\n  storageBucket: 'roll-a-dice-4cba1.appspot.com',\n  messagingSenderId: '768622256477',\n  appId: '1:768622256477:web:51a5c9f0ef4030d366c8b4',\n  measurementId: 'G-J2M3QQ0M89',\n};\n\nexport const reactReduxFirebaseConfig = {\n  userProfile: 'users',\n  useFirestoreForProfile: true,\n};\n\nexport const reactReduxFirebaseProps = {\n  firebase: firebaseApp,\n  config: reactReduxFirebaseConfig,\n  dispatch: store.dispatch,\n  createFirestoreInstance,\n};\n\ninitializeApp(firebaseConfig);\nfirestore();\n","import React from 'react';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core';\nimport { Provider } from 'react-redux';\nimport { ReactReduxFirebaseProvider } from 'react-redux-firebase';\n\nimport { Core } from './containers/Core';\nimport { CreateRoutes } from './routes';\nimport { HashRouter } from 'react-router-dom';\nimport { reactReduxFirebaseProps } from './config/firebase.config';\nimport { store } from './config/store.config';\nimport { ToastContextC } from './contexts/Toast.context';\n\nexport interface AppProps {}\n\nexport default function App(props: AppProps) {\n  const prefersDarkMode = useMediaQuery('(prefers-color-scheme: dark)');\n\n  const theme = React.useMemo(\n    () =>\n      createMuiTheme({\n        palette: {\n          // TODO: provide theming\n          type: prefersDarkMode ? 'dark' : 'light',\n        },\n      }),\n    [prefersDarkMode]\n  );\n\n  (window as any).theme = theme;\n\n  return (\n    <Provider store={store}>\n      <ReactReduxFirebaseProvider {...reactReduxFirebaseProps}>\n        <ThemeProvider theme={theme}>\n          <ToastContextC>\n            <Core>\n              <HashRouter>\n                <CreateRoutes />\n              </HashRouter>\n            </Core>\n          </ToastContextC>\n        </ThemeProvider>\n      </ReactReduxFirebaseProvider>\n    </Provider>\n  );\n}\n","/* eslint-disable */\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ninterface Config {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n}\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL((process as { env: { [key: string]: string } }).env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (response.status === 404 || (contentType != null && contentType.indexOf('javascript') === -1)) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './styles/index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport { version } from '../package.json';\nimport { env } from './config/main.config';\nimport { initScripts } from './utils/initail.utils';\n\n// Window Variables\n// ------------------------------------\n(window as any).version = version;\n(window as any).env = env;\ninitScripts();\n\n// Store Initialization\n// ------------------------------------\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","export const env = 'local';\n","export enum FirestoreCollection {\n  CHATS = 'chats',\n  USERS = 'users',\n  ROOMS = 'rooms',\n}\n\nexport interface IApplicationStats {\n  rooms: number;\n  diceThrows: number;\n  players: number;\n}\n","import { AppState } from '../main';\n\nexport const roomsSelectors = {\n  selectedRoomUid: (state: AppState): string | null => state.rooms.selectedRoom || null,\n  drawerOpened: (state: AppState): boolean => state.rooms.drawerOpened,\n  chatOpened: (state: AppState): boolean => state.rooms.chatOpened,\n  playersOpened: (state: AppState): boolean => state.rooms.playersOpened,\n  diceRolling: (state: AppState): boolean => state.rooms.diceRolling,\n};\n","import { AppState } from '../main';\nimport { Dictionary } from 'react-redux-firebase';\nimport { IChat } from '../../models/chats.model';\nimport { IPlayerProfile, IProfile, IRoom, IRoomCreateForm } from '../../models/rooms.model';\n\nexport const firestoreSelectors = {\n  userChats: (state: AppState): Dictionary<IChat> | undefined => state.firestore.data.userChats,\n\n  getChat: (chatId: string | null) => (state: AppState): IChat | null =>\n    !!chatId && state.firestore.data.userChats ? state.firestore.data.userChats[chatId] : null,\n\n  selectedRoom: (state: AppState): IRoom | undefined => state.firestore.data.selectedRoom,\n\n  selectedRoomFormData: (state: AppState): IRoomCreateForm | undefined => {\n    if (!state.firestore.data.selectedRoom) return;\n    const {\n      roomName,\n      diceType,\n      description,\n      roomImage,\n      gameMasterAvatar,\n      campaignTitle,\n      maxPlayers,\n    } = state.firestore.data.selectedRoom;\n    return { roomName, diceType, description, roomImage, gameMasterAvatar, campaignTitle, maxPlayers };\n  },\n\n  userRoomsAsGameMaster: (state: AppState): Dictionary<IRoom> | undefined => state.firestore.data.userRoomsAsGameMaster,\n\n  userRoomsAsPlayer: (state: AppState): Dictionary<IRoom> | undefined => state.firestore.data.userRoomsAsPlayer,\n\n  allUserRoomsUid: (state: AppState): string[] =>\n    Object.keys({\n      ...state.firestore.data.userRoomsAsGameMaster,\n      ...state.firestore.data.userRoomsAsPlayer,\n    }),\n\n  usersProfiles: (state: AppState): Dictionary<IProfile> => state.firestore.data.usersProfiles || {},\n\n  selectedRoomPlayers: (state: AppState): Dictionary<IPlayerProfile> => state.firestore.data.selectedRoom?.players,\n\n  selectedRoomGameMasterUid: (state: AppState): string => state.firestore.data.selectedRoom?.gameMasterUid,\n\n  selectedRoomLogs: (state: AppState) => state.firestore.data.selectedRoom?.logs,\n};\n","export interface IDiceBeforeThrow {\n  throwConfig: IDiceThrowConfig;\n}\n\nexport interface IDiceAfterThrow {\n  throwConfig: IDiceThrowConfig;\n  result: number[];\n}\n\nexport enum Dice {\n  D4 = 'd4',\n  D6 = 'd6',\n  D8 = 'd8',\n  D10 = 'd10',\n  D12 = 'd12',\n  D20 = 'd20',\n  D100 = 'd100',\n}\n\nexport interface IDiceVector {\n  x: number;\n  y: number;\n}\n\nexport interface IDiceThrowConfig {\n  vectors: IDiceVector[];\n  boost: number;\n  dist: number;\n}\n\nexport interface INewDiceThrowResult {\n  [Dice.D4]?: number[];\n  [Dice.D6]?: number[];\n  [Dice.D8]?: number[];\n  [Dice.D10]?: number[];\n  [Dice.D12]?: number[];\n  [Dice.D20]?: number[];\n  [Dice.D100]?: number[];\n}\n\nexport interface IDiceSet {\n  [Dice.D4]?: number;\n  [Dice.D6]?: number;\n  [Dice.D8]?: number;\n  [Dice.D10]?: number;\n  [Dice.D12]?: number;\n  [Dice.D20]?: number;\n  [Dice.D100]?: number;\n}\n\nexport interface IDiceThrow {\n  diceSet: IDiceSet;\n  diceThrowConfig?: IDiceThrowConfig;\n  result?: INewDiceThrowResult;\n}\n","import React from 'react';\nimport { Snackbar } from '@material-ui/core';\nimport { Alert } from '@material-ui/lab';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\n\nexport enum SnackbarType {\n  SUCCESS = 'success',\n  ERROR = 'error',\n  WARNING = 'warning',\n}\n\nexport interface SnackbarConfig {\n  type: SnackbarType;\n  open: boolean;\n  text: string;\n}\n\nexport type ToastContextProviderValue = {\n  snackbarConfig: SnackbarConfig;\n  setSnackbarConfig: (snackbarConfig: SnackbarConfig) => void;\n};\n\nexport const ToastContext = React.createContext<ToastContextProviderValue>(null);\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    snackbar: {\n      top: theme.spacing(8),\n    },\n  });\nconst useStyles = makeStyles(styles);\n\nexport const ToastContextC: React.FC = ({ children }) => {\n  const classes = useStyles();\n  const [snackbarConfig, setSnackbarConfig] = React.useState<SnackbarConfig>(null);\n\n  return (\n    <ToastContext.Provider value={{ snackbarConfig, setSnackbarConfig }}>\n      {children}\n      <Snackbar\n        className={classes.snackbar}\n        anchorOrigin={{ vertical: 'top', horizontal: 'right' }}\n        open={snackbarConfig?.open}\n        autoHideDuration={6000}\n        onClose={() => setSnackbarConfig({ ...snackbarConfig, open: false })}\n      >\n        <Alert\n          variant=\"filled\"\n          onClose={() => setSnackbarConfig({ ...snackbarConfig, open: false })}\n          severity={snackbarConfig?.type}\n        >\n          {snackbarConfig?.text}\n        </Alert>\n      </Snackbar>\n    </ToastContext.Provider>\n  );\n};\n"],"sourceRoot":""}