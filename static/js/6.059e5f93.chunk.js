(this["webpackJsonproll-a-dice"]=this["webpackJsonproll-a-dice"]||[]).push([[6],{702:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(703),r=a.n(n),c=a(708),i=a(58),o=a(30),l=a(38),s=a(287),m=r()({}),u=Object(i.a)(),d=Object(c.connectedRouterRedirect)({redirectPath:o.a.HOME_PATH,AuthenticatingComponent:s.a,wrapperDisplayName:"UserIsAuthenticated",authenticatedSelector:l.a.isAuthenticated,authenticatingSelector:l.a.authenticatingSelector,redirectAction:function(e){return function(t){u.push(e),t({type:"UNAUTHED_REDIRECT",payload:{message:"User is not authenticated."}})}}});Object(c.connectedRouterRedirect)({AuthenticatingComponent:s.a,wrapperDisplayName:"UserIsNotAuthenticated",allowRedirectBack:!1,authenticatedSelector:function(e){return e.firebase.auth.isEmpty},authenticatingSelector:function(e){var t=e.firebase,a=t.auth,n=t.isInitializing;return!a.isLoaded||n},redirectPath:function(e,t){return m.getRedirectQueryParam(t)||o.a.ROOMS_PATH},redirectAction:function(e){return function(t){u.push(e),t({type:"AUTHED_REDIRECT",payload:{message:"User is not authenticated."}})}}})},705:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(0),r=a.n(n),c=a(25),i=a(670),o=a(785),l=a(786);function s(e){var t=e.open,a=e.onClose,n=e.children,s=void 0===n?[]:n,m=e.title,u=Object(c.a)(),d=Object(i.a)(u.breakpoints.down("xs"));return r.a.createElement(o.a,{fullScreen:d,open:t,onClose:a,"aria-labelledby":"responsive-dialog-title"},r.a.createElement(l.a,null,m),s)}},706:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(0),r=a.n(n),c=a(402),i=a(673),o=a(678),l=a(399),s=Object(c.a)({image:{width:"100%",height:"25vh",backgroundPosition:"top",backgroundSize:"cover"}}),m=Object(l.a)(s);var u=r.a.memo((function(e){var t=e.src,a=void 0===t?"":t,n=e.title,c=m();return r.a.createElement(i.a,{in:a.length>8},a&&r.a.createElement(o.a,{className:c.image,image:a,title:n}))}))},709:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(0),r=a.n(n).a.lazy((function(){return a.e(8).then(a.bind(null,717))}))},711:function(e,t,a){"use strict";var n=a(0),r=a.n(n),c=a(787),i=a(788),o=a(789),l=a(692),s=a(12),m=a(112),u=a(288),d=a(706),p=a(284);var b=Object(l.a)({form:"createRoom",validate:function(e){var t={};return[m.b.roomName.name,m.b.maxPlayers.name].forEach((function(a){e[a]||(t[a]="Required")})),Object.keys(m.b).forEach((function(a){var n;m.b[a].maxLength&&(null===(n=e[m.b[a].name])||void 0===n?void 0:n.length)>m.b[a].maxLength&&(t[a]="Max length ".concat(m.b[a].maxLength," exceeded"))})),e[m.b.diceType.name]&&e[m.b.diceType.name].length||(t[m.b.diceType.name]="Select at least one dice"),t}})((function(e){var t=e.handleSubmit,a=e.pristine,n=e.submitting,l=e.onClose,b=e.invalid,f=Object(s.useSelector)(p.a.getFormCreateRoom);return r.a.createElement("form",{onSubmit:t},r.a.createElement(d.a,{src:null===f||void 0===f?void 0:f.roomImage,title:"Room image"}),r.a.createElement(c.a,{dividers:!0},r.a.createElement(u.c,m.b.roomName),r.a.createElement(u.c,m.b.roomImage),r.a.createElement(u.c,m.b.campaignTitle),r.a.createElement(u.c,m.b.description),r.a.createElement(u.c,m.b.gameMasterAvatar),r.a.createElement("div",{style:{width:"50%"}},r.a.createElement(u.c,m.b.maxPlayers)),r.a.createElement(u.a,m.b.diceType)),r.a.createElement(i.a,null,r.a.createElement(o.a,{type:"submit",color:"primary",disabled:b||a||n},"Submit"),r.a.createElement(o.a,{type:"button",onClick:l,color:"primary"},"Cancel")))})),f=a(705),E=a(55);a.d(t,"a",(function(){return g}));var g=r.a.memo((function(e){var t=e.open,a=e.onClose,n=e.onSubmit,c=e.initialValues;return r.a.createElement(f.a,{open:t,onClose:a,title:"Create new room"},r.a.createElement(b,{onClose:a,onSubmit:n,initialValues:c}))}),(function(e,t){return Object(E.a)(e.initialValues,t.initialValues)&&e.open===t.open}))},793:function(e,t,a){"use strict";a.r(t);var n=a(27),r=a(85),c=a(710),i=a(702),o=Object(n.d)(Object(c.a)("EnhancedRoomList"),r.g,i.a),l=a(10),s=a(17),m=a(48),u=a(0),d=a.n(u),p=a(12),b=a(35),f=a(205),E=a(38),g=a(61),h=a(89),v=a(289),O=a(163),y=a(290),j=a(66),S=a(128),x=a(4),C=a(399),R=a(709),w=a(376),N=a(377),k=a(617),U=a(108),I=a(36),D=a(667),L=a(279),P=a(743),A=a.n(P),T=a(25),H=a(795),M=a(782),F=a(139),z=a(794),G=a(402),V=a(5),W=a(761),_=a(665),Y=a(112),B=a(612),J=a(671),q=a(696),K=a(672),Q=a(669),X=a(286);var Z=Object(V.a)((function(e){return Object(G.a)({itemHeader:{width:"40%",paddingRight:e.spacing(2),boxSizing:"border-box"},itemContent:{width:"60%",boxSizing:"border-box"}})}))((function(e){var t=e.profile,a=e.log,n=e.classes,r=e.children,c=t||{},i=c.displayName,o=c.photoURL,l=c.avatarUrl,s=c.characterAvatarUrl,m=c.characterName;return d.a.createElement(B.a,{alignItems:"flex-start"},d.a.createElement("div",{className:n.itemHeader},d.a.createElement(J.a,null,d.a.createElement(q.a,{alt:i,src:s||l||o})),d.a.createElement(K.a,{primary:d.a.createElement(Q.a,{container:!0,direction:"row",justify:"space-between",alignItems:"flex-start"},d.a.createElement(F.a,{component:"span",variant:"body1"},m||i),d.a.createElement(F.a,{component:"span",variant:"caption",color:"textSecondary"},X.a.timeStampToDetailedTime(a.timestamp)))})),d.a.createElement("div",{className:n.itemContent},r))})),$=a(154);var ee=d.a.memo(Object(V.a)((function(e){return Object(G.a)({})}))((function(e){var t,a=e.log,n=$.a.sortObjectWithDiceKey((null===(t=a.payload)||void 0===t?void 0:t.result)||[]);return d.a.createElement(Q.a,{container:!0,spacing:0},d.a.createElement(Q.a,{item:!0,xs:6},d.a.createElement(F.a,{component:"span",variant:"caption",color:"textSecondary"},"log type:")),d.a.createElement(Q.a,{item:!0,xs:6},d.a.createElement(F.a,{component:"span",variant:"overline",color:"secondary"},a.type)),Object.keys(n).map((function(e){return d.a.createElement(d.a.Fragment,{key:e},d.a.createElement(Q.a,{item:!0,xs:3},d.a.createElement(F.a,{component:"span",variant:"caption",color:"textSecondary"},e)),d.a.createElement(Q.a,{item:!0,xs:9},d.a.createElement(F.a,{component:"span",variant:"body1",color:"secondary"},n[e]&&n[e].join(", "))))})))}))),te=a(55);var ae=d.a.memo(Object(V.a)((function(e){return Object(G.a)({})}))((function(e){var t=e.log;return d.a.createElement(d.a.Fragment,null,d.a.createElement(Q.a,{container:!0,spacing:0},d.a.createElement(Q.a,{item:!0,xs:6},d.a.createElement(F.a,{component:"span",variant:"caption",color:"textSecondary"},"log type:")),d.a.createElement(Q.a,{item:!0,xs:6},d.a.createElement(F.a,{component:"span",variant:"overline",color:"secondary"},t.type))))})),te.a);var ne=d.a.memo(Object(V.a)((function(e){return Object(G.a)({root:{width:"100%",backgroundColor:e.palette.background.paper,overflowY:"scroll"}})}))((function(e){var t=e.profiles,a=e.logs,n=e.classes;return d.a.createElement(_.a,{className:n.root},a&&a.length?Object(m.a)(a).reverse().map((function(e,a){return d.a.createElement(d.a.Fragment,{key:e.timestamp},!!a&&d.a.createElement(W.a,{variant:"inset",component:"li",light:!0}),d.a.createElement(Z,{profile:t[e.authorUid],log:e},e.type===Y.a.DICE_ROLL&&e.payload&&d.a.createElement(ee,{log:e}),e.type===Y.a.NEW_PLAYER&&d.a.createElement(ae,{log:e})))})):"")})),te.a),re=a(697),ce=a(674),ie=a(676),oe=a(358),le=a.n(oe);var se=d.a.memo((function(e){var t=e.logs,a=e.profile;return d.a.createElement(re.a,{elevation:0},d.a.createElement(ce.a,{expandIcon:d.a.createElement(le.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},d.a.createElement(Q.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"center",spacing:2},d.a.createElement(Q.a,{item:!0},d.a.createElement(q.a,{src:a.characterAvatarUrl||a.avatarUrl||a.photoURL,alt:a.displayName})),d.a.createElement(Q.a,{item:!0},d.a.createElement(F.a,null,a.characterName||a.displayName)))),d.a.createElement(ie.a,null,d.a.createElement("article",null,function(e){return Object(m.a)(e).reverse().map((function(e,t){return d.a.createElement("ul",{key:e.timestamp},!!t&&d.a.createElement(W.a,{component:"div",light:!0}),d.a.createElement(F.a,{component:"span",variant:"caption",color:"textSecondary"},X.a.timeStampToDetailedTime(e.timestamp)),e.type===Y.a.DICE_ROLL&&e.payload&&d.a.createElement(ee,{log:e}),e.type===Y.a.NEW_PLAYER&&d.a.createElement(ae,{log:e}))}))}(t))))}),te.a);var me=d.a.memo(Object(V.a)((function(e){return Object(G.a)({root:{width:"100%",backgroundColor:e.palette.background.paper,overflowY:"scroll"}})}))((function(e){var t=e.profiles,a=e.logs,n=e.classes;return d.a.createElement(_.a,{className:n.root},d.a.createElement(d.a.Fragment,null,Object.keys(t).map((function(e){return d.a.createElement(se,{key:e,profile:t[e],logs:a.filter((function(t){return t.authorUid===e}))})}))))})),te.a);var ue=Object(V.a)((function(e){return Object(G.a)({root:{backgroundColor:e.palette.background.paper,width:"100%",height:"100%",position:"relative",zIndex:10,overflow:"hidden"},bar:{borderBottom:"1px solid rgba(0, 0, 0, 0.12)"},tab:{overflowX:"hidden",height:"calc(100% - ".concat(e.spacing(6),"px)"),overflowY:"scroll"},tabContent:{margin:e.spacing(-2)}})}))((function(e){var t=e.classes,a=e.visible,n=void 0===a||a,r=Object(T.a)(),c=d.a.useState(0),i=Object(I.a)(c,2),o=i[0],l=i[1],s=Object(p.useSelector)(h.a.selectedRoomPlayers),m=Object(p.useSelector)(h.a.selectedRoomLogs);return d.a.createElement(k.a,{direction:"right",in:n},d.a.createElement(L.a,{className:t.root,elevation:2},d.a.createElement(D.a,{className:t.bar,position:"static",color:"default",elevation:0},d.a.createElement(H.a,{value:o,onChange:function(e,t){l(t)},indicatorColor:"secondary",textColor:"primary",variant:"fullWidth","aria-label":"full width tabs example"},d.a.createElement(M.a,Object.assign({label:"Logs Timeline"},pe(0))),d.a.createElement(M.a,Object.assign({label:"Players Logs"},pe(1))))),d.a.createElement("div",{className:t.tab},d.a.createElement(A.a,{axis:"rtl"===r.direction?"x-reverse":"x",index:o,onChangeIndex:function(e){l(e)}},d.a.createElement(de,{value:o,index:0,dir:r.direction},d.a.createElement("div",{className:t.tabContent},d.a.createElement(ne,{profiles:s,logs:m}))),d.a.createElement(de,{value:o,index:1,dir:r.direction},d.a.createElement("div",{className:t.tabContent},d.a.createElement(me,{profiles:s,logs:m})))))))}));function de(e){var t=e.children,a=e.value,n=e.index,r=Object(U.a)(e,["children","value","index"]);return d.a.createElement(F.a,Object.assign({component:"div",role:"tabpanel",hidden:a!==n,id:"full-width-tabpanel-".concat(n),"aria-labelledby":"full-width-tab-".concat(n)},r),a===n&&d.a.createElement(z.a,{p:3},t))}function pe(e){return{id:"full-width-tab-".concat(e),"aria-controls":"full-width-tabpanel-".concat(e)}}var be=d.a.memo((function(e){var t=e.visible,a=void 0===t||t;return d.a.createElement(k.a,{direction:"left",in:a},d.a.createElement("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:"100%",zIndex:10}},d.a.createElement(ue,null)))})),fe=a(284),Ee=a(663),ge=a(790),he=a(766),ve=a.n(he),Oe=a(763),ye=a.n(Oe),je=a(765),Se=a.n(je),xe=a(764),Ce=a.n(xe),Re=a(783),we=a(784),Ne=a(798),ke=a(609);var Ue=d.a.memo(Object(V.a)((function(e){return Object(G.a)({tile:{borderRadius:e.spacing(1),marginRight:e.spacing(2),maxWidth:e.spacing(30),overflow:"hidden",padding:"0 !Important",width:"100%"},title:{color:e.palette.primary.light},titleDisable:{color:e.palette.warning.light},actionGrid:{position:"absolute",zIndex:10,top:0,right:0},titleBar:{background:"linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 70%, rgba(0,0,0,0) 100%)"}})}))((function(e){var t=e.classes,a=e.player,n=e.onEdit;return d.a.createElement(Re.a,{className:t.tile},d.a.createElement("img",{src:a.characterAvatarUrl||a.avatarUrl||a.photoURL,alt:a.displayName}),d.a.createElement(we.a,{title:a.characterName||a.displayName,classes:{root:t.titleBar,title:a.connected?t.title:t.titleDisable},actionIcon:d.a.createElement(Ne.a,{title:a.connected?"Online":"Offline"},d.a.createElement(ke.a,{"aria-label":"star ".concat(a.displayName)},a.connected?d.a.createElement(ye.a,{className:t.title}):d.a.createElement(Ce.a,{className:t.titleDisable})))}),(a.gameMaster||n)&&d.a.createElement(Q.a,{container:!0,direction:"row",justify:"flex-end",alignItems:"center",spacing:0,className:t.actionGrid},a.gameMaster&&d.a.createElement(Q.a,{item:!0},d.a.createElement(Ne.a,{className:Object(x.a)(a.connected?t.title:t.titleDisable),title:"Game Master"},d.a.createElement(ke.a,{"aria-label":""},d.a.createElement(Se.a,null)))),n&&d.a.createElement(Q.a,{item:!0},d.a.createElement(Ne.a,{className:Object(x.a)(a.connected?t.title:t.titleDisable),title:"Edit character"},d.a.createElement(ke.a,{onClick:function(){return n(a.uid)},"aria-label":"edit character"},d.a.createElement(ve.a,null))))))})),(function(e,t){return Object(te.a)(e.player,t.player)})),Ie=a(705),De=a(787),Le=a(788),Pe=a(789),Ae=a(692),Te=a(288),He=a(706);var Me=Object(Ae.a)({form:"playerProfile",validate:function(e){var t={};return Object.keys(Y.d).forEach((function(a){var n;Y.d[a].maxLength&&(null===(n=e[Y.d[a].name])||void 0===n?void 0:n.length)>Y.d[a].maxLength&&(t[a]="Max length ".concat(Y.d[a].maxLength," exceeded"))})),t}})((function(e){var t=e.handleSubmit,a=e.pristine,n=e.submitting,r=e.onClose,c=e.invalid,i=Object(p.useSelector)(fe.a.getFormPlayerProfile);return d.a.createElement("form",{onSubmit:t},d.a.createElement(He.a,{src:i.characterAvatarUrl,title:"Character image"}),d.a.createElement(De.a,{dividers:!0},d.a.createElement(Te.c,Y.d.characterName),d.a.createElement(Te.c,Y.d.characterAvatarUrl),d.a.createElement(Te.c,Y.d.characterDescription),d.a.createElement(Te.c,Y.d.notes)),d.a.createElement(Le.a,null,d.a.createElement(Pe.a,{type:"submit",color:"primary",disabled:c||a||n},"Submit"),d.a.createElement(Pe.a,{type:"button",onClick:r,color:"primary"},"Cancel")))})),Fe=a(92);function ze(e){var t=e.open,a=e.onClose,n=e.profileUid,r=Object(b.useFirestore)(),c=Object(p.useSelector)(j.a.selectedRoomUid),i=Object(p.useSelector)(h.a.selectedRoom),o=Object(u.useContext)(Fe.b);return d.a.createElement(Ie.a,{open:t,onClose:a,title:"Edit character"},(null===i||void 0===i?void 0:i.players[n])&&d.a.createElement(Me,{onClose:a,onSubmit:function(e){Object.keys(e).forEach((function(t){return void 0===e[t]&&delete e[t]}));var t=Object(s.a)({},i.players,Object(l.a)({},n,e));r.doc("".concat(g.a.ROOMS,"/").concat(c)).update({players:t}).then((function(e){a()})).catch((function(e){o.setSnackbarConfig({type:Fe.a.ERROR,open:!0,text:"Upss.. there was an error updating the player form"})}))},initialValues:i.players[n]}))}var Ge=Object(V.a)((function(e){return Object(G.a)({root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper},gridList:{height:e.spacing(20),width:"100%",flexWrap:"nowrap",transform:"translateZ(0)"}})}))((function(e){var t=e.classes,a=e.visible,n=Object(p.useSelector)(h.a.selectedRoomPlayers),r=Object(p.useSelector)(h.a.usersProfiles),c=Object(p.useSelector)(E.a.userProfile),i=Object(p.useSelector)(h.a.selectedRoomGameMasterUid),o=Object(u.useState)(null),l=Object(I.a)(o,2),m=l[0],b=l[1];return d.a.createElement(d.a.Fragment,null,n&&d.a.createElement(k.a,{direction:"up",in:a},d.a.createElement(ge.a,{className:t.gridList,cols:2.5},Object.keys(n).map((function(e,t){var a,o=Object(s.a)({},n[e],{connected:null===(a=r[e])||void 0===a?void 0:a.connected});return d.a.createElement(Ee.a,{in:!0,key:e,timeout:1e3*t+300},d.a.createElement(Ue,{player:o,onEdit:(c.uid===i||c.uid===e)&&function(e){return b(e)}}))})))),d.a.createElement(ze,{open:!!m,onClose:function(){return b(null)},profileUid:m}))})),Ve=a(767),We=a.n(Ve),_e=a(770),Ye=a.n(_e),Be=a(771),Je=a.n(Be),qe=a(768),Ke=a.n(qe),Qe=a(769),Xe=a.n(Qe),Ze=a(772),$e=a.n(Ze),et=a(799),tt=a(792),at=a(800);var nt=Object(V.a)((function(e){return Object(G.a)({})}))((function(e){var t=e.direction,a=void 0===t?"left":t,n=e.actions,r=d.a.useState(!1),c=Object(I.a)(r,2),i=c[0],o=c[1],l=function(){return o(!1)};return d.a.createElement(et.a,{ariaLabel:"SpeedDial example",icon:d.a.createElement(at.a,null),onClose:l,onOpen:function(){return o(!0)},open:i,direction:a},n.map((function(e){return d.a.createElement(tt.a,{key:e.name,icon:e.icon,tooltipTitle:e.name,onClick:function(){return e.callback?e.callback(l):l()}})})))})),rt=a(711);function ct(e){var t=e.open,a=e.onClose,n=Object(b.useFirestore)(),r=Object(p.useSelector)(h.a.selectedRoomFormData),c=Object(p.useSelector)(j.a.selectedRoomUid),i=Object(u.useContext)(Fe.b);return d.a.createElement(rt.a,{open:t,onClose:a,onSubmit:function(e){Object.keys(e).forEach((function(t){return void 0===e[t]&&delete e[t]})),n.doc("".concat(g.a.ROOMS,"/").concat(c)).update(Object(s.a)({},e)).then((function(e){a()})).catch((function(e){i.setSnackbarConfig({type:Fe.a.ERROR,open:!0,text:"Upss.. there was an error updating the room"})}))},initialValues:r})}var it=Object(V.a)((function(e){return Object(G.a)({})}))((function(e){var t=Object(p.useDispatch)(),a=Object(u.useContext)(Fe.b),n=Object(p.useSelector)(fe.a.isGameMasterOfSelectedRoom),r=Object(p.useSelector)(j.a.drawerOpened),c=Object(p.useSelector)(j.a.chatOpened),i=Object(p.useSelector)(j.a.playersOpened),o=Object(u.useState)(!1),l=Object(I.a)(o,2),s=l[0],m=l[1],b=n?[{icon:d.a.createElement(We.a,null),name:"Edit Room Description",callback:function(e){return m(!0)}}]:[],f=[{icon:r?d.a.createElement(Ke.a,null):d.a.createElement(Xe.a,null),name:r?"Hide Nav":"Show Nav",callback:function(e){return t(y.a.setDrawerOpenValue(!r))}},{icon:d.a.createElement(Ye.a,null),name:c?"Hide chat":"Show Chat",callback:function(e){return t(y.a.setChatOpenValue(!c))}},{icon:d.a.createElement(Je.a,null),name:i?"Hide players":"Show players",callback:function(e){return t(y.a.setPlayersOpenValue(!i))}},{icon:d.a.createElement($e.a,null),name:"Copy Room Url",callback:function(e){navigator.permissions.query({name:"clipboard-write"}).then((function(e){"granted"!==e.state&&"prompt"!==e.state||navigator.clipboard.writeText(window.location.href).then((function(){return a.setSnackbarConfig({type:Fe.a.SUCCESS,open:!0,text:"Room URL copied to clipboard!"})}),(function(){return a.setSnackbarConfig({type:Fe.a.ERROR,open:!0,text:"Upss.. there was an error"})}))}))}}].concat(b);return d.a.createElement(d.a.Fragment,null,d.a.createElement(nt,{actions:f,direction:"right"}),d.a.createElement(ct,{open:s,onClose:function(){return m(!1)}}))})),ot=Object(C.a)((function(e){return{root:{position:"relative",margin:e.spacing(-6,-4),height:"calc(100vh - ".concat(e.spacing(10),"px)"),padding:e.spacing(1,1,0,1)},mainGrid:{display:"grid",gridTemplateColumns:"1fr auto",gridTemplateRows:"1fr auto auto",columnGap:e.spacing(2)+"px",rowGap:e.spacing(2)+"px",width:"100%",height:"100%"},gridItemLogs:{position:"relative",gridColumn:"2",gridRow:"1"},gridItemChatter:{position:"relative",gridColumn:"2",gridRow:"2 / span 2"},gridItemDiceCard:{position:"relative",gridColumn:"1 / span 2",gridRow:"1 / span 2"},gridItemPlayers:{position:"relative",gridColumn:"1",gridRow:"3"},speedDial:{position:"absolute",bottom:e.spacing(3),left:e.spacing(1),zIndex:10},diceDashboard:{position:"absolute",zIndex:1e3,top:e.spacing(1),left:e.spacing(1)},maxHeight:{maxHeight:"3000px",transition:"max-height 225ms cubic-bezier(0, 0, 0.2, 1) 0ms"},noHeight:{maxHeight:0}}}));function lt(){var e=ot(),t=Object(p.useSelector)(j.a.playersOpened),a=Object(p.useSelector)(j.a.chatOpened),n=Object(p.useSelector)(j.a.diceRolling),r=Object(p.useSelector)(h.a.selectedRoom),c=Object(p.useSelector)(fe.a.isUserARoomPlayerOrGameMaster),i=!t||!r;return d.a.createElement("section",{className:e.root},d.a.createElement("div",{className:e.mainGrid},d.a.createElement("div",{className:e.gridItemLogs},d.a.createElement(be,{visible:!n&&!!r})),d.a.createElement("div",{className:e.gridItemDiceCard},d.a.createElement(w.a,null),d.a.createElement("nav",{className:e.diceDashboard},d.a.createElement(N.a,{visible:!n&&!!r&&c,room:r})),d.a.createElement("nav",{className:e.speedDial},d.a.createElement(it,null))),d.a.createElement("div",{className:e.gridItemChatter},d.a.createElement(R.a,{visible:a&&!n&&c})),d.a.createElement("div",{className:e.gridItemPlayers},d.a.createElement("div",{className:Object(x.a)(e.maxHeight,i&&e.noHeight)},d.a.createElement(Ge,{visible:!i})))))}t.default=o((function(e){var t=e.match,a=Object(p.useDispatch)(),n=Object(b.useFirestore)(),r=Object(u.useContext)(Fe.b),c=Object(p.useSelector)(h.a.selectedRoom),i=Object(p.useSelector)(j.a.selectedRoomUid),o=Object(p.useSelector)(O.a.match),x=Object(p.useSelector)(E.a.userProfile);return Object(u.useEffect)((function(){return JSON.stringify(t)!==JSON.stringify(o)&&a(v.a.matchChange(t)),void a(y.a.setSelectedRoom(o.params.roomId))})),Object(u.useEffect)((function(){!function(){if(c&&(null===c||void 0===c?void 0:c.players)&&x.uid&&c.gameMasterUid!==x.uid&&!c.players[x.uid])if((null===c||void 0===c?void 0:c.maxPlayers)<=Object.keys(c.players).length)r.setSnackbarConfig({type:Fe.a.WARNING,open:!0,text:"I could not sit at the table because the maximum number of players is reached"});else{var e=n.doc("".concat(g.a.ROOMS,"/").concat(i));n.runTransaction((function(t){return t.get(e).then((function(a){var n={authorUid:x.uid,timestamp:Date.now(),type:Y.a.NEW_PLAYER},r=[].concat(Object(m.a)(a.data().logs),[n]),c={displayName:x.displayName,email:x.email,photoURL:x.photoURL,uid:x.uid},i=Object(s.a)({},a.data().players,Object(l.a)({},x.uid,c)),o=[].concat(Object(m.a)(a.data().playersUid),[x.uid]);return t.update(e,{logs:r,players:i,playersUid:o})})).catch((function(e){r.setSnackbarConfig({type:Fe.a.ERROR,open:!0,text:"Upss.. there was an error updating the room"})}))}))}}()}),[i,null===c||void 0===c?void 0:c.createdAt,x.uid]),Object(u.useEffect)((function(){return function(){a(y.a.setSelectedRoom(null))}}),[]),Object(u.useEffect)((function(){a(f.a.setSelectedChat((null===c||void 0===c?void 0:c.chatUid)||null))}),[null===c||void 0===c?void 0:c.chatUid]),d.a.createElement(d.a.Fragment,null,i&&[i].map((function(e){return d.a.createElement(S.b,{key:e},d.a.createElement(lt,null))})))}))}}]);
//# sourceMappingURL=6.059e5f93.chunk.js.map