(this["webpackJsonproll-a-dice"]=this["webpackJsonproll-a-dice"]||[]).push([[7],{667:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(668),c=a.n(n),r=a(670),i=a(55),o=a(21),l=a(32),s=a(266),u=c()({}),m=Object(i.a)(),d=Object(r.connectedRouterRedirect)({redirectPath:o.a.HOME_PATH,AuthenticatingComponent:s.a,wrapperDisplayName:"UserIsAuthenticated",authenticatedSelector:l.a.isAuthenticated,authenticatingSelector:l.a.authenticatingSelector,redirectAction:function(e){return function(t){m.push(e),t({type:"UNAUTHED_REDIRECT",payload:{message:"User is not authenticated."}})}}});Object(r.connectedRouterRedirect)({AuthenticatingComponent:s.a,wrapperDisplayName:"UserIsNotAuthenticated",allowRedirectBack:!1,authenticatedSelector:function(e){return e.firebase.auth.isEmpty},authenticatingSelector:function(e){var t=e.firebase,a=t.auth,n=t.isInitializing;return!a.isLoaded||n},redirectPath:function(e,t){return u.getRedirectQueryParam(t)||o.a.ROOMS_PATH},redirectAction:function(e){return function(t){m.push(e),t({type:"AUTHED_REDIRECT",payload:{message:"User is not authenticated."}})}}})},671:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),c=a.n(n).a.lazy((function(){return a.e(6).then(a.bind(null,676))}))},672:function(e,t,a){"use strict";var n=a(0),c=a.n(n),r=a(18),i=a(639),o=a(732),l=a(733),s=a(729),u=a(730),m=a(731),d=a(659),p=a(139),b=a(269),f=a(594),g=a(642),h=a(647),E=a(590),O=a(11),v=a(263),j=Object(f.a)({image:{width:"100%",height:"15vh",backgroundPosition:"center",backgroundSize:"cover"}}),y=Object(E.a)(j);function S(e){var t,a=y(),n=Object(O.useSelector)(v.a.getFormCreateRoom);return c.a.createElement(g.a,{in:(null===n||void 0===n||null===(t=n.roomImage)||void 0===t?void 0:t.length)>8},(null===n||void 0===n?void 0:n.roomImage)&&c.a.createElement(h.a,{className:a.image,image:null===n||void 0===n?void 0:n.roomImage,title:"Room Image"}))}var R=Object(d.a)({form:"createRoom",validate:function(e){var t={};return[p.b.roomName.name,p.b.maxPlayers.name].forEach((function(a){e[a]||(t[a]="Required")})),e[p.b.diceType.name]&&e[p.b.diceType.name].length||(t[p.b.diceType.name]="Select at least one dice"),t}})((function(e){var t=e.handleSubmit,a=e.pristine,n=e.submitting,r=e.handleClose,i=e.invalid;return c.a.createElement("form",{onSubmit:t},c.a.createElement(S,null),c.a.createElement(s.a,{dividers:!0},c.a.createElement(b.c,p.b.roomName),c.a.createElement(b.c,p.b.roomImage),c.a.createElement(b.c,p.b.campaignTitle),c.a.createElement(b.c,p.b.description),c.a.createElement(b.c,p.b.gameMasterAvatar),c.a.createElement("div",{style:{width:"50%"}},c.a.createElement(b.c,p.b.maxPlayers)),c.a.createElement(b.a,p.b.diceType)),c.a.createElement(u.a,null,c.a.createElement(m.a,{type:"submit",color:"primary",disabled:i||a||n},"Submit"),c.a.createElement(m.a,{type:"button",onClick:r,color:"primary"},"Cancel")))}));function w(e){var t=e.open,a=e.onClose,n=e.onSubmit,s=e.initialValues,u=Object(r.a)(),m=Object(i.a)(u.breakpoints.down("xs"));return c.a.createElement(o.a,{fullScreen:m,open:t,onClose:a,"aria-labelledby":"responsive-dialog-title"},c.a.createElement(l.a,null,"Create new Room"),c.a.createElement(R,{handleClose:a,onSubmit:n,initialValues:s}))}a.d(t,"a",(function(){return w}))},734:function(e,t,a){"use strict";a.r(t);var n=a(20),c=a(78),r=a(673),i=a(667),o=Object(n.d)(Object(r.a)("EnhancedRoomList"),c.g,i.a),l=a(50),s=a(0),u=a.n(s),m=a(11),d=a(29),p=a(188),b=a(32),f=a(57),g=a(96),h=a(267),E=a(149),O=a(268),v=a(62),j=a(112),y=a(4),S=a(590),R=a(671),w=a(356),C=a(355),N=a(594),k=a(5),x=a(588),D=a(726),I=a(632),T=a(703),U=a.n(T),A=a(705),P=a.n(A),M=a(704),L=a.n(M),z=a(724),G=a(725),H=a(738),F=a(581);var V=u.a.memo(Object(k.a)((function(e){return Object(N.a)({tile:{borderRadius:e.spacing(1),marginRight:e.spacing(2),maxWidth:e.spacing(30),overflow:"hidden",padding:"0 !Important",width:"100%"},title:{color:e.palette.primary.light},titleDisable:{color:e.palette.warning.light},masterGame:{position:"absolute",zIndex:10,top:0,right:0},titleBar:{background:"linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 70%, rgba(0,0,0,0) 100%)"}})}))((function(e){var t=e.classes,a=e.player,n=e.gameMaster;return u.a.createElement(z.a,{className:t.tile},u.a.createElement("img",{src:a.avatarUrl||a.photoURL,alt:a.displayName}),u.a.createElement(G.a,{title:a.displayName,classes:{root:t.titleBar,title:a.connected?t.title:t.titleDisable},actionIcon:u.a.createElement(H.a,{title:a.connected?"Online":"Offline"},u.a.createElement(F.a,{"aria-label":"star ".concat(a.displayName)},a.connected?u.a.createElement(U.a,{className:t.title}):u.a.createElement(L.a,{className:t.titleDisable})))}),n&&u.a.createElement(H.a,{className:Object(y.a)(t.masterGame,a.connected?t.title:t.titleDisable),title:"Game Master"},u.a.createElement(F.a,{"aria-label":"star ".concat(a.displayName)},u.a.createElement(P.a,null))))})));var J=Object(k.a)((function(e){return Object(N.a)({root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper},gridList:{height:e.spacing(20),width:"100%",flexWrap:"nowrap",transform:"translateZ(0)"}})}))((function(e){var t=e.classes,a=e.visible,n=Object(m.useSelector)(g.a.selectedRoomPlayers),c=Object(m.useSelector)(g.a.selectedRoomGameMasterProfile);return u.a.createElement(x.a,{direction:"up",in:a},u.a.createElement(D.a,{className:t.gridList,cols:2.5},c&&u.a.createElement(I.a,{in:!0,timeout:300},u.a.createElement(V,{player:c,gameMaster:!0})),n&&n.map((function(e,t){return u.a.createElement(I.a,{in:!0,key:e.uid,timeout:1e3*t+1300},u.a.createElement(V,{player:e}))}))))})),W=a(19),_=a(42),B=a(706),q=a.n(B),Q=a(709),Z=a.n(Q),K=a(710),X=a.n(K),Y=a(707),$=a.n(Y),ee=a(708),te=a.n(ee),ae=a(711),ne=a.n(ae),ce=a(736),re=a(739),ie=a(740),oe=a(728),le=a(741);var se=u.a.memo(Object(k.a)((function(e){return Object(N.a)({})}))((function(e){var t=e.direction,a=void 0===t?"left":t,n=e.actions,c=u.a.useState(!1),r=Object(_.a)(c,2),i=r[0],o=r[1],l=function(){return o(!1)};return u.a.createElement(ie.a,{ariaLabel:"SpeedDial example",icon:u.a.createElement(le.a,null),onClose:l,onOpen:function(){return o(!0)},open:i,direction:a},n.map((function(e){return u.a.createElement(oe.a,{key:e.name,icon:e.icon,tooltipTitle:e.name,onClick:function(){return e.callback?e.callback(l):l()}})})))}))),ue=a(263),me=a(672);function de(e){var t=e.open,a=e.onClose,n=Object(d.useFirestore)(),c=Object(m.useSelector)(g.a.selectedRoomFormData),r=Object(m.useSelector)(v.a.selectedRoomUid);return u.a.createElement(me.a,{open:t,onClose:a,onSubmit:function(e){Object.keys(e).forEach((function(t){return void 0===e[t]&&delete e[t]})),n.doc("".concat(f.a.ROOMS,"/").concat(r)).update(Object(W.a)({},e)).then((function(e){a()})).catch((function(e){console.log({e:e})}))},initialValues:c})}var pe=Object(k.a)((function(e){return Object(N.a)({snackbar:{top:e.spacing(8)}})}))((function(e){var t=e.classes,a=Object(m.useDispatch)(),n=Object(m.useSelector)(ue.a.isGameMasterOfSelectedRoom),c=Object(m.useSelector)(v.a.drawerOpened),r=Object(m.useSelector)(v.a.chatOpened),i=Object(m.useSelector)(v.a.playersOpened),o=Object(s.useState)(!1),l=Object(_.a)(o,2),d=l[0],p=l[1],b=u.a.useState({type:"success",open:!1,text:""}),f=Object(_.a)(b,2),g=f[0],h=f[1],E=n?[{icon:u.a.createElement(q.a,null),name:"Edit Room Description",callback:function(e){return p(!0)}}]:[],j=[{icon:c?u.a.createElement($.a,null):u.a.createElement(te.a,null),name:c?"Hide Nav":"Show Nav",callback:function(e){return a(O.a.setDrawerOpenValue(!c))}},{icon:u.a.createElement(Z.a,null),name:r?"Hide chat":"Show Chat",callback:function(e){return a(O.a.setChatOpenValue(!r))}},{icon:u.a.createElement(X.a,null),name:i?"Hide players":"Show players",callback:function(e){return a(O.a.setPlayersOpenValue(!i))}},{icon:u.a.createElement(ne.a,null),name:"Copy Room Url",callback:function(e){navigator.permissions.query({name:"clipboard-write"}).then((function(e){"granted"!==e.state&&"prompt"!==e.state||navigator.clipboard.writeText(window.location.href).then((function(){return h({type:"success",open:!0,text:"Room URL copied to clipboard!"})}),(function(){return h({type:"error",open:!0,text:"Upss.. there was an error"})}))}))}}].concat(E);return u.a.createElement(u.a.Fragment,null,u.a.createElement(se,{actions:j,direction:"right"}),u.a.createElement(re.a,{className:t.snackbar,anchorOrigin:{vertical:"top",horizontal:"right"},open:g.open,autoHideDuration:6e3,onClose:function(){return h(Object(W.a)({},g,{open:!1}))}},u.a.createElement(ce.a,{onClose:function(){return h(Object(W.a)({},g,{open:!1}))},severity:g.type},g.text)),u.a.createElement(de,{open:d,onClose:function(){return p(!1)}}))})),be=Object(S.a)((function(e){return{root:{position:"relative",margin:e.spacing(-6,-4),height:"calc(100% + ".concat(e.spacing(12),"px)")},diceWrapper:{},chatter:{zIndex:100,position:"fixed",bottom:e.spacing(4),right:e.spacing(2),transition:"bottom 225ms cubic-bezier(0, 0, 0.2, 1) 0ms"},chatterLower:{bottom:e.spacing(4)},speedDial:{position:"absolute",bottom:e.spacing(25),left:e.spacing(3),zIndex:10,transition:"bottom 225ms cubic-bezier(0, 0, 0.2, 1) 0ms"},speedDialLower:{bottom:e.spacing(3)},cssGrid:{height:"100%",display:"grid",gridTemplateColumns:"1fr",gridTemplateRows:"1fr auto",rowGap:"".concat(e.spacing(2),"px"),columnGap:"".concat(e.spacing(2),"px"),padding:e.spacing(2,2,0,2)},cssItem1:{gridColumn:1,gridRow:1},cssItem2:{gridColumn:1,gridRow:2},diceDashboard:{position:"absolute",zIndex:1e3,top:e.spacing(3),left:e.spacing(3)}}}));function fe(){var e=be(),t=Object(m.useSelector)(v.a.playersOpened),a=Object(m.useSelector)(v.a.chatOpened),n=Object(m.useSelector)(v.a.diceRolling),c=Object(m.useSelector)(g.a.selectedRoom),r=Object(m.useSelector)(ue.a.isUserARoomPlayerOrGameMaster),i=!t||!c;return u.a.createElement("section",{className:e.root},u.a.createElement("div",{className:Object(y.a)(e.chatter,i&&e.chatterLower)},u.a.createElement(R.a,{visbile:a&&!n&&r})),u.a.createElement("div",{className:e.cssGrid},u.a.createElement("div",{className:e.cssItem1},u.a.createElement(w.a,null)),u.a.createElement("div",{className:e.cssItem2},u.a.createElement(J,{visible:!i}))),u.a.createElement("nav",{className:Object(y.a)(e.speedDial,i&&e.speedDialLower)},u.a.createElement(pe,null)),u.a.createElement("nav",{className:e.diceDashboard},u.a.createElement(C.a,{visible:!n&&!!c&&r,room:c})))}t.default=o((function(e){var t=e.match,a=Object(m.useDispatch)(),n=Object(d.useFirestore)(),c=Object(m.useSelector)(g.a.selectedRoom),r=Object(m.useSelector)(v.a.selectedRoomUid),i=Object(m.useSelector)(E.a.match),o=Object(m.useSelector)(b.a.userProfile);return Object(s.useEffect)((function(){return JSON.stringify(t)!==JSON.stringify(i)&&a(h.a.matchChange(t)),void a(O.a.setSelectedRoom(i.params.roomId))})),Object(s.useEffect)((function(){!function(){if(c&&!((null===c||void 0===c?void 0:c.maxPlayers)<=c.players.length)&&(null===c||void 0===c?void 0:c.players)&&o.uid&&c.gameMaster.uid!==o.uid&&-1===c.players.indexOf(o.uid)){var e=n.doc("".concat(f.a.ROOMS,"/").concat(r));n.runTransaction((function(t){return t.get(e).then((function(a){var n=[].concat(Object(l.a)(a.data().players),[o.uid]);return t.update(e,{players:n})})).catch((function(e){console.log("Transaction failure:",e)}))}))}}()}),[r,null===c||void 0===c?void 0:c.createdAt,o.uid]),Object(s.useEffect)((function(){return function(){a(O.a.setSelectedRoom(null))}}),[]),Object(s.useEffect)((function(){a(p.a.setSelectedChat((null===c||void 0===c?void 0:c.chatUid)||null))}),[null===c||void 0===c?void 0:c.chatUid]),u.a.createElement(u.a.Fragment,null,r&&[r].map((function(e){return u.a.createElement(j.b,{key:e},u.a.createElement(fe,null))})))}))}}]);
//# sourceMappingURL=7.918a3cac.chunk.js.map